{"version":3,"file":"src_app_home_home_module_ts.js","mappings":"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","sources":["./src/app/home/home-routing.module.ts","./src/app/home/home.module.ts","./src/app/home/home.page.ts","./src/app/home/home.page.html","./src/app/services/geocode.service.ts","./src/app/services/map.service.ts","./src/app/services/network.service.ts","./node_modules/@capacitor/app/dist/esm/definitions.js","./node_modules/@capacitor/app/dist/esm/index.js","./node_modules/@capacitor/geolocation/dist/esm/definitions.js","./node_modules/@capacitor/geolocation/dist/esm/index.js","./node_modules/@capacitor/google-maps/dist/esm/definitions.js","./node_modules/@capacitor/google-maps/dist/esm/implementation.js","./node_modules/@capacitor/google-maps/dist/esm/index.js","./node_modules/@capacitor/google-maps/dist/esm/map.js","./node_modules/rxjs/dist/esm/internal/observable/interval.js"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { HomePage } from './home.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: HomePage,\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class HomePageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { HomePage } from './home.page';\r\nimport { CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\r\n\r\nimport { HomePageRoutingModule } from './home-routing.module';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    \r\n    IonicModule,\r\n    HomePageRoutingModule\r\n  ],\r\n  schemas: [CUSTOM_ELEMENTS_SCHEMA],\r\n  declarations: [HomePage]\r\n})\r\nexport class HomePageModule {}\r\n","/// <reference types=\"google.maps\" />\r\nimport { AfterViewInit, Component, ElementRef, NgZone, ViewChild } from '@angular/core';\r\nimport { Geolocation, Position } from '@capacitor/geolocation';\r\nimport { ModalOptions, ModalController, Platform, NavController, AlertController, ToastController, ActionSheetController } from '@ionic/angular';\r\nimport { AutocompleteComponent } from '../autocomplete/autocomplete.component';\r\nimport { OverlayService } from '../services/overlay.service';\r\nimport { GeocodeService } from '../services/geocode.service';\r\nimport { MapService } from '../services/map.service';\r\nimport { AvatarService } from '../services/avatar.service';\r\nimport { Drivers } from '../interfaces/drivers';\r\nimport { Observable, timer, interval, BehaviorSubject, throwError, Subscription } from 'rxjs';\r\nimport { doc as firestoreDoc, updateDoc, getDoc, collection, onSnapshot, doc, Firestore, query, where } from '@angular/fire/firestore';\r\nimport { Marker, Polyline } from '@capacitor/google-maps';\r\nimport { AuthService } from '../services/auth.service';\r\nimport { EnrouteChatComponent } from '../enroute-chat/enroute-chat.component';\r\nimport { NetworkService } from '../services/network.service'\r\nimport { Network } from '@capacitor/network';\r\nimport { Router } from '@angular/router';\r\nimport { App } from '@capacitor/app';\r\nimport { PaymentService } from '../services/payment.service';\r\nimport { AddCardComponent } from '../add-card/add-card.component';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { LatLngLiteral } from '@googlemaps/google-maps-services-js';\r\nimport { LatLng } from '@capacitor/google-maps/dist/typings/definitions';\r\nimport { Preferences } from '@capacitor/preferences';\r\nimport { Auth, onAuthStateChanged } from '@angular/fire/auth';\r\nimport Debug from 'onesignal-cordova-plugin/dist/DebugNamespace';\r\nimport { TripSummaryComponent } from '../trip-summary/trip-summary.component';\r\nimport { geohashForLocation } from 'geofire-common';\r\n\r\ndeclare var google;\r\n\r\n@Component({\r\n  selector: 'app-home',\r\n  templateUrl: 'home.page.html',\r\n  styleUrls: ['home.page.scss'],\r\n})\r\nexport class HomePage implements AfterViewInit {\r\n  [x: string]: any;\r\n  profile = null;\r\n  presets: Array<any> = [];\r\n  @ViewChild('map',  { static: true }) mapRef: ElementRef<HTMLElement>;\r\n  @ViewChild('topBar', { static: true }) topBar: ElementRef<HTMLElement>;\r\n  @ViewChild('bottomBar', { static: true }) bottomBar: ElementRef<HTMLElement>;\r\n  mappy;\r\n  @ViewChild('mapElement') mapElement: ElementRef<HTMLElement>;\r\n  coordinates: Position;\r\n  address: any = 'Unknown';\r\n  bookingStage: any;\r\n  confirmStage: any;\r\n  trackingStage: any;\r\n  searchingStage: any;\r\n  noDriverStage: any;\r\n  drivingToDestinationStage: any;\r\n  data: any;\r\n  cash: any = false;\r\n  state: any = [];\r\n  mapPinStage: boolean;\r\n  D_LatLng: { lat: any; lng: any; };\r\n  mapPinDrag: any;\r\n  showResetLocationButton: any = false;\r\n  showloader: boolean;\r\n  mapClass: any;\r\n  destinationAddress: string = 'Drag To Pick Destination';\r\n  locationAddress: string = null;\r\n  distance: any;\r\n  direction: any;\r\n  actualDestination: any;\r\n  markers: any;\r\n  allDrivers: Observable<Drivers[]>;\r\n  NoDrivers: boolean;\r\n  driverMarker: string;\r\n  driver_duration_apart: number;\r\n  driver_number_of_seats: any;\r\n  price: any = 0;\r\n  carname: any;\r\n  driver_ID: any;\r\n  bounds: any;\r\n  DriverLatLng: { lat: any; lng: any; };\r\n  drivers_Requested: any[];\r\n  current_Request_Number: number = -1;\r\n  Driver_Rejected: any;\r\n  numCalls: any;\r\n  currentDriver: any;\r\n  private countdownActive = false;\r\n\r\n  unsubscribe: import(\"@angular/fire/firestore\").Unsubscribe;\r\n  driverInfo: import(\"@angular/fire/firestore\").DocumentData;\r\n  duration: any = null;\r\n  riderCleared: any;\r\n  updateDriverSubcription: any;\r\n  canCheck: boolean;\r\n  marker1: any;\r\n  marker2: any;\r\n  actualLocation: string;\r\n  LatLng: { lat: number; lng: number; };\r\n  mapy: boolean;\r\n  AllCarMarkers: Marker[];\r\n  private _carmarkers: { id: string, marker: any }[] = [];\r\n  private rider_marker: any;\r\n  private driver_marker: any;\r\n\r\n  cards: import(\"@angular/fire/firestore\").DocumentData[];\r\n  selected: any;\r\n  selectedCard: any;\r\n  closeDrivers: any;\r\n  countDown: any;\r\n  places: import(\"@angular/fire/firestore\").DocumentData[];\r\n  newPoly: string[];\r\n  isConnected: boolean;\r\n  private networkStatus$ = new BehaviorSubject<boolean>(true);\r\n  pollingInterval: any;\r\n  animatedMarker: any;\r\n  driverImage: any;\r\n  private permissionCheckInterval: any;\r\n  savedPaymentMethods: any;\r\n  requestID: string;\r\n  rideHasStarted: boolean;\r\n  driverLocation: { lat: number, lng: number } | null = null;\r\n  stopPolling: boolean = false;\r\n  riderMarker: string;\r\n  routePath: google.maps.MVCArray<google.maps.LatLng> | (google.maps.LatLng | google.maps.LatLngLiteral)[];\r\n  destinationMarker: any;\r\n  D_duration: any;\r\n  routePolyline: any;\r\n  private routeUpdateSubscription: Subscription;\r\n  topBarHeight: any;\r\n  bottomBarHeight:any;\r\n  private readonly RIDE_STATE_KEY = 'activeRideState';\r\n  private isLoadingDriver = false;\r\n\r\n  // Add these stage constants at the class level\r\n  private readonly STAGES = {\r\n    BOOKING: 'booking',\r\n    CONFIRM: 'confirm',\r\n    TRACKING: 'tracking',\r\n    SEARCHING: 'searching',\r\n    DRIVING: 'driving',\r\n    NO_DRIVER: 'noDriver',\r\n    MAP_PIN: 'mapPin',\r\n    NO_DRIVERS: 'noDrivers'\r\n  } as const;\r\n\r\n  // Add this to your class properties\r\n  private lastHandledState: string | null = null;\r\n\r\n  // Add this property to the class\r\n  private isRideStopProcessed = false;\r\n\r\n  constructor(\r\n    private auth: Auth,\r\n    private authService: AuthService,\r\n    private router: Router,\r\n    private networkService: NetworkService,\r\n    public map: MapService,\r\n    private nav: NavController,\r\n    private platform: Platform,\r\n    private firestore: Firestore,\r\n    private readonly database: AvatarService,\r\n    private ngZone: NgZone,\r\n    private geocode: GeocodeService,\r\n    private overlay: OverlayService,\r\n    private modalCtrl: ModalController,\r\n    private alert: AlertController,\r\n    private payME: PaymentService,\r\n    private toastController: ToastController,\r\n    private actionSheetController: ActionSheetController\r\n  \r\n  ) {\r\n    this.initializeApp();\r\n  }\r\n\r\n  async ngOnDestroy() {\r\n    if (this.unsubscribe) {\r\n      this.unsubscribe();\r\n    }\r\n    window.removeEventListener('resize', this.setMapHeight.bind(this));\r\n    this.clearSubscriptions();\r\n    await this.clearPrevMarkers();\r\n    await this.clearAllPolylines();\r\n  }\r\n\r\n\r\n  async ngAfterViewInit() {\r\n    try {\r\n      // First check location permissions\r\n      const hasPermission = await this.checkAndRequestLocationPermissions();\r\n      if (!hasPermission) {\r\n        return;\r\n      }\r\n      \r\n      // Initialize profile first\r\n      await this.initializeProfile();\r\n      \r\n      // Then proceed with other initializations\r\n      await this.initializeApp();\r\n      await this.initializeNetworkMonitoring();\r\n      await this.fetchSavedPaymentMethods();\r\n  // load user preset places (localStorage-backed)\r\n  await this.loadPresets();\r\n      this.EnterBookingStage();\r\n      await this.initializeGeolocation();\r\n      await this.initializeMap();\r\n      \r\n      // Set up real-time listener for ride state\r\n      this.initializeRideStateListener();\r\n    } catch (e) {\r\n      console.error('Error in ngAfterViewInit:', e);\r\n      this.overlay.hideLoader();\r\n      this.overlay.showAlert('Error', 'An error occurred during initialization. Please try again.');\r\n    }\r\n  }\r\n\r\n  // Preset places management (localStorage)\r\n  async loadPresets() {\r\n    try {\r\n      const raw = localStorage.getItem('presetPlaces');\r\n      if (raw) {\r\n        this.presets = JSON.parse(raw);\r\n      } else {\r\n        // default presets\r\n        this.presets = [\r\n          { name: 'Queensbay Mall, Penang', address: 'Queensbay Mall, Bayan Lepas, Penang', lat: 5.2939, lng: 100.2719 },\r\n          { name: 'George Town Ferry Terminal', address: 'Weld Quay, George Town, Penang', lat: 5.4141, lng: 100.3294 }\r\n        ];\r\n        localStorage.setItem('presetPlaces', JSON.stringify(this.presets));\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to load presets', e);\r\n      this.presets = [];\r\n    }\r\n  }\r\n\r\n  async savePresets() {\r\n    try {\r\n      localStorage.setItem('presetPlaces', JSON.stringify(this.presets));\r\n    } catch (e) {\r\n      console.error('Failed to save presets', e);\r\n    }\r\n  }\r\n\r\n  // Add current destination as preset\r\n  async addCurrentAsPreset() {\r\n    try {\r\n      if (!this.destinationAddress || !this.D_LatLng || !this.D_LatLng.lat) {\r\n        const alert = await this.alert.create({\r\n          header: 'Add preset',\r\n          message: 'Please choose a destination on the map first (pin or search).',\r\n          buttons: ['OK']\r\n        });\r\n        await alert.present();\r\n        return;\r\n      }\r\n\r\n      const name = this.destinationAddress || 'New Place';\r\n      this.presets.unshift({ name, address: name, lat: this.D_LatLng.lat, lng: this.D_LatLng.lng });\r\n      // keep only latest 10\r\n      if (this.presets.length > 10) this.presets.length = 10;\r\n      await this.savePresets();\r\n    } catch (e) {\r\n      console.error('Error adding preset', e);\r\n    }\r\n  }\r\n\r\n  // Delete preset by index\r\n  async deletePreset(i: number) {\r\n    this.presets.splice(i, 1);\r\n    await this.savePresets();\r\n  }\r\n\r\n  // Select a preset: set destination and trigger directions\r\n  async selectPreset(preset: any) {\r\n    try {\r\n      this.destinationAddress = preset.name || preset.address || '';\r\n      if (preset.lat && preset.lng) {\r\n        this.D_LatLng = { lat: preset.lat, lng: preset.lng };\r\n        // trigger distance/directions calculation\r\n        await this.getDistanceAndDirections();\r\n      } else {\r\n        // fallback: if no coords, open autocomplete modal with address prefilled\r\n        // set data for modal then open it\r\n        await this.showAutocompleteModal();\r\n      }\r\n    } catch (e) {\r\n      console.error('Failed to select preset', e);\r\n    }\r\n  }\r\n\r\n  // Add this new method\r\n  private async initializeProfile() {\r\n    try {\r\n      // Show loader while initializing profile\r\n     // await this.overlay.showLoader('Loading profile...');\r\n\r\n      // Wait for auth state to be ready\r\n      const user = await new Promise<any>((resolve) => {\r\n        const unsubscribe = onAuthStateChanged(this.auth, (user) => {\r\n          unsubscribe();\r\n          resolve(user);\r\n        });\r\n      });\r\n\r\n      if (!user) {\r\n        throw new Error('User not authenticated');\r\n      }\r\n\r\n      // Get profile data\r\n      this.profile = await this.database.getUserProfile();\r\n      \r\n      if (!this.profile) {\r\n        console.log('Creating new profile...');\r\n        // If profile doesn't exist, create it with default values\r\n        this.profile = {\r\n          userId: user.uid,\r\n          email: user.email,\r\n          createdAt: new Date().toISOString(),\r\n          // Add any other default profile fields you need\r\n        };\r\n        await this.database.createUserProfile(this.profile);\r\n      }\r\n\r\n      console.log('Profile initialized:', this.profile);\r\n      this.overlay.hideLoader();\r\n    } catch (error) {\r\n      console.error('Error initializing profile:', error);\r\n      this.overlay.hideLoader();\r\n      await this.overlay.showAlert(\r\n        'Profile Error',\r\n        'Unable to initialize user profile. Please try again or contact support.'\r\n      );\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // Add this method to check profile before any ride-related action\r\n  private async ensureProfileInitialized(): Promise<boolean> {\r\n    if (!this.profile) {\r\n      try {\r\n        await this.initializeProfile();\r\n        return true;\r\n      } catch (error) {\r\n        console.error('Error ensuring profile is initialized:', error);\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private initializeRideStateListener() {\r\n    console.log('Initializing ride state listener');\r\n    \r\n    // Reset lastHandledState on initialization to ensure proper state restoration\r\n    this.lastHandledState = null;\r\n    \r\n    onAuthStateChanged(this.auth, (user) => {\r\n      if (!user) return;\r\n\r\n      // Listen to the Request collection for active rides for this user\r\n      const requestsQuery = query(\r\n        collection(this.firestore, 'Request'),\r\n        where('Rider_id', '==', user.uid),\r\n        where('status', 'in', ['pending', 'confirmed', 'started'])\r\n      );\r\n\r\n      this.unsubscribe = onSnapshot(requestsQuery, async (snapshot) => {\r\n        try {\r\n          // If no active rides found, go to booking stage\r\n          if (snapshot.empty) {\r\n            console.log('No active rides found');\r\n            this.setStage(this.STAGES.BOOKING);\r\n            return;\r\n          }\r\n\r\n          // Get the most recent active ride\r\n          const activeRides = snapshot.docs;\r\n          const currentRide = activeRides[0];\r\n          const rideData = currentRide.data();\r\n          this.requestID = currentRide.id;\r\n\r\n          // Restore price information\r\n          this.price = rideData.price || 0;\r\n          console.log('Restored ride price:', this.price);\r\n          console.log('Current ride status:', rideData.status);\r\n\r\n          // IMPORTANT: On app initialization, always restore ride state regardless of lastHandledState\r\n          const isAppInitialization = !this.lastHandledState;\r\n          \r\n          // Only skip if we've already handled this state AND it's not initial app load\r\n          if (this.lastHandledState === rideData.status && !isAppInitialization) {\r\n            console.log('State already properly handled:', rideData.status);\r\n            return;\r\n          }\r\n\r\n          // Store location data for later use\r\n          if (rideData.Loc_lat && rideData.Loc_lng) {\r\n            this.LatLng = {\r\n              lat: rideData.Loc_lat,\r\n              lng: rideData.Loc_lng\r\n            };\r\n          }\r\n          \r\n          if (rideData.Des_lat && rideData.Des_lng) {\r\n            this.D_LatLng = {\r\n              lat: rideData.Des_lat,\r\n              lng: rideData.Des_lng\r\n            };\r\n          }\r\n          \r\n          // Store addresses\r\n          this.locationAddress = rideData.Rider_Location || 'Unknown location';\r\n          this.destinationAddress = rideData.Rider_Destination || 'Unknown destination';\r\n\r\n          console.log('Restoring ride state:', rideData.status);\r\n\r\n          // Handle different ride states\r\n          switch (rideData.status) {\r\n            case 'pending':\r\n              await this.handlePendingState();\r\n              break;\r\n            case 'confirmed':\r\n              console.log('Handling confirmed state on restore...');\r\n              await this.handleRideConfirmation(rideData);\r\n              break;\r\n            case 'started':\r\n              await this.handleRideStart(currentRide);\r\n              break;\r\n            case 'cancelled':\r\n              await this.handleRideCancellation(rideData);\r\n              break;\r\n            default:\r\n              console.log('Unknown ride status:', rideData.status);\r\n              this.setStage(this.STAGES.BOOKING);\r\n          }\r\n          \r\n          // Only update lastHandledState AFTER successful handling\r\n          this.lastHandledState = rideData.status;\r\n          \r\n        } catch (error) {\r\n          console.error('Error handling ride state:', error);\r\n          if (error.code === 'permission-denied' || error.code === 'not-found') {\r\n            this.overlay.showAlert('Error', 'Failed to restore ride state. Please try again.');\r\n            this.setStage(this.STAGES.BOOKING);\r\n          }\r\n        }\r\n      }, (error) => {\r\n        console.error('Error in ride state listener:', error);\r\n        this.setStage(this.STAGES.BOOKING);\r\n      });\r\n    });\r\n  }\r\n\r\n\r\n  private handleRemovedRide() {\r\n    console.log('Ride was removed');\r\n    this.clearRideData();\r\n    this.setStage(this.STAGES.BOOKING);\r\n  }\r\n\r\n  private clearRideData() {\r\n    this.requestID = null;\r\n    this.driverInfo = null;\r\n    this.rideHasStarted = false;\r\n    this.lastHandledState = null;\r\n    // Clear any other ride-specific data\r\n  }\r\n\r\n  async checkAndRequestLocationPermissions() {\r\n    try {\r\n      // Check if running on web platform\r\n      if (this.platform.is('capacitor')) {\r\n        const permissionStatus = await Geolocation.checkPermissions();\r\n        \r\n        if (permissionStatus.location === 'granted') {\r\n          this.overlay.hideLoader();\r\n          return true;\r\n        }\r\n\r\n        const alert = await this.alert.create({\r\n          header: 'Location Permission Required',\r\n          message: 'This app needs access to your location to function properly.',\r\n          buttons: [\r\n            {\r\n              text: 'Enable Location',\r\n              handler: async () => {\r\n                const newStatus = await Geolocation.requestPermissions();\r\n                this.overlay.hideLoader();\r\n                \r\n                if (newStatus.location !== 'granted') {\r\n                  await this.showLocationRequiredAlert();\r\n                  return false;\r\n                }\r\n                return true;\r\n              }\r\n            }\r\n          ],\r\n          backdropDismiss: false\r\n        });\r\n\r\n        await alert.present();\r\n        const { role } = await alert.onDidDismiss();\r\n        \r\n        if (role === 'backdrop') {\r\n          this.overlay.hideLoader();\r\n          await this.showLocationRequiredAlert();\r\n          return false;\r\n        }\r\n      } else {\r\n        // Web platform - use browser's geolocation API\r\n        if ('geolocation' in navigator) {\r\n          return new Promise((resolve) => {\r\n            navigator.permissions.query({ name: 'geolocation' }).then((result) => {\r\n              if (result.state === 'granted') {\r\n                this.overlay.hideLoader();\r\n                resolve(true);\r\n              } else {\r\n                this.overlay.hideLoader();\r\n                resolve(this.showWebLocationPrompt());\r\n              }\r\n            });\r\n          });\r\n        } else {\r\n          this.overlay.hideLoader();\r\n          await this.overlay.showAlert('Error', 'Geolocation is not supported in this browser.');\r\n          return false;\r\n        }\r\n      }\r\n\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Error checking/requesting location permissions:', error);\r\n      this.overlay.hideLoader();\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  private async showWebLocationPrompt(): Promise<boolean> {\r\n    const alert = await this.alert.create({\r\n      header: 'Location Access',\r\n      message: 'This app needs your location. Please allow location access when prompted by your browser.',\r\n      buttons: [\r\n        {\r\n          text: 'OK',\r\n          handler: () => {\r\n            return new Promise((resolve) => {\r\n              navigator.geolocation.getCurrentPosition(\r\n                () => resolve(true),\r\n                () => {\r\n                  this.showLocationRequiredAlert();\r\n                  resolve(false);\r\n                }\r\n              );\r\n            });\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n    return true;\r\n  }\r\n\r\n  private async showLocationRequiredAlert() {\r\n    const alert = await this.alert.create({\r\n      header: 'Location Required',\r\n      message: 'Location permission is required to use this app. Please enable location services in your device settings.',\r\n      buttons: ['OK']\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  async fetchSavedPaymentMethods() {\r\n    try {\r\n      this.savedPaymentMethods = await this.database.getSavedPaymentMethods();\r\n      console.log('Saved Payment Methods:', this.savedPaymentMethods);\r\n      \r\n      // Set default payment method to cash if no cards are saved\r\n      if (this.savedPaymentMethods.length === 0) {\r\n        this.selectedCard = 'cash';\r\n        this.cash = true;\r\n      } else {\r\n        this.selectedCard = this.savedPaymentMethods[0].cardId;\r\n        this.cash = false;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching saved payment methods:', error);\r\n    }\r\n  }\r\n\r\n  chooseCard(event: any) {\r\n    this.selectedCard = event.detail.value;\r\n    this.cash = this.selectedCard === 'cash';\r\n    if (!this.cash) {\r\n     // this.processPayment(this.authService.user.email, this.defaultAmount, this.selectedCard);\r\n    }\r\n  }\r\n\r\n  async processPayment(email: string, amount: number, cardId: any) {\r\n    this.overlay.showLoader('Processing payment...');\r\n\r\n    try {\r\n      const paymentResult = await this.payME.processPaymentWithCardId(email, amount, cardId).toPromise();\r\n      console.log('Payment successful:', paymentResult);\r\n      await this.overlay.showAlert('Success', 'Payment successful!');\r\n    } catch (error) {\r\n      console.error('Error during payment:', error);\r\n      const errorMessage = error.error ? error.error.error : 'An unexpected error occurred.';\r\n      await this.showPaymentErrorModal(errorMessage);\r\n    } finally {\r\n      this.overlay.hideLoader();\r\n    }\r\n  }\r\n\r\n  async showPaymentErrorModal(errorMessage: string) {\r\n    const alert = await this.alert.create({\r\n      header: 'Payment Error',\r\n      message: errorMessage,\r\n      buttons: [\r\n        {\r\n          text: 'Add New Card',\r\n          handler: async () => {\r\n            const modal = await this.modalCtrl.create({\r\n              component: AddCardComponent, // Create this component to handle adding a new card\r\n            });\r\n            await modal.present();\r\n            const { data } = await modal.onWillDismiss();\r\n            if (data && data.newCardId) {\r\n              this.selectedCard = data.newCardId;\r\n              this.cash = false;\r\n            }\r\n          }\r\n        },\r\n        {\r\n          text: 'Cancel',\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n\r\n  // Add this single unified method for all map height calculations\r\n  setMapContainerHeight(extraPadding = 0) {\r\n    if (!this.mapRef || !this.topBar || !this.bottomBar) return;\r\n    \r\n    // Get proper measurements of the bars\r\n    const topHeight = this.topBar.nativeElement.offsetHeight || 0;\r\n    const bottomHeight = this.bottomBar.nativeElement.offsetHeight || 0;\r\n    \r\n    // Calculate available height properly\r\n    const availableHeight = window.innerHeight - topHeight - bottomHeight + extraPadding;\r\n    \r\n    // Set map height\r\n    this.mapRef.nativeElement.style.height = `${availableHeight}px`;\r\n    \r\n    // Ensure map container is positioned properly\r\n    this.mapRef.nativeElement.style.top = `${topHeight}px`;\r\n    this.mapRef.nativeElement.style.position = 'absolute';\r\n    this.mapRef.nativeElement.style.zIndex = '1'; // Lower than UI elements\r\n    this.mapRef.nativeElement.style.left = '0';\r\n    this.mapRef.nativeElement.style.right = '0';\r\n    \r\n    console.log(`Map container height set to: ${availableHeight}px (top: ${topHeight}px, bottom: ${bottomHeight}px)`);\r\n  }\r\n\r\n  // Update these methods to use the unified approach\r\n  setMapHeight() {\r\n    this.setMapContainerHeight(0);\r\n  }\r\n\r\n  setMapHeightCreateAndAddMarkers() {\r\n    this.setMapContainerHeight(40); // Add some padding if needed\r\n  }\r\n\r\n  setMapHeightHandleDrivertoRider() {\r\n    this.setMapContainerHeight(20);\r\n  }\r\n\r\n  setMapHeightHandleDrivertoDestination() {\r\n    this.setMapContainerHeight(0);\r\n  }\r\n\r\n  ResetMapHeight() {\r\n    this.setMapContainerHeight(0);\r\n  }\r\n\r\n  private async initializeNetworkMonitoring() {\r\n    const status = await Network.getStatus();\r\n    this.isConnected = status.connected;\r\n    this.networkStatus$.next(this.isConnected);\r\n    console.log('Network monitoring initialized. Initial status:', this.isConnected);\r\n\r\n    Network.addListener('networkStatusChange', (status) => {\r\n      console.log('Network status changed:', status);\r\n      this.isConnected = status.connected;\r\n      this.networkStatus$.next(this.isConnected);\r\n    });\r\n\r\n    this.networkStatus$.subscribe((isConnected) => {\r\n      if (isConnected) {\r\n        this.router.navigate(['home']);\r\n      } else {\r\n        this.router.navigate(['network']);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  initializeApp() {\r\n    this.platform.ready().then(async () => {\r\n      try {\r\n        await this.initializeRideStateListener();\r\n      } catch (error) {\r\n        console.error('Error initializing app:', error);\r\n        this.setStage(this.STAGES.BOOKING);\r\n      }\r\n    });\r\n  }\r\n\r\n  \r\n \r\n  async initializeGeolocation() {\r\n    try {\r\n      let coordinates;\r\n      \r\n      if (this.platform.is('capacitor')) {\r\n        coordinates = await Geolocation.getCurrentPosition({\r\n          timeout: 10000\r\n        });\r\n      } else {\r\n        // Web fallback\r\n        coordinates = await new Promise((resolve, reject) => {\r\n          navigator.geolocation.getCurrentPosition(\r\n            (position) => {\r\n              resolve({\r\n                coords: {\r\n                  latitude: position.coords.latitude,\r\n                  longitude: position.coords.longitude,\r\n                  accuracy: position.coords.accuracy,\r\n                  altitude: position.coords.altitude,\r\n                  altitudeAccuracy: position.coords.altitudeAccuracy,\r\n                  heading: position.coords.heading,\r\n                  speed: position.coords.speed\r\n                },\r\n                timestamp: position.timestamp\r\n              });\r\n            },\r\n            (error) => reject(error),\r\n            { timeout: 10000 }\r\n          );\r\n        });\r\n      }\r\n      \r\n      this.coordinates = coordinates;\r\n      this.LatLng = {\r\n        lat: coordinates.coords.latitude,\r\n        lng: coordinates.coords.longitude\r\n      };\r\n      \r\n      await this.database.updateLocation(this.LatLng);\r\n      console.log('Geolocation initialized:', this.LatLng);\r\n      \r\n      this.startPollingPosition();\r\n    } catch (error) {\r\n      console.error('Error initializing geolocation:', error);\r\n      this.overlay.hideLoader();\r\n      await this.overlay.showAlert(\r\n        'Location Error',\r\n        'Unable to get your location. Please check your device settings and try again.'\r\n      );\r\n    }\r\n  }\r\n  \r\n  startPermissionPolling() {\r\n    this.permissionCheckInterval = setInterval(async () => {\r\n      const permissionStatus = await Geolocation.checkPermissions();\r\n      if (permissionStatus.location === 'granted') {\r\n        this.overlay.hideLoader();\r\n        clearInterval(this.permissionCheckInterval);\r\n        // Try to get the current position again if permissions are granted\r\n        const coordinates = await Geolocation.getCurrentPosition();\r\n        this.coordinates = coordinates;\r\n        this.LatLng = {\r\n          lat: coordinates.coords.latitude,\r\n          lng: coordinates.coords.longitude,\r\n        };\r\n        console.log('Geolocation initialized:', this.LatLng);\r\n  \r\n        // Start polling the user's position\r\n        this.startPollingPosition();\r\n      }\r\n    }, 1000); // Check every second\r\n  }\r\n\r\n  \r\n  startPollingPosition() {\r\n    let lastLatLng = { lat: null, lng: null };\r\n    let lastAddress = null;\r\n  \r\n    this.pollingInterval = setInterval(async () => {\r\n      try {\r\n        let position;\r\n        \r\n        if (this.platform.is('capacitor')) {\r\n          position = await Geolocation.getCurrentPosition();\r\n        } else {\r\n          // Web fallback\r\n          position = await new Promise((resolve, reject) => {\r\n            navigator.geolocation.getCurrentPosition(resolve, reject);\r\n          });\r\n        }\r\n\r\n        const newLatLng = {\r\n          lat: position.coords.latitude,\r\n          lng: position.coords.longitude,\r\n        };\r\n\r\n        await this.database.updateLocation(newLatLng);\r\n  \r\n        if (this.hasSignificantLocationChange(lastLatLng, newLatLng, 50)) { // Check if moved at least 50 meters\r\n          lastLatLng = newLatLng;\r\n  \r\n          const address = await this.map.getAddress(newLatLng.lat, newLatLng.lng);\r\n          \r\n          if (address && address.results && address.results.length > 1) {\r\n            const components = address.results[1].address_components;\r\n            if (components.length >= 2) {\r\n              this.locationAddress = components[0].long_name + ' ' + components[1].long_name;\r\n              this.actualLocation = address.results[0].formatted_address;\r\n              if (this.locationAddress !== lastAddress) {\r\n                console.log('Updated Location Address:', this.locationAddress);\r\n                lastAddress = this.locationAddress;\r\n              }\r\n            }\r\n          } else {\r\n            console.log('Unable to update location address');\r\n          }\r\n        }\r\n  \r\n        if (this.networkService.isConnected() && !this.stopPolling) {\r\n          const center: [number, number] = [newLatLng.lat, newLatLng.lng];\r\n          const radiusInM = 8000; // Example radius in meters\r\n          await this.fetchAndDisplayDrivers(center, radiusInM);\r\n        } else {\r\n          console.log('No network connection.', this.stopPolling);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error getting position:', err);\r\n        // Reduce error alerts by not showing specific errors repeatedly\r\n      }\r\n    }, 5000); // Poll every 10 seconds\r\n  }\r\n  \r\n  hasSignificantLocationChange(oldLatLng, newLatLng, minDistance) {\r\n    if (!oldLatLng.lat || !oldLatLng.lng) return true;\r\n    \r\n    const R = 6371e3; // Earth radius in meters\r\n    const 1 = oldLatLng.lat * Math.PI/180;\r\n    const 2 = newLatLng.lat * Math.PI/180;\r\n    const  = (newLatLng.lat - oldLatLng.lat) * Math.PI/180;\r\n    const  = (newLatLng.lng - oldLatLng.lng) * Math.PI/180;\r\n  \r\n    const a = Math.sin(/2) * Math.sin(/2) +\r\n              Math.cos(1) * Math.cos(2) *\r\n              Math.sin(/2) * Math.sin(/2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\r\n  \r\n    const distance = R * c; // Distance in meters\r\n  \r\n    return distance >= minDistance;\r\n  }\r\n\r\n  \r\n  stopPollingPosition() {\r\n    if (this.pollingInterval) {\r\n      clearInterval(this.pollingInterval);\r\n      this.pollingInterval = null;\r\n      console.log('Stopped polling position.');\r\n    } else {\r\n      console.log('No polling to stop.');\r\n    }\r\n  }\r\n  \r\n  async initializeMap() {\r\n    try {\r\n      // Ensure coordinates are available before creating map\r\n      \r\n      if (!this.coordinates || !this.coordinates.coords) {\r\n         await this.overlay.showAlert('Coordinates not available, using default location', '');\r\n        console.warn('Coordinates not available, using default location');\r\n        // Use default coordinates (Kuala Lumpur, Malaysia)\r\n        this.coordinates = {\r\n          coords: {\r\n            latitude: 3.1390,\r\n            longitude: 101.6869,\r\n            accuracy: 0,\r\n            altitude: null,\r\n            altitudeAccuracy: null,\r\n            heading: null,\r\n            speed: null\r\n          },\r\n          timestamp: Date.now()\r\n        };\r\n      }\r\n      \r\n      await this.map.createMap(this.mapRef.nativeElement, this.coordinates);\r\n      this.mapy = true;\r\n      this.actualLocation = this.map.actualLocation;\r\n     // console.log('Map initialized:', this.actualLocation, this.locationAddress);\r\n    } catch (error) {\r\n      this.overlay.showAlert('Error initializing map:', error);\r\n      throw new Error('Map initialization failed');\r\n    }\r\n  }\r\n  \r\n  initializeDatabaseSubscriptions() {\r\n    this.database.getKnownPlaces().subscribe((d) => {\r\n      console.log('Received data:', d);\r\n      this.places = d.slice(0, 3);\r\n    });\r\n  }\r\n\r\n\r\n  initializeBackButtonCustomHandler(): void {\r\n    this.platform.backButton.subscribeWithPriority(10, () => {\r\n      console.log('Back button pressed');\r\n    });\r\n  \r\n    App.addListener('backButton', ({ canGoBack }) => {\r\n      if (!canGoBack) {\r\n        // Show a confirmation dialog before exiting the app\r\n        if (confirm('Are you sure you want to exit the app?')) {\r\n          App.exitApp();\r\n        }\r\n      } else {\r\n        console.log(\"back clicked\");\r\n        // Use Ionic's NavController to navigate back\r\n        // Replace 'NavController' with your specific navigation method\r\n        // this.navCtrl.pop();\r\n        window.history.back();\r\n      }\r\n    });\r\n\r\n    // App.addListener('appStateChange', (state) => {\r\n    //   if (!state.isActive) {\r\n    //     this.stopPollingPosition();\r\n    //   } else {\r\n    //     this.startPollingPosition();\r\n    //   }\r\n    // });\r\n  }\r\n  \r\n\r\n\r\n  \r\n  setupMapListeners() {\r\n    this.map.newMap.setOnCameraIdleListener(async (g) => {\r\n      this.ngZone.run(async () => {\r\n        this.showResetLocationButton = true;\r\n        if (this.mapPinStage) {\r\n          const addressResponse = await this.geocode.getAddress(g.latitude, g.longitude).toPromise();\r\n          this.processAddressResponse(addressResponse);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  async logout() {\r\n    await this.authService.logout();\r\n  }\r\n  \r\n  async fetchAndDisplayDrivers(center: [number, number], radiusInM: number): Promise<void> {\r\n    try {\r\n      const drivers: Drivers[] = await this.database.checkDriversWithin(center, radiusInM);\r\n      console.log('Fetched drivers:', drivers);\r\n  \r\n      await this.handleDrivers(drivers);\r\n  \r\n      if (this.drivers_Requested.length > 0) {\r\n        this.current_Request_Number = 0; // Set to the first available driver\r\n        await this.UpdateCarMarker(this.drivers_Requested);\r\n        this.NoDrivers = false;\r\n      } else {\r\n        this.current_Request_Number = -1; // No valid driver\r\n        await this.UpdateCarMarker([]); // Clear all markers if no drivers are requested\r\n        this.NoDrivers = true;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching drivers:', error);\r\n      this.current_Request_Number = -1; // Reset the request number\r\n      await this.UpdateCarMarker([]); // Clear all markers if there's an error\r\n      this.NoDrivers = true;\r\n    }\r\n  }\r\n  \r\n  \r\n  async handleDrivers(drivers: Drivers[]) {\r\n    this.drivers_Requested = [];\r\n    this.closeDrivers = null;\r\n  \r\n    console.log('Handling drivers:', drivers);\r\n  \r\n    if (drivers.length === 0) {\r\n      this.NoDrivers = true;\r\n      console.log('No drivers found.');\r\n      return;\r\n    }\r\n  \r\n    drivers.forEach((driver) => {\r\n      if (driver) {\r\n        console.log('Processing driver:', driver);\r\n        if (driver.duration <= 1000 && driver.onlineState) {\r\n          this.drivers_Requested.push(driver);\r\n          this.updateDriverInfo(driver);\r\n        }\r\n  \r\n        if (!this.closeDrivers || driver.duration < this.closeDrivers.duration) {\r\n          this.closeDrivers = driver;\r\n        }\r\n      } else {\r\n        console.error('Driver is null or undefined:', driver);\r\n      }\r\n    });\r\n  \r\n    if (this.drivers_Requested.length === 0) {\r\n      this.NoDrivers = true;\r\n    } else {\r\n      // Ensuring current_Request_Number is within the bounds\r\n      this.current_Request_Number = Math.min(this.current_Request_Number, this.drivers_Requested.length - 1);\r\n    }\r\n  \r\n    console.log('Final requested drivers list:', this.drivers_Requested);\r\n  }\r\n  \r\n   // Unsubscribe from all active listeners (for cleanup)\r\n   cleanupListeners() {\r\n    Object.values(this.database.activeListeners).forEach(unsubscribe => unsubscribe());\r\n    this.database.activeListeners = {};\r\n  }\r\n \r\n  \r\n  updateDriverInfo(driver) {\r\n    console.log(this.drivers_Requested);\r\n    this.carname = driver.Driver_car;\r\n    this.driverImage = driver.Driver_imgUrl,\r\n    this.driver_duration_apart = Math.ceil(driver.duration / 60000);\r\n    this.driver_ID = driver.Driver_id;\r\n    this.driver_number_of_seats = driver.seats;\r\n    this.DriverLatLng = {\r\n      lat: driver.Driver_lat,\r\n      lng: driver.Driver_lng\r\n    };\r\n  }\r\n  \r\n  async StartRide() {\r\n    if (this.isLoadingDriver) {\r\n      console.log('Ride request already in progress...');\r\n      return;\r\n    }\r\n\r\n    this.isLoadingDriver = true;\r\n    this.overlay.showLoader('Preparing your ride...');\r\n\r\n    try {\r\n      // Group operations that can be done concurrently\r\n      await Promise.all([\r\n        this.clearPrevMarkers(),\r\n        this.clearAllPolylines()\r\n      ]);\r\n      \r\n      this.map.newMap.enableTouch();\r\n      await this.BookRide();\r\n      \r\n    } catch (error) {\r\n      console.error('Error starting ride:', error);\r\n      await this.overlay.showAlert('Starting Ride Error', error.message || 'Failed to start ride');\r\n    } finally {\r\n      // Ensure we always hide the loader and reset the loading state\r\n      this.isLoadingDriver = false;\r\n      this.overlay.hideLoader();\r\n    }\r\n  }\r\n\r\nasync clearMarkers() {\r\n  if (this.marker1) {\r\n    await this.map.newMap.removeMarker(this.marker1);\r\n    this.marker1 = null;\r\n  }\r\n\r\n  if (this.marker2) {\r\n    await this.map.newMap.removeMarker(this.marker2.toString());\r\n    this.marker2 = null;\r\n  }\r\n\r\n  if (this._carmarkers) {\r\n    for (const { marker } of this._carmarkers) {\r\n      await this.map.newMap.removeMarker(marker); // Assuming marker is the instance\r\n    }\r\n    this._carmarkers = []; // Clear the array after removing markers\r\n  }\r\n}\r\n\r\nasync BookRide() {\r\n  try {\r\n    if (!await this.ensureProfileInitialized()) {\r\n      throw new Error('Profile not initialized');\r\n    }\r\n    if (!this.hasValidDriver()) {\r\n      this.showNoDriversAlert();\r\n      return;\r\n    }\r\n    \r\n    const driver = this.drivers_Requested[this.current_Request_Number];\r\n    const userDocRef = doc(this.firestore, `Drivers`, driver.Driver_id);\r\n    \r\n    const docSnapshot = await getDoc(userDocRef);\r\n    \r\n    if (!docSnapshot.exists()) {\r\n      throw new Error('Driver document not found');\r\n    }\r\n\r\n    const data = docSnapshot.data();\r\n    if (!data?.onlineState) {\r\n      await this.handleNoAvailableDriver();\r\n      return;\r\n    }\r\n\r\n    this.driverInfo = data;\r\n    await this.requestRideWithDriverDetails(driver, userDocRef);\r\n    this.updateDriverInfo(driver);\r\n    \r\n  } catch (error) {\r\n    console.error('Error in BookRide:', error);\r\n    this.overlay.showAlert('Error', 'Unable to book ride. Please try again.');\r\n  }\r\n}\r\n\r\nhasValidDriver(): boolean {\r\n  return this.drivers_Requested?.[this.current_Request_Number]?.Driver_id != null;\r\n}\r\n\r\nasync requestRideWithDriverDetails(driver, userDocRef) {\r\n  try {\r\n    if (!await this.ensureProfileInitialized()) {\r\n      throw new Error('Profile not initialized');\r\n    }\r\n    const requestDetails = {\r\n      latLng: this.LatLng,\r\n      destinationAddress: this.destinationAddress,\r\n      locationAddress: this.locationAddress,\r\n      dLatLng: this.D_LatLng,\r\n      driverId: driver.Driver_id,\r\n      price: this.price,\r\n      cash: this.cash\r\n    };\r\n\r\n    this.requestID = await this.database.RequestRideWithRiderDetails(requestDetails);\r\n\r\n    if (this.requestID) {\r\n      this.currentDriver = driver;\r\n      \r\n      // Set up listener before handling pending state\r\n      const rideRequestDocRef = doc(this.firestore, `Request`, this.requestID);\r\n      const unsub = onSnapshot(rideRequestDocRef, async (doc) => {\r\n        if (doc.exists()) {\r\n          await this.handleRideUpdates(doc);\r\n        } else {\r\n          console.error('Ride request document does not exist.');\r\n        }\r\n      });\r\n\r\n      this.unsubscribe = unsub;\r\n      \r\n      // Now handle the pending state\r\n      await this.handlePendingState();\r\n    } else {\r\n      throw new Error('Failed to generate requestID');\r\n    }\r\n  } catch (error) {\r\n    console.error('Error in requestRideWithDriverDetails:', error);\r\n    this.overlay.showAlert('Error', 'Unable to request ride. Please try again.');\r\n  }\r\n}\r\n\r\nshowNoDriversAlert() {\r\n  console.error('No valid driver available to book a ride.');\r\n  this.overlay.showAlert('No Drivers ', 'No available drivers found. Please try again later.');\r\n}\r\n\r\nasync handleNoAvailableDriver() {\r\n  console.log('Driver is not available, moving to next.');\r\n  this.current_Request_Number++;\r\n  if (this.hasValidDriver()) {\r\n    await this.BookRide();\r\n  } else {\r\n    this.showNoDriversAlert();\r\n  }\r\n}\r\n\r\n// Make sure to clear the subscription when it's no longer needed\r\nclearSubscriptions() {\r\n  console.log('Clearing all subscriptions');\r\n  \r\n  // Clear routeUpdateSubscription first as it's the main culprit\r\n  if (this.routeUpdateSubscription) {\r\n    this.routeUpdateSubscription.unsubscribe();\r\n    this.routeUpdateSubscription = null;\r\n  }\r\n  \r\n  // Clear other subscriptions\r\n  if (this.numCalls) {\r\n    this.numCalls.unsubscribe();\r\n    this.numCalls = null;\r\n  }\r\n  if (this.countDown) {\r\n    this.countDown.unsubscribe();\r\n    this.countDown = null;\r\n  }\r\n  if (this.unsubscribe) {\r\n    this.unsubscribe();\r\n    this.unsubscribe = null;\r\n  }\r\n  \r\n  // Stop any polling interval\r\n  if (this.pollingInterval) {\r\n    clearInterval(this.pollingInterval);\r\n    this.pollingInterval = null;\r\n  }\r\n  \r\n  // Reset any animation state\r\n  this.animatedMarker = null;\r\n}\r\n\r\nasync handleRideUpdates(doc) {\r\n  const data = doc.data();\r\n  if (!data) return;\r\n\r\n  try {\r\n    switch (data.status) {\r\n      case 'confirmed':\r\n        await this.handleRideConfirmation(doc);\r\n        break;\r\n      case 'started':\r\n        await this.handleRideStart(doc);\r\n        break;\r\n      case 'stopped':\r\n        await this.handleRideStop(doc);\r\n        break;\r\n      case 'cancelled':\r\n        await this.handleRideCancellation(data);\r\n        break;\r\n    }\r\n  } catch (error) {\r\n    console.error('Error handling ride updates:', error);\r\n    if (error.code === 'permission-denied' || error.code === 'not-found') {\r\n      await this.ReturnHome();\r\n    }\r\n  }\r\n}\r\n\r\n\r\nasync handlePendingState() {\r\n  try {\r\n    // Don't show another loader here since BookRide is already showing one\r\n    if (!this.currentDriver?.Driver_id) {\r\n      throw new Error('No valid driver ID found');\r\n    }\r\n\r\n    // Get driver location with timeout\r\n    const locationPromise = this.getDriverLocation(this.currentDriver.Driver_id);\r\n    const timeoutPromise = new Promise((_, reject) => \r\n      setTimeout(() => reject(new Error('Location fetch timeout')), 10000)\r\n    );\r\n    \r\n    await Promise.race([locationPromise, timeoutPromise]);\r\n\r\n    if (!this.DriverLatLng) {\r\n      throw new Error('Failed to get driver location');\r\n    }\r\n\r\n    // Group all map operations\r\n    await Promise.all([\r\n      this.clearPrevMarkers(),\r\n      this.clearPolyline(this.newPoly),\r\n      this.map.newMap.setCamera({\r\n        animate: true,\r\n        animationDuration: 500,\r\n        zoom: 15,\r\n        coordinate: this.DriverLatLng\r\n      })\r\n    ]);\r\n    \r\n    // Update map height properly instead of using fixed positioning\r\n    this.ngZone.run(() => {\r\n      this.setMapHeightHandleDrivertoRider();\r\n    });\r\n    \r\n    await this.handleDriverToRider(this.DriverLatLng, this.LatLng);\r\n    this.EnterSearchingStage();\r\n    await this.startCountdown(20, this.requestID);\r\n    \r\n  } catch (error) {\r\n    console.error('Error in handlePendingState:', error);\r\n    throw error; // Let BookRide handle the error and cleanup\r\n  }\r\n}\r\n\r\n\r\nasync presentCancelRideActionSheet() {\r\n  const actionSheet = await this.actionSheetController.create({\r\n    header: 'Cancel Ride',\r\n    buttons: [\r\n      {\r\n        text: 'Changed my mind',\r\n        handler: () => {\r\n          this.cancelRide('Changed my mind');\r\n        }\r\n      },\r\n      {\r\n        text: 'Driver took too long',\r\n        handler: () => {\r\n          this.cancelRide('Driver took too long');\r\n        }\r\n      },\r\n      {\r\n        text: 'Found another ride',\r\n        handler: () => {\r\n          this.cancelRide('Found another ride');\r\n        }\r\n      },\r\n      {\r\n        text: 'Other',\r\n        handler: () => {\r\n          this.cancelRide('Other');\r\n        }\r\n      },\r\n      {\r\n        text: 'Cancel',\r\n        role: 'cancel'\r\n      }\r\n    ]\r\n  });\r\n  await actionSheet.present();\r\n}\r\n\r\nasync cancelRide(reason: string) {\r\n  const rideRef = doc(this.firestore, 'Request', this.requestID);\r\n  await updateDoc(rideRef, {\r\n    status: 'cancelled',\r\n    cancellationReason: reason,\r\n    canceledBy: 'rider'\r\n  });\r\n  const toast = await this.toastController.create({\r\n    message: 'Ride has been cancelled.',\r\n    duration: 2000\r\n  });\r\n  await toast.present();\r\n}\r\n\r\n\r\n\r\nasync handleRideCancellation(data) {\r\n  this.stopCountdown();\r\n  await this.clearPrevMarkers();\r\n  this.unsubscribe();\r\n  this.clearSubscriptions();\r\n  if (this.drivers_Requested[this.current_Request_Number + 1] && !this.rideHasStarted) {\r\n    this.current_Request_Number++;\r\n    await this.BookRide();\r\n        } else {\r\n    if (data.canceledBy == 'driver') {\r\n      this.overlay.showAlert('Cancelled', 'Driver cancelled');\r\n    } \r\n    this.ClearRide();\r\n      this.ReturnHome();\r\n  }\r\n}\r\n\r\n\r\nasync handleRideStart(doc) {\r\n  try {\r\n    console.log('Starting ride tracking setup...');\r\n    \r\n    // Clear previous visual elements\r\n    await this.clearPrevMarkers();\r\n    await this.clearPolyline(this.newPoly);\r\n    \r\n    // Get ride data and validate\r\n    const data = doc.data();\r\n    if (!data) {\r\n      console.warn('handleRideStart: No data found in document');\r\n      throw new Error('No ride data available');\r\n    }\r\n    \r\n    console.log('handleRideStart data:', data);\r\n    \r\n    // Set ride state flag first to prevent race conditions\r\n    this.rideHasStarted = true;\r\n    \r\n    // Set current driver from document data with fallback options\r\n    if (data.driverDetails) {\r\n      this.currentDriver = data.driverDetails;\r\n      this.driverInfo = data.driverDetails;\r\n    } else if (data.driverId) {\r\n      console.log('Driver details missing, attempting to fetch from driver ID');\r\n      try {\r\n        const driverDoc = await getDoc(doc(this.firestore, 'Drivers', data.driverId));\r\n        if (driverDoc.exists()) {\r\n          this.driverInfo = driverDoc.data();\r\n          this.currentDriver = this.driverInfo;\r\n        }\r\n      } catch (error) {\r\n        console.warn('Failed to fetch driver details:', error);\r\n        // Continue with limited driver info\r\n      }\r\n    }\r\n    \r\n    // Adjust map height before adding markers\r\n    this.setMapHeightHandleDrivertoDestination();\r\n    window.addEventListener('resize', this.setMapHeightHandleDrivertoDestination.bind(this));\r\n    \r\n    // Initialize locations with fallbacks\r\n    this.LatLng = {\r\n      lat: data.Loc_lat || (this.LatLng?.lat || 0),\r\n      lng: data.Loc_lng || (this.LatLng?.lng || 0)\r\n    };\r\n    \r\n    this.D_LatLng = {\r\n      lat: data.Des_lat || (this.D_LatLng?.lat || 0),\r\n      lng: data.Des_lng || (this.D_LatLng?.lng || 0)\r\n    };\r\n    \r\n    // Ensure map is initialized\r\n    if (!this.map.newMap) {\r\n      console.log('Map not initialized in handleRideStart, initializing now...');\r\n      try {\r\n        await this.initializeMap();\r\n      } catch (mapError) {\r\n        console.error('Failed to initialize map:', mapError);\r\n        // Allow continuation with limited functionality\r\n      }\r\n    }\r\n    \r\n    // Get driver location with better error handling\r\n    let driverLocationFetched = false;\r\n    \r\n    if (data.driverId) {\r\n      try {\r\n        console.log('Fetching driver location for ID:', data.driverId);\r\n        \r\n        // Use Promise.race with a timeout to prevent hanging\r\n        const locationPromise = this.database.getDriverLocation(data.driverId);\r\n        const timeoutPromise = new Promise((_, reject) => \r\n          setTimeout(() => reject(new Error('Driver location fetch timeout')), 5000)\r\n        );\r\n        \r\n        const driverLocation = await Promise.race([locationPromise, timeoutPromise]) as any;\r\n        \r\n        if (driverLocation && typeof driverLocation === 'object' && 'lat' in driverLocation && 'lng' in driverLocation) {\r\n          console.log('Got real-time driver location:', driverLocation);\r\n          this.DriverLatLng = {\r\n            lat: driverLocation.lat,\r\n            lng: driverLocation.lng\r\n          };\r\n          driverLocationFetched = true;\r\n        }\r\n      } catch (locationError) {\r\n        console.warn('Error getting real-time driver location:', locationError);\r\n        // Will use fallback below\r\n      }\r\n    }\r\n    \r\n    // Fallback to location in document if real-time fetch failed\r\n    if (!driverLocationFetched) {\r\n      console.log('Using driver location from document data');\r\n      this.DriverLatLng = {\r\n        lat: data.driverDetails?.Driver_lat || data.driver_lat || this.LatLng.lat,\r\n        lng: data.driverDetails?.Driver_lng || data.driver_lng || this.LatLng.lng\r\n      };\r\n    }\r\n    \r\n    // Setup UI state even if visualization might fail\r\n    this.EnterDrivingToDestinationStage();\r\n    this.canCheck = true;\r\n    \r\n    // Proceed with visualization if we have valid coordinates\r\n    if (this.DriverLatLng?.lat && this.D_LatLng?.lat) {\r\n      console.log('Calling handleRiderToDestination with locations:', \r\n                  'Driver:', this.DriverLatLng, \r\n                  'Destination:', this.D_LatLng);\r\n      \r\n      try {\r\n        await this.handleRiderToDestination(this.DriverLatLng, this.D_LatLng);\r\n      } catch (visualError) {\r\n        console.warn('Failed to visualize route, but ride is still active:', visualError);\r\n        // Show a non-blocking toast or notification\r\n        const toast = await this.toastController.create({\r\n          message: 'Route visualization failed, but your ride is still active',\r\n          duration: 3000\r\n        });\r\n        toast.present();\r\n      }\r\n    } else {\r\n      console.warn('Invalid coordinates for visualization:', this.DriverLatLng, this.D_LatLng);\r\n      const toast = await this.toastController.create({\r\n        message: 'Location data incomplete. Your ride is active but not fully visualized.',\r\n        duration: 3000\r\n      });\r\n      toast.present();\r\n    }\r\n    \r\n    console.log('Ride tracking setup completed successfully');\r\n    \r\n  } catch (error) {\r\n    console.error('Error in handleRideStart:', error);\r\n    \r\n    // Still enter driving stage so user can see at least some UI\r\n    this.EnterDrivingToDestinationStage();\r\n    this.canCheck = true;\r\n    \r\n    // Show a less alarming message to the user\r\n    const toast = await this.toastController.create({\r\n      message: 'Some ride details couldn\\'t be loaded. Your ride is still active.',\r\n      duration: 3000\r\n    });\r\n    toast.present();\r\n  }\r\n}\r\n\r\n// Improve handleRideStop to better handle map errors\r\nasync handleRideStop(docSnapshot) {\r\n  try {\r\n    console.log('Handling ride stop...');\r\n    \r\n    // If already processed, exit immediately\r\n    if (this.isRideStopProcessed) {\r\n      console.log('Ride stop already processed, exiting function');\r\n      return;\r\n    }\r\n    \r\n    // Set flag immediately to prevent re-processing\r\n    this.isRideStopProcessed = true;\r\n    \r\n    // Stop all location polling and mapping activities immediately\r\n    this.stopPolling = true;\r\n    \r\n    // Unsubscribe from route updates first\r\n    if (this.routeUpdateSubscription) {\r\n      this.routeUpdateSubscription.unsubscribe();\r\n      this.routeUpdateSubscription = null;\r\n    }\r\n    \r\n    // Then clear other subscriptions\r\n    this.clearSubscriptions();\r\n    \r\n    // Force removal of all map elements with multiple attempts if needed\r\n    for (let attempt = 0; attempt < 3; attempt++) {\r\n      try {\r\n        await this.clearPrevMarkers();\r\n        await this.clearAllPolylines();\r\n        break; // Exit loop if successful\r\n      } catch (e) {\r\n        console.error(`Map cleanup attempt ${attempt + 1} failed:`, e);\r\n        // Short delay before retry\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n      }\r\n    }\r\n    \r\n    // Prepare ride data with proper fallbacks for required fields\r\n    const docData = docSnapshot.data ? docSnapshot.data() : docSnapshot;\r\n    const tripId = docSnapshot.id || this.requestID;\r\n    \r\n    \r\n    const rideData = {\r\n      tripId: tripId || '',\r\n      driverId: docData?.driverDetails?.Driver_id || this.driverInfo?.Driver_id || '',\r\n      driverName: docData?.driverDetails?.Driver_name || this.driverInfo?.Driver_name || 'Unknown Driver',\r\n      driverImage: docData?.driverDetails?.Driver_imgUrl || this.driverInfo?.Driver_imgUrl || '',\r\n      driverCar: docData?.driverDetails?.Driver_car || this.driverInfo?.Driver_car || '',\r\n      driverPlate: docData?.driverDetails?.Driver_plate || this.driverInfo?.Driver_plate || '',\r\n      pickup: docData?.Rider_Location || this.locationAddress || 'Unknown pickup',\r\n      destination: docData?.Rider_Destination || this.destinationAddress || 'Unknown destination',\r\n      price: docData?.price || this.price || 0,\r\n      distance: docData?.distance || this.distance || 0,\r\n      duration: docData?.duration || this.duration || '',\r\n      rating: docData?.driverDetails?.Driver_rating || this.driverInfo?.Driver_rating || 0,\r\n      completed: true,\r\n      completedAt: new Date()\r\n    };\r\n\r\n    // CRITICAL: Clear ride state from storage BEFORE showing modal\r\n    try {\r\n      await Preferences.remove({ key: this.RIDE_STATE_KEY });\r\n      console.log('Cleared ride state from storage');\r\n    } catch (e) {\r\n      console.warn('Error clearing storage:', e);\r\n    }\r\n\r\n    // Reset ride properties BEFORE showing modal\r\n    this.rideHasStarted = false;\r\n    this.driverLocation = null;\r\n    this.lastHandledState = null;\r\n    \r\n    console.log('Showing trip summary with data:', rideData);\r\n    \r\n    // Show the trip summary\r\n    const modal = await this.modalCtrl.create({\r\n      component: TripSummaryComponent,\r\n      componentProps: { rideData }\r\n    });\r\n    \r\n    await modal.present();\r\n    \r\n    // Clean up once modal is dismissed\r\n    modal.onDidDismiss().then(() => {\r\n      console.log('Trip summary dismissed, resetting state');\r\n      this.isRideStopProcessed = false; // Reset the flag\r\n      this.clearRideState();            // Additional cleanup\r\n      this.ReturnHome();                // Return to booking view\r\n    });\r\n\r\n  } catch (error) {\r\n    console.error('Error in handleRideStop:', error);\r\n    this.isRideStopProcessed = false;\r\n    this.ReturnHome();\r\n  }\r\n}\r\n\r\n// Add this method for more thorough ride state cleanup\r\nprivate clearRideState() {\r\n  console.log('Clearing ride state completely');\r\n  \r\n  // First clear all subscriptions\r\n  this.clearSubscriptions();\r\n  \r\n  // Reset all ride-related properties\r\n  this.requestID = null;\r\n  this.driverInfo = null;\r\n  this.currentDriver = null;\r\n  this.driver_marker = null;\r\n  this.rider_marker = null;\r\n  this.destinationMarker = null;\r\n  this.routePolyline = null;\r\n  this.routePath = null;\r\n  this.newPoly = null;\r\n  this.animatedMarker = null;\r\n  this.driverLocation = null;\r\n  this.isRideStopProcessed = false;\r\n  \r\n  // Reset stage-related properties\r\n  this.bookingStage = false;\r\n  this.confirmStage = false;\r\n  this.trackingStage = false;\r\n  this.searchingStage = false;\r\n  this.noDriverStage = false;\r\n  this.drivingToDestinationStage = false;\r\n  this.mapPinStage = false;\r\n  \r\n  // Set default stage\r\n  this.EnterBookingStage();\r\n  \r\n  // Stop polling\r\n  this.stopPolling = false;\r\n  \r\n  // Re-enable map interactions if needed\r\n  if (this.map && this.map.newMap) {\r\n    this.map.newMap.enableCurrentLocation(true);\r\n    this.map.newMap.enableTouch();\r\n  }\r\n}\r\n\r\nasync handleRideConfirmation(docOrData) {\r\n  try {\r\n    console.log('Starting ride confirmation handling...', docOrData);\r\n    this.stopCountdown();\r\n\r\n    // Clear existing markers and polylines\r\n    await Promise.all([\r\n      this.clearPrevMarkers(),\r\n      this.clearPolyline(this.newPoly)\r\n    ]);\r\n\r\n    // Get the ride data\r\n    let rideData;\r\n    let docId;\r\n    \r\n    if (!docOrData) {\r\n      throw new Error('Invalid input: null or undefined');\r\n    }\r\n    \r\n    // Handle different input types\r\n    if (typeof docOrData.data === 'function') {\r\n      // It's a Firebase DocumentSnapshot\r\n      rideData = docOrData.data();\r\n      docId = docOrData.id;\r\n    } else {\r\n      // It's already a data object from currentRide.data()\r\n      rideData = docOrData;\r\n      docId = this.requestID; // Use the current requestID if available\r\n    }\r\n    \r\n    if (!rideData) {\r\n      throw new Error('No ride data found');\r\n    }\r\n\r\n    // Update ride information\r\n    this.requestID = docId || rideData.requestId;\r\n    this.driverInfo = rideData.driverDetails;\r\n    \r\n    // Set driver information for UI display to avoid template errors\r\n    if (this.driverInfo) {\r\n      this.carname = this.driverInfo.Driver_car || 'Unknown Car';\r\n      this.driverImage = this.driverInfo.Driver_imgUrl || 'assets/icon/profile.png';\r\n      this.driver_ID = this.driverInfo.Driver_id;\r\n      this.driver_number_of_seats = this.driverInfo.seats || 4;\r\n      this.driver_duration_apart = this.driverInfo.duration ? \r\n        Math.ceil(this.driverInfo.duration / 60000) : 0;\r\n    }\r\n    \r\n    // Set locations\r\n    this.LatLng = {\r\n      lat: rideData.Loc_lat,\r\n      lng: rideData.Loc_lng\r\n    };\r\n    \r\n    this.D_LatLng = {\r\n      lat: rideData.Des_lat,\r\n      lng: rideData.Des_lng\r\n    };\r\n\r\n    // Initialize map if not already initialized\r\n    if (!this.map.newMap) {\r\n      await this.initializeMap();\r\n    }\r\n\r\n    // Get and wait for driver location\r\n    if (!this.driverInfo?.Driver_id) {\r\n      console.warn('Driver ID not found in driver details, using fallback location');\r\n      // Use fallback location from driver details\r\n      this.driverLocation = {\r\n        lat: this.driverInfo?.Driver_lat || this.driverInfo?.driver_lat,\r\n        lng: this.driverInfo?.Driver_lng || this.driverInfo?.driver_lng\r\n      };\r\n    } else {\r\n      try {\r\n        await this.getDriverLocation(this.driverInfo.Driver_id);\r\n      } catch (locationError) {\r\n        console.warn('Error getting real-time driver location, using fallback:', locationError);\r\n        // Use fallback location from driver details\r\n        this.driverLocation = {\r\n          lat: this.driverInfo?.Driver_lat || this.driverInfo?.driver_lat,\r\n          lng: this.driverInfo?.Driver_lng || this.driverInfo?.driver_lng\r\n        };\r\n      }\r\n    }\r\n\r\n    if (!this.driverLocation?.lat || !this.driverLocation?.lng) {\r\n      throw new Error('Unable to determine driver location');\r\n    }\r\n\r\n    this.DriverLatLng = {\r\n      lat: this.driverLocation.lat,\r\n      lng: this.driverLocation.lng\r\n    };\r\n\r\n    console.log('Driver location set:', this.DriverLatLng);\r\n\r\n    // Set map height and add event listener\r\n    this.setMapHeightHandleDrivertoRider();\r\n    window.addEventListener('resize', this.setMapHeightHandleDrivertoRider.bind(this));\r\n\r\n    // Initialize the map view with driver and rider markers\r\n    await this.handleDriverToRider(this.DriverLatLng, this.LatLng);\r\n\r\n    // Update UI state\r\n    this.EnterTrackingStage();\r\n    \r\n    // Save ride state to local storage\r\n    await this.saveRideStateToStorage();\r\n\r\n    console.log('Ride confirmation handled successfully');\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error handling ride confirmation:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Add this method to save ride state to storage\r\nprivate async saveRideStateToStorage() {\r\n  try {\r\n    const rideState = {\r\n      requestID: this.requestID,\r\n      driverInfo: this.driverInfo,\r\n      LatLng: this.LatLng,\r\n      D_LatLng: this.D_LatLng,\r\n      DriverLatLng: this.DriverLatLng,\r\n      stage: this.getCurrentStage()\r\n    };\r\n    \r\n    await Preferences.set({\r\n      key: 'RIDE_STATE',\r\n      value: JSON.stringify(rideState)\r\n    });\r\n    \r\n    console.log('Ride state saved successfully');\r\n  } catch (error) {\r\n    console.error('Error saving ride state:', error);\r\n    // Don't throw the error as this is not critical\r\n  }\r\n}\r\n\r\n\r\n// Update getDriverLocation to return a Promise<void> and handle errors better\r\ngetDriverLocation(driverId: string): Promise<void> {\r\n  if (!driverId) {\r\n    return Promise.reject(new Error('No driver ID provided'));\r\n  }\r\n\r\n  console.log('Getting driver location for:', driverId);\r\n  return this.database.getDriverLocation(driverId)\r\n    .then(location => {\r\n      if (!location || !location.lat || !location.lng) {\r\n        throw new Error('Invalid location data received');\r\n      }\r\n      console.log('Driver location received:', location);\r\n      this.driverLocation = location;\r\n    })\r\n    .catch(error => {\r\n      console.error('Error getting driver location:', error);\r\n      throw error;\r\n    });\r\n}\r\n\r\n\r\n\r\nasync EnterChat(): Promise<void> {\r\nconst options: ModalOptions = {\r\n    component: EnrouteChatComponent,\r\n    componentProps: {\r\n        userId: this.requestID,\r\n        message: \"\"\r\n    },\r\n   \r\n};\r\n\r\nconst modal = await this.modalCtrl.create(options);\r\nreturn await modal.present();\r\n}\r\n\r\nasync startCountdown(initialTime, requestId) {\r\n  this.countdownActive = true;\r\n  let timeRemaining = initialTime;\r\n\r\n  const updateCountdown = async () => {\r\n    if (!this.countdownActive) {\r\n      console.log('Countdown stopped');\r\n      return;\r\n    }\r\n\r\n    if (timeRemaining > 0) {\r\n      try {\r\n        await this.database.UpdateCountDown(timeRemaining, requestId);\r\n        timeRemaining--;\r\n        setTimeout(updateCountdown, 1000);\r\n      } catch (error) {\r\n        console.error('Error updating countdown:', error);\r\n        // Retry after a short delay\r\n        setTimeout(updateCountdown, 2000);\r\n      }\r\n    } else {\r\n      await this.handleCountdownEnd(requestId);\r\n      console.log('Countdown ended');\r\n    }\r\n  };\r\n\r\n  updateCountdown();\r\n}\r\n\r\nasync handleCountdownEnd(requestId) {\r\n  try {\r\n    // Implement a grace period to account for any delays\r\n    setTimeout(async () => {\r\n      await this.clearPrevMarkers();\r\n      await this.requestNextDriver();\r\n    }, 5000); // 5-second grace period\r\n  } catch (error) {\r\n    console.error('Error handling countdown end:', error);\r\n    // Optionally, retry the operation or notify the user\r\n  }\r\n}\r\n\r\n\r\nstopCountdown() {\r\n  this.countdownActive = false;\r\n}\r\n\r\nasync goBackToAutoComplete() {\r\n  try {\r\n    this.stopPolling = false;\r\n    // Enable current location and set the camera to the initial position\r\n    await this.map.newMap.enableCurrentLocation(true);\r\n \r\n\r\n    await this.ResetState();\r\n\r\n    await this.showAutocompleteModal();\r\n    \r\n\r\n    console.log('Game state reset successfully');\r\n  } catch (error) {\r\n    console.error('Error resetting game state:', error);\r\n  }\r\n}\r\n\r\nprivate async clearPrevMarkers() {\r\n  try {\r\n    // Check if map is initialized\r\n    if (!this.map || !this.map.newMap) {\r\n      console.warn('Map not initialized when clearing markers');\r\n      return; // Exit early if map is not available\r\n    }\r\n    \r\n    console.log('Clearing all markers...');\r\n    \r\n    // Clear individual markers with proper error handling\r\n    const markers = [\r\n      this.rider_marker,\r\n      this.driver_marker,\r\n      this.destinationMarker,\r\n      this.marker1,\r\n      this.marker2,\r\n      this.animatedMarker\r\n    ];\r\n    \r\n    const clearPromises = markers\r\n      .filter(marker => marker !== null && marker !== undefined)\r\n      .map(marker => this.clearMarker(marker).catch(e => {\r\n        console.error('Error clearing specific marker:', e);\r\n        // Continue despite error\r\n        return null;\r\n      }));\r\n    \r\n    await Promise.all(clearPromises);\r\n    \r\n    // Reset all marker references\r\n    this.rider_marker = null;\r\n    this.driver_marker = null;\r\n    this.destinationMarker = null;\r\n    this.marker1 = null;\r\n    this.marker2 = null;\r\n    this.animatedMarker = null;\r\n    \r\n    console.log('All markers cleared successfully');\r\n  } catch (e) {\r\n    console.error('Error in clearPrevMarkers:', e);\r\n    // Just log the error but don't throw, allowing the process to continue\r\n  }\r\n}\r\n\r\n// Add this helper method for individual marker clearing\r\nprivate async clearMarker(marker) {\r\n  if (!marker || !this.map?.newMap) return Promise.resolve();\r\n  \r\n  try {\r\n    console.log('Clearing marker:', marker);\r\n    await this.map.newMap.removeMarker(marker);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error clearing marker:', error);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Modify clearAllPolylines for safer handling\r\nasync clearAllPolylines() {\r\n  try {\r\n    if (!this.map || !this.map.newMap) {\r\n      console.warn('Map not initialized when clearing polylines');\r\n      return;\r\n    }\r\n    \r\n    console.log('Clearing all polylines...');\r\n    \r\n    // Try to clear specific polyline first\r\n    if (this.newPoly) {\r\n      try {\r\n        await this.map.newMap.removePolylines(this.newPoly);\r\n        console.log('Specific polyline cleared');\r\n      } catch (error) {\r\n        console.error('Error clearing specific polyline:', error);\r\n      }\r\n    }\r\n    \r\n    // Reset reference\r\n    this.newPoly = null;\r\n      } catch (error) {\r\n    console.error('Error in clearAllPolylines:', error);\r\n    // Just log the error but don't throw\r\n  }\r\n}\r\n\r\n\r\nasync ResetState(){\r\n  try{\r\n    // Clear previous markers\r\n    await this.clearPrevMarkers();\r\n\r\n    // Clear any existing polylines\r\n    await this.clearPolyline(this.newPoly);\r\n\r\n    await this.map.newMap.setCamera({\r\n      animate: true,\r\n      animationDuration: 500,\r\n      zoom: 15,\r\n      coordinate: this.LatLng\r\n    });\r\n\r\n    this.ResetMapHeight();\r\n    window.addEventListener('resize', this.ResetMapHeight.bind(this));\r\n  \r\n    this.map.newMap.enableTouch();\r\n    // Ensure the map respects the boundaries of the top and bottom bars\r\n    this.current_Request_Number = 0;\r\n    this.price = null;\r\n    this.actualDestination = null;\r\n    this.D_LatLng = { lat: null, lng: null };\r\n    this.destinationAddress = 'Unknown location';\r\n\r\n    await this.map.newMap.enableCurrentLocation(true);\r\n    \r\n  }catch(e){\r\n    throw new Error(e);\r\n    \r\n  }\r\n}\r\n\r\nasync showAutocompleteModal(): Promise<void> {\r\n  const options: ModalOptions = {\r\n      component: AutocompleteComponent,\r\n      componentProps: {\r\n          LatLng: this.LatLng,\r\n          locationAddress: this.locationAddress,\r\n      },\r\n\r\n  };\r\n\r\n  const modal = await this.modalCtrl.create(options);\r\n  await modal.present();\r\n\r\n  const { data } = await modal.onWillDismiss();\r\n  console.log('Modal dismissed with data:', data);\r\n\r\n  this.data = data;\r\n\r\n  if (data.pinOnMap) {\r\n      this.EnterMapPinStage();\r\n      this.mapPinDrag = true;\r\n      this.stopPolling = true;\r\n\r\n  }\r\n\r\n  if (data.home) {\r\n      console.log(\"Entering Booking Stage...\");\r\n      this.EnterBookingStage();\r\n      this.stopPolling = false;\r\n      this.ResetState();\r\n  }\r\n\r\n  if (data.searching) {\r\n      this.database.AddKnownPlace(data);\r\n      this.destinationAddress = data.full;\r\n      this.actualDestination = data.whole.full;\r\n\r\n      try {\r\n          const latLng = await this.geocode.getLatLng(data.whole.description).toPromise();\r\n          this.D_LatLng = {\r\n              lat: latLng.results[0].geometry.location.lat,\r\n              lng: latLng.results[0].geometry.location.lng,\r\n          };\r\n          console.log(\"Destination LatLng:\", this.D_LatLng);\r\n\r\n          await this.getDistanceAndDirections();\r\n    } catch (error) {\r\n          console.error(\"Error in geocoding:\", error);\r\n          this.overlay.showAlert('Error in geocoding:', error.message);\r\n      }\r\n  }\r\n}\r\n\r\n\r\nasync RequestRide(dat) {\r\n  if (!this.NoDrivers) {\r\n    this.destinationAddress = dat.place.full;\r\n    this.actualDestination = dat.place.whole.full;\r\n\r\n    try {\r\n      const latLng = await this.geocode.getLatLng(dat.place.whole.description).toPromise();\r\n      this.D_LatLng = {\r\n        lat: latLng.results[0].geometry.location.lat,\r\n        lng: latLng.results[0].geometry.location.lng,\r\n      };\r\n\r\n      await this.getDistanceAndDirections();\r\n  } catch (error) {\r\n      console.error(\"Error in geocoding:\", error);\r\n      this.overlay.showAlert('Check Your Network', error.message);\r\n    }\r\n  } else {\r\n    this.EnterNoDriverStage();\r\n    console.log(\"No drivers available\");\r\n  }\r\n}\r\n\r\nasync getDistanceAndDirections() {\r\n  console.log(\"getDistanceAndDirections called\");\r\n  this.duration = null;\r\n  await this.clearMarkers();\r\n  this.cleanupListeners();\r\n  this.stopPolling = true;\r\n\r\n  if (this.D_LatLng && this.D_LatLng.lat) {\r\n    console.log(\"D_LatLng is set:\", this.D_LatLng);\r\n\r\n    if (!this.NoDrivers) {\r\n      this.EnterConfirmStage();\r\n    } else {\r\n      this.EnterNoDriverStage();\r\n      console.log(\"No drivers available\");\r\n      return;\r\n    }\r\n    \r\n    const origin1 = new google.maps.LatLng(this.LatLng.lat, this.LatLng.lng);\r\n    const origin2 = new google.maps.LatLng(this.D_LatLng.lat, this.D_LatLng.lng);\r\n    \r\n    const request = {\r\n      origin: origin1,\r\n      destination: origin2,\r\n      travelMode: google.maps.TravelMode.DRIVING,\r\n    };\r\n    \r\n    this.geocode.directions.route(request, async (response, status) => {\r\n      if (status === 'OK') {\r\n        this.direction = response;\r\n        this.distance = response.routes[0].legs[0].distance.value;\r\n        this.bounds = response.routes[0].bounds;\r\n        this.price = await this.database.getPriceEstimate(this.distance);\r\n        this.duration = response.routes[0].legs[0].duration.text;\r\n\r\n        // Build full path from the directions response so polyline follows the route\r\n        const path = response.routes[0].overview_path.map(latlng => ({\r\n          lat: latlng.lat(),\r\n          lng: latlng.lng()\r\n        }));\r\n\r\n        await this.createAndAddMarkers(this.LatLng, this.D_LatLng, path);\r\n\r\n        // Call getDistanceAndDirectionsDriver after this part is successful\r\n        await this.getDistanceAndDirectionsDriver();\r\n      } else {\r\n        console.error('Direction ERROR:', response);\r\n        this.overlay.showAlert('Check Your Network', JSON.stringify(response));\r\n      }\r\n    });\r\n  } else {\r\n    this.overlay.showAlert('Drag Map', 'Drag the map and stop on your required destination');\r\n    console.error('D_LatLng or D_LatLng.lat is undefined');\r\n  }\r\n}\r\n\r\nasync getDistanceAndDirectionsDriver() {\r\n  console.log(\"getDistanceAndDirectionsDriver called\");\r\n\r\n  if (!this.NoDrivers) {\r\n    console.log(\"Driver LatLng:\", this.DriverLatLng);\r\n\r\n    if (this.DriverLatLng) {\r\n      const origin1 = new google.maps.LatLng(this.LatLng.lat, this.LatLng.lng);\r\n      const origin2 = new google.maps.LatLng(this.DriverLatLng.lat, this.DriverLatLng.lng);\r\n\r\n      const request = {\r\n        origin: origin1,\r\n        destination: origin2,\r\n        travelMode: google.maps.TravelMode.DRIVING,\r\n      };\r\n\r\n      this.geocode.directions.route(request, (response, status) => {\r\n        if (status === 'OK') {\r\n          this.D_duration = response.routes[0].legs[0].duration.text;\r\n          console.log(\"Driver duration:\", this.D_duration);\r\n        } else {\r\n          console.error('Direction ERROR:', response);\r\n          this.overlay.showAlert('Direction ERROR:', JSON.stringify(response));\r\n        }\r\n      });\r\n    } else {\r\n      console.log(\"DriverLatLng is undefined\");\r\n    }\r\n  } else {\r\n    console.log(\"No drivers available\");\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\nasync resetLocation(): Promise<void> {\r\nconsole.log(this.LatLng);\r\nawait this.map.newMap.setCamera({\r\n    animate: true,\r\n    animationDuration: 500,\r\n    zoom: 15,\r\n    coordinate: this.LatLng\r\n});\r\nthis.showResetLocationButton = false;\r\n}\r\n\r\n\r\n\r\nprocessAddressResponse(addressResponse) {\r\n  console.log(\"processAddressResponse : \" + addressResponse);\r\n  if (addressResponse) {\r\n      console.log(addressResponse);\r\n      this.actualDestination = this.map.actualLocation;\r\n      const results = addressResponse.results;\r\n\r\n      if (results && results.length > 1 && results[1].geometry && results[1].geometry.location) {\r\n          this.D_LatLng = {\r\n              lat: results[1].geometry.location.lat,\r\n              lng: results[1].geometry.location.lng\r\n          };\r\n\r\n          const addressComponents = results[1].address_components;\r\n          if (addressComponents && addressComponents.length > 1) {\r\n              this.destinationAddress = `${addressComponents[0].long_name} ${addressComponents[1].long_name}`;\r\n              console.log(\"this is it \" + this.destinationAddress);\r\n          } else {\r\n              console.log('Address components are missing or incomplete.');\r\n              this.destinationAddress = 'Unknown address';\r\n          }\r\n      } else {\r\n          console.log('Results are missing or incomplete.');\r\n          this.D_LatLng = { lat: null, lng: null };\r\n          this.destinationAddress = 'Unknown location';\r\n      }\r\n  } else {\r\n      console.log('Failed to fetch address.');\r\n      this.D_LatLng = { lat: null, lng: null };\r\n      this.destinationAddress = 'Failed to fetch address';\r\n  }\r\n}\r\n\r\n\r\nasync UpdateCarMarker(elements: Drivers[]) {\r\n  console.log('Elements to update car markers:', elements);\r\n\r\n  const bounds = new google.maps.LatLngBounds();\r\n\r\n  // Create a map of driver IDs to driver elements for quick lookup\r\n  const driverMap = new Map(elements.map(element => [element.Driver_id, element]));\r\n\r\n  // Track markers to keep and update\r\n  const updatedMarkers: { id: string, marker: any }[] = [];\r\n\r\n  // Remove markers that are not needed and update positions\r\n  for (const { id, marker } of this._carmarkers) {\r\n    const driver = driverMap.get(id);\r\n    if (!driver || !driver.onlineState) {\r\n      console.log(`Removing marker for driver ID: ${id}`);\r\n      await this.map.newMap.removeMarker(marker); // Remove the marker from the map\r\n    } else if (driver.Driver_lat !== undefined && driver.Driver_lng !== undefined) {\r\n      const latlng = { lat: driver.Driver_lat, lng: driver.Driver_lng };\r\n      // Remove old marker and add a new one with updated position\r\n      await this.map.newMap.removeMarker(marker);\r\n     // updatedMarkers.push({ id, marker: newMarker });\r\n      bounds.extend(latlng);\r\n      console.log(`Updated marker for driver ID: ${id}`);\r\n    } else {\r\n      console.error('Invalid driver coordinates:', driver);\r\n    }\r\n  }\r\n\r\n  // Add new markers for drivers that are online and not in the existing markers\r\n  for (const element of elements) {\r\n    if (element.onlineState) {\r\n      const existingMarkerIndex = updatedMarkers.findIndex(({ id }) => id === element.Driver_id);\r\n      if (existingMarkerIndex === -1 && element.Driver_lat !== undefined && element.Driver_lng !== undefined) {\r\n        const latlng = { lat: element.Driver_lat, lng: element.Driver_lng };\r\n        console.log(`Adding new marker for driver ID: ${element.Driver_id} at`, latlng);\r\n        try {\r\n          // const marker = await this.map.newMap.addMarker({\r\n          //   coordinate: latlng,\r\n          //   iconUrl: 'https://i.ibb.co/KDy365b/hatchback.png',\r\n          //   title: 'Driver',\r\n          //   iconSize: { width: 30, height: 30 }\r\n          // });\r\n\r\n          // if (marker) {\r\n          //   updatedMarkers.push({ id: element.Driver_id, marker });\r\n          //   bounds.extend(latlng);\r\n          // }\r\n        } catch (error) {\r\n          console.error('Error adding marker:', error);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Update the _carmarkers array with the updated markers\r\n  this._carmarkers = updatedMarkers;\r\n\r\n  // Center the map around the car markers if there are any markers\r\n  if (updatedMarkers.length > 0) {\r\n    const mapDim = {\r\n      height: this.mapRef.nativeElement.offsetHeight,\r\n      width: this.mapRef.nativeElement.offsetWidth\r\n    };\r\n\r\n    const minZoom = 5; // Define your minimum zoom level\r\n    const maxZoom = 18; // Define your maximum zoom level\r\n    \r\n    let zoomLevel = await this.map.getBoundsZoomLevel(bounds, mapDim);\r\n    \r\n    // Constrain the zoom level within the min and max range\r\n    zoomLevel = Math.max(minZoom, Math.min(maxZoom, zoomLevel));\r\n    \r\n    console.log('Setting camera with zoom level:', zoomLevel);\r\n    \r\n    await this.map.newMap.setCamera({\r\n      animate: true,\r\n      animationDuration: 500,\r\n      zoom: zoomLevel,\r\n      coordinate: bounds.getCenter()\r\n    });\r\n\r\n    this.map.newMap.fitBounds(bounds);\r\n      } else {\r\n    console.log('No markers to display on the map.');\r\n  }\r\n}\r\n\r\n\r\n\r\nasync GoHome() {\r\n  await this.map.newMap.enableCurrentLocation(true);\r\n  this.current_Request_Number = 0;\r\n  this.stopPolling = false;\r\n  this.price = null;\r\n  this.EnterBookingStage();\r\n  await this.map.newMap.setCamera({\r\n      animate: true,\r\n      animationDuration: 500,\r\n      zoom: 15,\r\n      coordinate: this.LatLng\r\n  });\r\n}\r\n\r\nasync GotoSupport() {\r\n  await this.nav.navigateForward('support');\r\n}\r\n\r\n\r\nasync ReturnHome() {\r\n  await this.ResetState();\r\n  this.EnterBookingStage();\r\n  this.stopPolling = false;\r\n  await this.map.newMap.setCamera({\r\n      animate: true,\r\n      animationDuration: 500,\r\n      zoom: 15,\r\n      coordinate: this.LatLng\r\n  });\r\n}\r\n\r\nasync CancelRide() {\r\n  try {\r\n    this.overlay.showLoader('Cancelling your ride...');\r\n    await this.clearPrevMarkers();\r\n    await this.clearPolyline(this.newPoly);\r\n\r\n    this.unsubscribe();\r\n    this.numCalls.unsubscribe();\r\n    this.riderCleared = true;\r\n    await this.database.cancelRide(this.requestID);\r\n    await this.map.newMap.enableCurrentLocation(true);\r\n    this.current_Request_Number = 0;\r\n    this.price = null;\r\n    this.EnterBookingStage();\r\n    this.overlay.hideLoader();\r\n    await this.map.newMap.setCamera({\r\n      animate: true,\r\n      animationDuration: 500,\r\n      zoom: 15,\r\n      coordinate: this.LatLng\r\n    });\r\n    await this.clearRideState();\r\n  } catch (error) {\r\n    this.overlay.hideLoader();\r\n    console.error('Error cancelling ride:', error);\r\n    this.overlay.showAlert('Error', 'Failed to cancel ride. Please try again.');\r\n  }\r\n}\r\n\r\nasync ClearRide() {\r\n  try {\r\n    const user = this.auth.currentUser;\r\n    if (user) {\r\n      const riderDocRef = doc(this.firestore, 'Riders', user.uid);\r\n      await updateDoc(riderDocRef, {\r\n        currentRequestId: null\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.error('Error clearing ride state:', error);\r\n  }\r\n\r\n  this.EnterBookingStage();\r\n  await this.clearPrevMarkers();\r\n  await this.clearPolyline(this.newPoly);\r\n  this.newPoly = null;\r\n\r\n  await this.map.newMap.enableCurrentLocation(true);\r\n  this.current_Request_Number = 0;\r\n  this.price = null;\r\n  await this.map.newMap.setCamera({\r\n    animate: true,\r\n    animationDuration: 500,\r\n    zoom: 15,\r\n    coordinate: this.LatLng,\r\n    bearing: 0\r\n  });\r\n}\r\n\r\nasync CallDriver() {\r\n  // Implement CallDriver logic\r\n}\r\n\r\n\r\n// Interval in milliseconds for updating the route\r\nUPDATE_INTERVAL = 10000; // Update every 10 seconds\r\n\r\nasync handleDriverToRider(driverLatLng, riderLatLng) {\r\n  const markerSize = { width: 30, height: 30 };\r\n  const iconAnchor = { x: 15, y: 30 }; // Center bottom of the icon\r\n\r\n  try {\r\n    // Cancel any existing route update subscription first\r\n    if (this.routeUpdateSubscription) {\r\n      this.routeUpdateSubscription.unsubscribe();\r\n      this.routeUpdateSubscription = null;\r\n    }\r\n    \r\n    // Check if map is initialized, if not initialize it\r\n    if (!this.map.newMap) {\r\n      console.log('Map not initialized, initializing now...');\r\n      await this.initializeMap();\r\n    }\r\n    \r\n    // Thoroughly clean up previous visual elements\r\n    await this.clearPrevMarkers();\r\n    await this.clearAllPolylines();\r\n    \r\n    // Use the unified height method and ensure proper positioning\r\n    this.setMapContainerHeight(20);\r\n    \r\n    // Add driver marker at the starting position with adjusted z-index\r\n    const driverMarker = await this.map.newMap.addMarker({\r\n      coordinate: driverLatLng,\r\n      iconUrl: 'assets/icon/car.png',\r\n      title: 'Driver',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      zIndex: 10 // Ensure marker appears above polylines\r\n    });\r\n    this.driver_marker = driverMarker;\r\n\r\n    // Add rider marker with higher z-index\r\n    const riderMarker = await this.map.newMap.addMarker({\r\n      coordinate: riderLatLng,\r\n      iconUrl: this.database.user?.photoURL || 'assets/icon/person.png',\r\n      title: 'Rider',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      zIndex: 11 // Higher than driver marker\r\n    });\r\n    this.rider_marker = riderMarker;\r\n\r\n    // Function to update route, duration, and distance\r\n    const updateRoute = async () => {\r\n        const request = {\r\n          origin: driverLatLng,\r\n        destination: riderLatLng,\r\n          travelMode: google.maps.TravelMode.DRIVING,\r\n        };\r\n\r\n        this.geocode.directions.route(request, async (response, status) => {\r\n          if (status === 'OK') {\r\n            const path = response.routes[0].overview_path.map(latlng => ({\r\n              lat: latlng.lat(),\r\n              lng: latlng.lng()\r\n            }));\r\n            this.duration = response.routes[0].legs[0].duration.text;\r\n            this.distance = response.routes[0].legs[0].distance.text;\r\n\r\n            console.log(`Duration: ${this.duration}, Distance: ${this.distance}`);\r\n\r\n            const locs = [\r\n              { geoCode: { latitude: driverLatLng.lat, longitude: driverLatLng.lng } },\r\n            { geoCode: { latitude: riderLatLng.lat, longitude: riderLatLng.lng } },\r\n            ];\r\n\r\n            const center = this.map.calculateCenter(locs);\r\n\r\n            const bounds = new google.maps.LatLngBounds();\r\n            bounds.extend(new google.maps.LatLng(driverLatLng.lat, driverLatLng.lng));\r\n          bounds.extend(new google.maps.LatLng(riderLatLng.lat, riderLatLng.lng));\r\n    \r\n            const availableHeight = this.mapRef.nativeElement.offsetHeight;\r\n    \r\n            // Prepare map dimensions for calculating zoom level\r\n            const mapDim = {\r\n              height: availableHeight,\r\n              width: this.mapRef.nativeElement.offsetWidth,\r\n            };\r\n    \r\n            // Calculate zoom level\r\n            const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\r\n    \r\n            // Manually set zoom level if needed\r\n            const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\r\n    \r\n          await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(driverLatLng, riderLatLng));\r\n    \r\n          // Clear existing polyline before drawing a new one\r\n          await this.clearAllPolylines();\r\n          // Draw full route polyline (use overview_path)\r\n          await this.addPolyline(driverLatLng, riderLatLng, path);\r\n            \r\n            // Clear any existing animated marker before starting a new animation\r\n            if (this.animatedMarker) {\r\n              await this.map.newMap.removeMarker(this.animatedMarker);\r\n              this.animatedMarker = null;\r\n            }\r\n            \r\n          // Animate the driver marker along the path to the rider\r\n            await this.animateMarker(this.driver_marker, path, 'assets/icon/car.png');\r\n          } else {\r\n            console.error('Direction ERROR:', response);\r\n            this.overlay.showAlert('Direction ERROR', JSON.stringify(response));\r\n          }\r\n        });\r\n    };\r\n\r\n    // Start updating the route periodically\r\n    const routeUpdate$ = interval(this.UPDATE_INTERVAL).pipe(\r\n      switchMap(() => updateRoute())\r\n    );\r\n\r\n    // Subscribe to the interval observable to start updating\r\n    this.routeUpdateSubscription = routeUpdate$.subscribe();\r\n\r\n  } catch (error) {\r\n    console.error('Error handling driver to rider:', error);\r\n  }\r\n}\r\n\r\n// Update clearPolyline to handle null map\r\nasync clearPolyline(polylineId) {\r\n  if (!polylineId || !this.map?.newMap) return;\r\n  \r\n  try {\r\n    await this.map.newMap.removePolylines(polylineId);\r\n  } catch (error) {\r\n    console.error('Error clearing polyline:', error);\r\n  }\r\n}\r\n\r\n\r\nasync handleRiderToDestination(driverLatLng, destinationLatLng) {\r\n  const markerSize = { width: 30, height: 30 };\r\n  const iconAnchor = { x: 10, y: 0 }; // Center bottom of the icon\r\n\r\n  try {\r\n    // Cancel any existing route update subscription first\r\n    if (this.routeUpdateSubscription) {\r\n      this.routeUpdateSubscription.unsubscribe();\r\n      this.routeUpdateSubscription = null;\r\n    }\r\n    \r\n    // Check if map is initialized, if not initialize it\r\n    if (!this.map.newMap) {\r\n      console.log('Map not initialized, initializing now...');\r\n      await this.initializeMap();\r\n    }\r\n    \r\n    // Reset map position and apply proper height first\r\n    this.mapRef.nativeElement.style.top = '0';\r\n    this.setMapHeightHandleDrivertoDestination();\r\n    \r\n    // Thoroughly clean up previous visual elements\r\n    await this.clearPrevMarkers();\r\n    await this.clearAllPolylines();\r\n    \r\n    // Update driver marker to driver's current position\r\n    const driverMarker = await this.map.newMap.addMarker({\r\n      coordinate: driverLatLng,\r\n      iconUrl: 'assets/icon/car.png',\r\n      title: 'Driver',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      iconOrigin: { x: 0, y: 0 },\r\n      zIndex: 10, // Higher z-index to appear above polyline\r\n    });\r\n    this.driver_marker = driverMarker;\r\n\r\n    // Add destination marker\r\n    const destinationMarker = await this.map.newMap.addMarker({\r\n      coordinate: destinationLatLng,\r\n      iconUrl: 'assets/icon/flag.png',\r\n      title: 'Destination',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      iconOrigin: { x: 0, y: 0 },\r\n      zIndex: 11, // Higher z-index than driver marker\r\n    });\r\n    this.destinationMarker = destinationMarker;\r\n\r\n    // Function to update route, duration, and distance\r\n    const updateRoute = async () => {\r\n        const request = {\r\n          origin: driverLatLng,\r\n          destination: destinationLatLng,\r\n          travelMode: google.maps.TravelMode.DRIVING,\r\n        };\r\n\r\n        this.geocode.directions.route(request, async (response, status) => {\r\n          if (status === 'OK') {\r\n            const path = response.routes[0].overview_path.map(latlng => ({\r\n              lat: latlng.lat(),\r\n              lng: latlng.lng()\r\n            }));\r\n            this.duration = response.routes[0].legs[0].duration.text;\r\n            this.distance = response.routes[0].legs[0].distance.text;\r\n\r\n            console.log(`Duration: ${this.duration}, Distance: ${this.distance}`);\r\n\r\n            const locs = [\r\n              { geoCode: { latitude: driverLatLng.lat, longitude: driverLatLng.lng } },\r\n              { geoCode: { latitude: destinationLatLng.lat, longitude: destinationLatLng.lng } },\r\n            ];\r\n\r\n            const center = this.map.calculateCenter(locs);\r\n\r\n            const bounds = new google.maps.LatLngBounds();\r\n            bounds.extend(new google.maps.LatLng(driverLatLng.lat, driverLatLng.lng));\r\n            bounds.extend(new google.maps.LatLng(destinationLatLng.lat, destinationLatLng.lng));\r\n    \r\n            const availableHeight = this.mapRef.nativeElement.offsetHeight;\r\n    \r\n            // Prepare map dimensions for calculating zoom level\r\n            const mapDim = {\r\n              height: availableHeight,\r\n              width: this.mapRef.nativeElement.offsetWidth,\r\n            };\r\n    \r\n            // Calculate zoom level\r\n            const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\r\n    \r\n            // Manually set zoom level if needed\r\n            const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\r\n    \r\n            // Set the camera to focus on the center point with appropriate zoom level\r\n            await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(driverLatLng, destinationLatLng));\r\n    \r\n          // Clear existing polyline before drawing a new one\r\n          await this.clearAllPolylines();\r\n            // Draw full route polyline (use overview_path)\r\n            await this.addPolyline(driverLatLng, destinationLatLng, path);\r\n            \r\n            // Clear any existing animated marker before starting a new animation\r\n            if (this.animatedMarker) {\r\n              await this.map.newMap.removeMarker(this.animatedMarker);\r\n              this.animatedMarker = null;\r\n            }\r\n            \r\n            // Animate the driver marker along the path to the destination\r\n            await this.animateMarker(this.driver_marker, path, 'assets/icon/car.png');\r\n          } else {\r\n            console.error('Direction ERROR:', response);\r\n            this.overlay.showAlert('Direction ERROR', JSON.stringify(response));\r\n          }\r\n        });\r\n    };\r\n\r\n    // Start updating the route periodically\r\n    const routeUpdate$ = interval(this.UPDATE_INTERVAL).pipe(\r\n      switchMap(() => updateRoute())\r\n    );\r\n\r\n    // Subscribe to the interval observable to start updating\r\n    this.routeUpdateSubscription = routeUpdate$.subscribe();\r\n\r\n  } catch (error) {\r\n    console.error('Error handling rider to destination:', error);\r\n  }\r\n}\r\n\r\n// Add polyline using either a full route path or fallback to start/end\r\nasync addPolyline(loc: { lat: number, lng: number }, des: { lat: number, lng: number }, routePath?: { lat: number, lng: number }[]) {\r\n  try {\r\n    const polylineColor = \"#007bff\";\r\n    const pathPoints = Array.isArray(routePath) && routePath.length > 0 ? routePath : [\r\n      { lat: loc.lat, lng: loc.lng },\r\n      { lat: des.lat, lng: des.lng }\r\n    ];\r\n\r\n    const polylines: Polyline[] = [\r\n      {\r\n        path: pathPoints,\r\n        strokeColor: polylineColor,\r\n        strokeWeight: 8,\r\n        geodesic: true\r\n      }\r\n    ];\r\n\r\n    const addedPolylines = await this.map.newMap.addPolylines(polylines);\r\n    if (Array.isArray(addedPolylines) && addedPolylines.length > 0) {\r\n      this.newPoly = addedPolylines; // assign the returned ids\r\n      console.log('Polylines added:', this.newPoly);\r\n      return this.newPoly;\r\n    } else {\r\n      throw new Error('Failed to add polyline: Unexpected response format');\r\n    }\r\n  } catch (e) {\r\n    console.error('Error Adding Polyline: ', e);\r\n    throw e;\r\n  }\r\n}\r\n\r\n// create markers and optionally draw a full route if provided\r\nasync createAndAddMarkers(loc, des, routePath?: { lat: number, lng: number }[]) {\r\n  const markerSize = { width: 30, height: 30 };\r\n  const iconAnchor = { x: 10, y: 0 }; // Center bottom of the icon\r\n\r\n  try {\r\n    this.map.newMap.disableTouch();\r\n\r\n    // Add start marker\r\n    this.marker1 = await this.map.newMap.addMarker({\r\n      coordinate: loc,\r\n      iconUrl: 'assets/icon/point.png',\r\n      title: 'Start',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      iconOrigin: { x: 1, y: 0 },\r\n    });\r\n\r\n    // Add destination marker\r\n    this.marker2 = await this.map.newMap.addMarker({\r\n      coordinate: des,\r\n      iconUrl: 'assets/icon/flag.png',\r\n      title: 'Destination',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      iconOrigin: { x: 1, y: 0 },\r\n    });\r\n\r\n    // Calculate the center point between the start and destination\r\n    const locs = [\r\n      { geoCode: { latitude: loc.lat, longitude: loc.lng } },\r\n      { geoCode: { latitude: des.lat, longitude: des.lng } },\r\n    ];\r\n\r\n    const center = this.map.calculateCenter(locs);\r\n\r\n    // Calculate the bounds\r\n    const bounds = new google.maps.LatLngBounds();\r\n    bounds.extend(new google.maps.LatLng(loc.lat, loc.lng));\r\n    bounds.extend(new google.maps.LatLng(des.lat, des.lng));\r\n\r\n    // Set map height before calculating zoom level\r\n    this.setMapHeight();\r\n    const availableHeight = this.mapRef.nativeElement.offsetHeight;\r\n\r\n    // Prepare map dimensions for calculating zoom level\r\n    const mapDim = {\r\n      height: availableHeight,\r\n      width: this.mapRef.nativeElement.offsetWidth,\r\n    };\r\n\r\n    // Calculate zoom level\r\n    const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\r\n\r\n    // Manually set zoom level if needed\r\n    const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\r\n\r\n    // Set the camera to focus on the center point with appropriate zoom level\r\n    await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(loc, des));\r\n\r\n    // Add polyline for the route. Prefer full routePath when provided.\r\n    const polylineColor = \"#007bff\";\r\n    const pathPoints = Array.isArray(routePath) && routePath.length > 0 ? routePath : [\r\n      { lat: loc.lat, lng: loc.lng },\r\n      { lat: des.lat, lng: des.lng }\r\n    ];\r\n\r\n    const polylines: Polyline[] = [\r\n      {\r\n        path: pathPoints,\r\n        strokeColor: polylineColor,\r\n        strokeWeight: 8,\r\n        geodesic: true\r\n      }\r\n    ];\r\n\r\n    // Add polyline to the map\r\n    this.newPoly = await this.map.newMap.addPolylines(polylines);\r\n  } catch (error) {\r\n    console.error('Error creating and adding markers:', error);\r\n  }\r\n}\r\n\r\n\r\n\r\n// Update the animateMarker method to properly handle cleanup\r\nasync animateMarker(marker, path, iconUrl) {\r\n  const markerSize = { width: 50, height: 50 };\r\n  const iconAnchor = { x: 25, y: 50 }; // Center bottom of the icon\r\n  \r\n  // Remove any existing animated marker\r\n  if (this.animatedMarker) {\r\n    await this.map.newMap.removeMarker(this.animatedMarker);\r\n    this.animatedMarker = null;\r\n  }\r\n\r\n  let lastMarker = null;\r\n  \r\n  for (let i = 0; i < path.length; i++) {\r\n    // Remove previous animation step marker if it exists\r\n    if (lastMarker) {\r\n      await this.map.newMap.removeMarker(lastMarker);\r\n    }\r\n    \r\n    // Remove the original marker for the first frame of animation\r\n    if (i === 0) {\r\n      await this.map.newMap.removeMarker(marker);\r\n    }\r\n    \r\n    const coordinate = path[i] instanceof google.maps.LatLng ? \r\n                     { lat: path[i].lat(), lng: path[i].lng() } : \r\n                     { lat: path[i].lat, lng: path[i].lng };\r\n                     \r\n    lastMarker = await this.map.newMap.addMarker({\r\n      coordinate: coordinate,\r\n      iconUrl: iconUrl,\r\n      title: 'Moving Marker',\r\n      iconSize: markerSize,\r\n      iconAnchor: iconAnchor,\r\n      iconOrigin: { x: 0, y: 0 },\r\n      zIndex: 20, // Higher than other markers\r\n    });\r\n    \r\n    await new Promise(resolve => setTimeout(resolve, 100)); // Adjust the interval as needed\r\n  }\r\n\r\n  // Store the last position of the animated marker\r\n  this.animatedMarker = lastMarker;\r\n}\r\n\r\n\r\n\r\n\r\nasync ShowDriverInfoPop() {\r\n  const alert = await this.alert.create({\r\n    header: 'Driver Information',\r\n    message: `\r\n      <div style=\"text-align: center;\">\r\n        <h2 style=\"font-size: 1.2em; margin-bottom: 0.5em;\">Car Name: ${this.carname}</h2>\r\n        <div style=\"margin: 10px 0;\">\r\n          <img src=\"${this.driverImage}\" alt=\"Driver Image\" style=\"width: 60px; height: 60px; border-radius: 50%;\">\r\n        </div>\r\n        <p><strong>Duration Apart:</strong> ${this.driver_duration_apart} minutes</p>\r\n        <p><strong>Driver ID:</strong> ${this.driver_ID}</p>\r\n        <p><strong>Number of Seats:</strong> ${this.driver_number_of_seats}</p>\r\n        <p><strong>Driver Location:</strong> (${this.DriverLatLng.lat}, ${this.DriverLatLng.lng})</p>\r\n      </div>\r\n    `,\r\n    buttons: ['OK']\r\n  });\r\n\r\n  await alert.present();\r\n}\r\n\r\n\r\n// State management methods\r\nEnterBookingStage() {\r\n  this.setStage(this.STAGES.BOOKING);\r\n}\r\n\r\nEnterMapPinStage() {\r\n  this.setStage(this.STAGES.MAP_PIN);\r\n}\r\n\r\nEnterConfirmStage() {\r\n  this.setStage(this.STAGES.CONFIRM);\r\n}\r\n\r\nEnterSearchingStage() {\r\n  this.setStage(this.STAGES.SEARCHING);\r\n}\r\n\r\nEnterNoDriverStage() {\r\n  this.setStage(this.STAGES.NO_DRIVER);\r\n}\r\n\r\nEnterTrackingStage() {\r\n  this.setStage(this.STAGES.TRACKING);\r\n}\r\n\r\nEnterDrivingToDestinationStage() {\r\n  this.setStage(this.STAGES.DRIVING);\r\n}\r\n\r\nprivate setStage(stage: string) {\r\n  // Reset all stages first\r\n  this.bookingStage = false;\r\n  this.confirmStage = false;\r\n  this.trackingStage = false;\r\n  this.searchingStage = false;\r\n  this.drivingToDestinationStage = false;\r\n  this.noDriverStage = false;\r\n  this.mapPinStage = false;\r\n\r\n  // Set the appropriate stage without calling Enter methods\r\n  switch (stage) {\r\n    case this.STAGES.BOOKING:\r\n      this.bookingStage = true;\r\n      break;\r\n    case this.STAGES.CONFIRM:\r\n      this.confirmStage = true;\r\n      break;\r\n    case this.STAGES.TRACKING:\r\n      this.trackingStage = true;\r\n      break;\r\n    case this.STAGES.SEARCHING:\r\n      this.searchingStage = true;\r\n      break;\r\n    case this.STAGES.DRIVING:\r\n      this.drivingToDestinationStage = true;\r\n      break;\r\n    case this.STAGES.NO_DRIVER:\r\n      this.noDriverStage = true;\r\n      break;\r\n    case this.STAGES.MAP_PIN:\r\n      this.mapPinStage = true;\r\n      break;\r\n  }\r\n}\r\n\r\nprivate getCurrentStage(): string {\r\n  if (this.bookingStage) return this.STAGES.BOOKING;\r\n  if (this.confirmStage) return this.STAGES.CONFIRM;\r\n  if (this.trackingStage) return this.STAGES.TRACKING;\r\n  if (this.searchingStage) return this.STAGES.SEARCHING;\r\n  if (this.drivingToDestinationStage) return this.STAGES.DRIVING;\r\n  if (this.noDriverStage) return this.STAGES.NO_DRIVER;\r\n  if (this.mapPinStage) return this.STAGES.MAP_PIN;\r\n  return this.STAGES.BOOKING; // default\r\n}\r\n\r\nngOnInit() {\r\n  // ... existing code ...\r\n  \r\n  // Check for \"book again\" navigation state\r\n  const navigation = this.router.getCurrentNavigation();\r\n  if (navigation?.extras.state) {\r\n    const state = navigation.extras.state;\r\n    console.log('Navigation state received:', state);\r\n    \r\n    if (state['bookAgain']) {\r\n      // Wait for the map to be ready\r\n      this.mapLoadedSubscription = this.mapLoadedSubject.subscribe(loaded => {\r\n        if (loaded) {\r\n          setTimeout(() => {\r\n            console.log('Processing book again data:', state);\r\n            this.processBookAgainData(state);\r\n          }, 1000); // Small delay to ensure map is fully ready\r\n        }\r\n      });\r\n    }\r\n  }\r\n  \r\n  // ... existing code ...\r\n}\r\n\r\nasync processBookAgainData(state) {\r\n  try {\r\n    console.log('Setting up rebooking with data:', state);\r\n    \r\n    // Set pickup location\r\n    if (state.pickup && state.pickup.address) {\r\n      this.locationAddress = state.pickup.address;\r\n      \r\n      if (state.pickup.lat && state.pickup.lng) {\r\n        this.LatLng = {\r\n          lat: state.pickup.lat,\r\n          lng: state.pickup.lng\r\n        };\r\n        \r\n        // Add location marker\r\n        await this.addLocationMarker(this.LatLng);\r\n      } else {\r\n        // If no coordinates, geocode the address\r\n        const coords = await this.geocodeService.geocodeAddress(state.pickup.address);\r\n        if (coords) {\r\n          this.LatLng = coords;\r\n          await this.addLocationMarker(coords);\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Set destination\r\n    if (state.destination && state.destination.address) {\r\n      this.destinationAddress = state.destination.address;\r\n      \r\n      if (state.destination.lat && state.destination.lng) {\r\n        this.D_LatLng = {\r\n          lat: state.destination.lat,\r\n          lng: state.destination.lng\r\n        };\r\n        \r\n        // Add destination marker\r\n        await this.addDestinationMarker(this.D_LatLng);\r\n      } else {\r\n        // If no coordinates, geocode the address\r\n        const coords = await this.geocodeService.geocodeAddress(state.destination.address);\r\n        if (coords) {\r\n          this.D_LatLng = coords;\r\n          await this.addDestinationMarker(coords);\r\n        }\r\n      }\r\n    }\r\n    \r\n    // If both locations are set, calculate route\r\n    if (this.LatLng && this.D_LatLng) {\r\n      await this.drawRoute();\r\n      await this.calculatePrice();\r\n      this.EnterConfirmStage();\r\n    }\r\n    \r\n  } catch (error) {\r\n    console.error('Error processing book again data:', error);\r\n    // Show error toast\r\n    const toast = await this.toastCtrl.create({\r\n      message: 'Could not load previous ride data. Please try again.',\r\n      duration: 3000,\r\n      position: 'bottom',\r\n      color: 'danger'\r\n    });\r\n    toast.present();\r\n  }\r\n}\r\n\r\n}","<ion-header class=\"ion-no-border\" [translucent]=\"true\" style=\"position: relative; z-index: 1000;\">\r\n  <!--destination bar-->\r\n  <ion-toolbar class=\"ion-padding\" *ngIf=\"confirmStage\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button shape=\"round\" (click)=\"goBackToAutoComplete()\">\r\n        <ion-icon slot=\"icon-only\" name=\"arrow-back\" color=\"tertiary\"></ion-icon> \r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-title> Cancel </ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-item fill=\"outline\" class=\"duration\" color=\"primary\" lines=\"none\">\r\n        <ion-icon slot=\"icon-only\" name=\"flag\" color=\"primary\"></ion-icon>\r\n        <ion-label *ngIf=\"duration\" color=\"primary\"><h1>{{duration}}</h1></ion-label>\r\n      </ion-item>\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n\r\n  \r\n  <ion-item lines=\"none\" color='light' class=\"main-buttons ion-no-padding\" class='top_bar'  (click)=\"goBackToAutoComplete()\" *ngIf=\"confirmStage\">\r\n      <ion-icon slot=\"start\" color='primary' name=\"pencil\"></ion-icon>\r\n      <ion-label color='primary' >{{destinationAddress}}</ion-label>\r\n  </ion-item>\r\n  \r\n\r\n  <!--menu button-->\r\n  <ion-fab *ngIf=\"bookingStage\" vertical=\"top\" horizontal=\"start\" style=\"top: 35px;\">\r\n    <ion-fab-button color=\"light\">\r\n      <ion-menu-button color=\"primary\"></ion-menu-button>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n\r\n  <!--sos button-->\r\n  <ion-fab *ngIf=\"bookingStage\" vertical=\"top\" horizontal=\"end\" (click)=\"GotoSupport()\" style=\"top: 35px;\">\r\n    <ion-fab-button color=\"light\">\r\n      <ion-icon color=\"primary\" name=\"chatbubble-ellipses\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n\r\n   <!--back button if map Pin-->\r\n   <ion-fab *ngIf=\"mapPinStage\" vertical=\"top\" (click)=\"goBackToAutoComplete()\" horizontal=\"start\" style=\"top: 35px;\">\r\n    <ion-fab-button color=\"light\">\r\n      <ion-icon name=\"arrow-back\" color=\"primary\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n\r\n  <!--Search Bar-->\r\n\r\n  <!-- Driver arrival time header -->\r\n  <ion-toolbar *ngIf=\"trackingStage\" class=\"ion-text-center\">\r\n    <ion-title>Driver Arrives in {{duration}}</ion-title>\r\n  </ion-toolbar>\r\n  \r\n  <!-- Destination arrival time header -->\r\n  <ion-toolbar *ngIf=\"drivingToDestinationStage\" class=\"ion-text-center\">\r\n    <ion-title>Arrival in {{duration}}</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n\r\n<!--Capacitor Google Map-->\r\n\r\n<ion-content [fullscreen]=\"true\" scroll-y=\"false\">\r\n  <capacitor-google-maps #map></capacitor-google-maps>\r\n\r\n\r\n  <ion-fab *ngIf=\"bookingStage && showResetLocationButton\" vertical=\"bottom\" horizontal=\"end\" style=\"bottom: 130px;\">\r\n    <ion-fab-button color=\"light\" (click)=\"resetLocation()\">\r\n      <ion-icon name=\"locate\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n\r\n  \r\n</ion-content>\r\n\r\n\r\n\r\n<ion-fab class=\"centerPin\" *ngIf=\"mapPinStage\" vertical=\"center\" horizontal=\"center\" style=\"z-index: 1000;\">\r\n    <ion-avatar>\r\n      <ion-img src=\"../../assets/icon/pin.png\"></ion-img>\r\n    </ion-avatar>\r\n</ion-fab>\r\n\r\n  <ion-footer  [translucent]=\"true\" class=\"ion-no-border\" style=\"position: relative; z-index: 1000;\">\r\n    <div #bottomBar>\r\n    <ion-row>\r\n\r\n\r\n      <!--where to bar and button-->\r\n      <ion-list class=\"bottomItems shadow-top\" *ngIf=\"bookingStage\" lines=\"full\">\r\n\r\n            <!-- Preset places row -->\r\n            <div class=\"preset-row ion-padding-horizontal\">\r\n              <ion-chip *ngFor=\"let p of presets; let i = index\" (click)=\"selectPreset(p)\" outline=\"true\">\r\n                <ion-label>{{p.name}}</ion-label>\r\n                <ion-icon name=\"close-circle\" slot=\"end\" (click)=\"deletePreset(i); $event.stopPropagation();\"></ion-icon>\r\n              </ion-chip>\r\n\r\n              <ion-button fill=\"clear\" size=\"small\" (click)=\"addCurrentAsPreset()\">\r\n                <ion-icon slot=\"icon-only\" name=\"add-circle\"></ion-icon>\r\n              </ion-button>\r\n            </div>\r\n\r\n  \r\n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom \">\r\n          <ion-button \r\n          [disabled]=\"!locationAddress\" \r\n          shape=\"round\" \r\n          class=\"main-button\" \r\n          size=\"large\" \r\n          type=\"submit\" \r\n          (click)=\"showAutocompleteModal()\" \r\n          expand=\"block\">\r\n          <ion-icon slot=\"start\" name=\"search\" color=\"primary\"></ion-icon>\r\n          <ion-label>{{ locationAddress ? 'Where To?' : 'Waiting for address...' }}</ion-label>\r\n        </ion-button>\r\n        \r\n        </ion-item-group>\r\n\r\n      </ion-list>\r\n\r\n      <!--Map Pin Choose Bar-->\r\n      <ion-list class='bottomItems shadow-top' [hidden]=\"!mapPinStage\" lines=\"full\">\r\n\r\n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\r\n          <ion-button shape=\"round\" size=\"large\" type=\"submit\" (click)=\"getDistanceAndDirections()\" expand=\"block\">\r\n            <ion-icon slot=\"end\" name=\"arrow-forward\"></ion-icon>\r\n            <ion-label>{{destinationAddress}}</ion-label>\r\n          </ion-button>\r\n        </ion-item-group>\r\n\r\n      </ion-list>\r\n\r\n      <!--No driver Found Bar-->\r\n      \r\n      <ion-list class='bottomItems shadow-top' *ngIf=\"noDriverStage\" lines=\"none\">\r\n        <ion-list-header>\r\n          <ion-item style=\"margin:0 auto;\">\r\n              <img src=\"../../assets/imgs/No connection-pana.svg\">\r\n          </ion-item>\r\n            \r\n         </ion-list-header>\r\n       <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\r\n        \r\n               <ion-button shape=\"round\"  class='main-button' size=\"large\" type=\"submit\" color=\"primary\" (click)=\"ReturnHome()\" expand=\"block\">\r\n                 <ion-icon slot=\"start\" name=\"arrow-back\"></ion-icon>\r\n                 <ion-label> No Drivers Here </ion-label>\r\n               </ion-button>\r\n            \r\n       </ion-item-group>\r\n\r\n     </ion-list>\r\n\r\n      <!--Car type, payment, confirmation and Selection Bar-->\r\n      <ion-list class='bottomItems shadow-top' *ngIf=\"confirmStage\" lines=\"none\">\r\n        <!-- Modern card layout -->\r\n        <div class=\"ride-confirmation-card\">\r\n          <!-- Vehicle info with price section -->\r\n          <div *ngIf=\"price\" class=\"ride-details\">\r\n            <div class=\"vehicle-info\" (click)=\"ShowDriverInfoPop()\">\r\n              <ion-avatar>\r\n                <ion-img src=\"../../assets/icon/hatchback.png\"></ion-img>\r\n              </ion-avatar>\r\n              <div class=\"vehicle-details\">\r\n                <h2>{{carname}} <ion-icon name=\"information-circle\" color=\"primary\"></ion-icon></h2>\r\n                <p class=\"vehicle-stats\">\r\n                  <span><ion-icon name=\"time\" color=\"primary\"></ion-icon> {{D_duration}}</span>\r\n                  <span><ion-icon name=\"person\" color=\"primary\"></ion-icon> {{driver_number_of_seats}} seats</span>\r\n                </p>\r\n              </div>\r\n              <div class=\"price-tag\">\r\n                <h2>${{price}}</h2>\r\n                <p class=\"original-price\"><del>${{price*2}}</del></p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- Loading skeleton for ride details -->\r\n          <div *ngIf=\"!price\" class=\"ride-details skeleton\">\r\n            <div class=\"vehicle-info\">\r\n              <ion-avatar>\r\n                <ion-skeleton-text [animated]=\"true\"></ion-skeleton-text>\r\n              </ion-avatar>\r\n              <div class=\"vehicle-details\">\r\n                <h2><ion-skeleton-text [animated]=\"true\" style=\"width: 130px\"></ion-skeleton-text></h2>\r\n                <p class=\"vehicle-stats\">\r\n                  <ion-skeleton-text [animated]=\"true\" style=\"width: 130px\"></ion-skeleton-text>\r\n                </p>\r\n              </div>\r\n              <div class=\"price-tag\">\r\n                <h2><ion-skeleton-text [animated]=\"true\" style=\"width: 60px\"></ion-skeleton-text></h2>\r\n                <p><ion-skeleton-text [animated]=\"true\" style=\"width: 60px\"></ion-skeleton-text></p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <!-- Payment method selector -->\r\n          <div class=\"payment-selector\">\r\n            <ion-item lines=\"none\">\r\n              <ion-icon name=\"wallet-outline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n              <ion-label>Payment Method</ion-label>\r\n              <ion-select [value]=\"selectedCard\" (ionChange)=\"chooseCard($event)\" interface=\"popover\">\r\n                <ion-select-option value=\"cash\">\r\n                  <ion-icon name=\"cash-outline\"></ion-icon> Cash\r\n                </ion-select-option>\r\n                <ion-select-option *ngFor=\"let card of savedPaymentMethods\" [value]=\"card.cardId\">\r\n                  <ion-icon name=\"card-outline\"></ion-icon>  {{card.last4}}\r\n                </ion-select-option>\r\n              </ion-select>\r\n            </ion-item>\r\n          </div>\r\n          \r\n          <!-- Book ride button -->\r\n          <div class=\"book-button-container\">\r\n            <ion-button class=\"book-ride-btn\" shape=\"round\" color=\"primary\" size=\"large\" \r\n                      expand=\"block\" (click)=\"StartRide()\">\r\n              <ion-icon *ngIf='price' slot=\"start\" name=\"checkmark-sharp\"></ion-icon>\r\n              <ion-progress-bar color=\"light\" *ngIf='!price' type=\"indeterminate\"></ion-progress-bar>\r\n              <ion-label *ngIf='price'>Book Ride</ion-label>\r\n            </ion-button>\r\n          </div>\r\n        </div>\r\n      </ion-list>\r\n\r\n\r\n<!-- Connecting to driver bar-->\r\n      <ion-list class='bottomItems shadow-top' *ngIf=\"searchingStage\" lines=\"none\">\r\n         <ion-list-header>\r\n          <ion-item>\r\n            <ion-avatar slot=\"start\">\r\n              <ion-img [src]=\"currentDriver.Driver_imgUrl\"></ion-img>\r\n            </ion-avatar>\r\n            <ion-label>\r\n\r\n              <h1>{{currentDriver.Driver_name}}</h1>\r\n              <p>Arrives In {{duration}}</p>\r\n\r\n            </ion-label>\r\n          </ion-item>\r\n            \r\n         </ion-list-header>\r\n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\r\n\r\n                <ion-button  fill=\"outline\" shape=\"round\" color=\"danger\"  class='main-button' size=\"small\" type=\"submit\" expand=\"block\" (click)=\"presentCancelRideActionSheet()\">\r\n                  <ion-label></ion-label>\r\n                  <ion-icon slot=\"start\" slot=\"icon-only\" name=\"close-sharp\" color=\"danger\"></ion-icon>\r\n                </ion-button>\r\n                 \r\n                <ion-progress-bar color=\"primary\" class=\"ion-padding\" type=\"indeterminate\"></ion-progress-bar>\r\n\r\n             \r\n        </ion-item-group>\r\n       \r\n      </ion-list>\r\n\r\n\r\n\r\n       <!--Driver tracking to user bar (FIXED LAYOUT)-->\r\n       <ion-list class='bottomItems shadow-top' *ngIf=\"trackingStage\" lines=\"none\">\r\n         <div class=\"card\">\r\n           <!-- Car information row -->\r\n           <ion-item lines=\"none\" class=\"driver-card-item\">\r\n             <ion-label>\r\n               <p>{{driverInfo.Driver_car}}.{{driverInfo.Driver_cartype}}</p>\r\n               <h1>{{driverInfo.Driver_plate}}</h1>\r\n             </ion-label>\r\n             \r\n             <!-- Driver avatar and rating on right side -->\r\n             <div slot=\"end\" class=\"driver-avatar-container\">\r\n               <ion-avatar>\r\n                 <ion-img [src]=\"driverInfo.Driver_imgUrl\"></ion-img>\r\n               </ion-avatar>\r\n               <div class=\"driver-rating\">\r\n                 <ion-icon color=\"warning\" name=\"star\"></ion-icon>\r\n                 <span>{{driverInfo.Driver_rating}}</span>\r\n               </div>\r\n             </div>\r\n           </ion-item>\r\n\r\n           <!-- Driver name row -->\r\n           <ion-item lines=\"none\" class=\"driver-card-item\">\r\n             <ion-label>\r\n               <ion-text color=\"primary\">{{driverInfo.Driver_name}}</ion-text>\r\n               <p>1,832 rides</p>\r\n             </ion-label>\r\n           </ion-item>\r\n\r\n           <!-- Payment row -->\r\n           <ion-item lines=\"none\" class=\"driver-card-item\">\r\n             <ion-label *ngIf=\"cash\">\r\n               <h2><ion-icon color='primary' name=\"cash\"></ion-icon> Cash</h2>\r\n             </ion-label>\r\n             <ion-label *ngIf=\"!cash\">\r\n               <h2><ion-icon color='primary' name=\"card\"></ion-icon> Card</h2>\r\n             </ion-label>\r\n             \r\n             <div slot=\"end\" class=\"price-container\">\r\n               <h1>${{price}}</h1>\r\n             </div>\r\n           </ion-item>\r\n\r\n           <!-- More options accordion (made more visible) -->\r\n           <ion-accordion-group class=\"driver-actions-accordion\">\r\n             <ion-accordion value=\"first\">\r\n               <ion-item slot=\"header\" class=\"accordion-header\">\r\n                 <ion-label><h2>More Options</h2></ion-label>\r\n               </ion-item>\r\n               <div slot=\"content\" class=\"accordion-content\">\r\n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"CallDriver()\">\r\n                   <ion-icon color='primary' slot=\"start\" name=\"person\"></ion-icon>\r\n                   <ion-label>Contact</ion-label>\r\n                 </ion-button>\r\n                 \r\n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"EnterChat()\">\r\n                   <ion-icon color='primary' slot=\"start\" name=\"chatbubbles\"></ion-icon>\r\n                   <ion-label>Chat</ion-label>\r\n                 </ion-button>\r\n                 \r\n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"presentCancelRideActionSheet()\">\r\n                   <ion-icon color='primary' slot=\"start\" name=\"close\"></ion-icon>\r\n                   <ion-label>Cancel ride</ion-label>\r\n                 </ion-button>\r\n               </div>\r\n             </ion-accordion>\r\n           </ion-accordion-group>\r\n         </div>\r\n       </ion-list>\r\n\r\n\r\n\r\n    \r\n   <!--Rider Picked Up now tracking to destination bar (FIXED LAYOUT)-->\r\n      <ion-list class='bottomItems shadow-top' *ngIf=\"drivingToDestinationStage\" lines=\"none\">\r\n        <div class=\"card\">\r\n          <!-- Car information row -->\r\n          <ion-item lines=\"none\" class=\"driver-card-item\">\r\n            <ion-label>\r\n              <p>{{driverInfo.Driver_car}}.{{driverInfo.Driver_cartype}}</p>\r\n              <h1>{{driverInfo.Driver_plate}}</h1>\r\n            </ion-label>\r\n            \r\n            <!-- Driver avatar and rating on right side -->\r\n            <div slot=\"end\" class=\"driver-avatar-container\">\r\n              <ion-avatar>\r\n                <ion-img [src]=\"driverInfo.Driver_imgUrl\"></ion-img>\r\n              </ion-avatar>\r\n              <div class=\"driver-rating\">\r\n                <ion-icon color=\"secondary\" name=\"star\"></ion-icon>\r\n                <span>{{driverInfo.Driver_rating || 5}}</span>\r\n              </div>\r\n            </div>\r\n          </ion-item>\r\n\r\n          <!-- Driver name row -->\r\n          <ion-item lines=\"none\" class=\"driver-card-item\">\r\n            <ion-label>\r\n              <ion-text color=\"primary\">{{driverInfo.Driver_name}}</ion-text>\r\n              <p>1,832 rides</p>\r\n            </ion-label>\r\n          </ion-item>\r\n\r\n          <!-- Payment row -->\r\n          <ion-item lines=\"none\" class=\"driver-card-item\">\r\n            <ion-label *ngIf=\"cash\">\r\n              <h2><ion-icon color='primary' name=\"cash\"></ion-icon> Cash</h2>\r\n            </ion-label>\r\n            <ion-label *ngIf=\"!cash\">\r\n              <h2><ion-icon color='primary' name=\"card\"></ion-icon> Card</h2>\r\n            </ion-label>\r\n            \r\n            <div slot=\"end\" class=\"price-container\">\r\n              <h1>${{price}}</h1>\r\n            </div>\r\n          </ion-item>\r\n\r\n          <!-- Added accordion here too for consistency -->\r\n          <ion-accordion-group class=\"driver-actions-accordion\">\r\n            <ion-accordion value=\"first\">\r\n              <ion-item slot=\"header\" class=\"accordion-header\">\r\n                <ion-label><h2>More Options</h2></ion-label>\r\n              </ion-item>\r\n              <div slot=\"content\" class=\"accordion-content\">\r\n                <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"CallDriver()\">\r\n                  <ion-icon color='primary' slot=\"start\" name=\"person\"></ion-icon>\r\n                  <ion-label>Contact</ion-label>\r\n                </ion-button>\r\n                \r\n                <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"EnterChat()\">\r\n                  <ion-icon color='primary' slot=\"start\" name=\"chatbubbles\"></ion-icon>\r\n                  <ion-label>Chat</ion-label>\r\n                </ion-button>\r\n              </div>\r\n            </ion-accordion>\r\n          </ion-accordion-group>\r\n        </div>\r\n      </ion-list>\r\n      \r\n\r\n\r\n    </ion-row>\r\n    </div>\r\n  </ion-footer>","import { Injectable } from '@angular/core';\r\nimport { Client } from '@googlemaps/google-maps-services-js';\r\nimport { environment } from 'src/environments/environment';\r\nimport { OverlayService } from './overlay.service';\r\nimport { Observable, of } from 'rxjs';\r\nimport { HttpParams, HttpClient } from '@angular/common/http';\r\nimport { catchError, map } from 'rxjs/operators';\r\n\r\ndeclare let google;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GeocodeService {\r\n  service = new google.maps.DistanceMatrixService();\r\n  directions = new google.maps.DirectionsService();\r\n  private readonly apiUrl = 'https://maps.googleapis.com/maps/api';\r\n\r\n  constructor(private client: Client, private overlay: OverlayService, private http: HttpClient) { }\r\n\r\n  getAddress(lat: number, lng: number): Observable<any> {\r\n    const url = `${this.apiUrl}/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('latlng', `${lat},${lng}`)\r\n      .set('key', environment.apiKey);\r\n  \r\n    return this.http.get(url, { params }).pipe(\r\n      map((response: any) => response),\r\n      catchError((error) => {\r\n        console.error('Error in reverse geocoding:', error);\r\n        this.overlay.showAlert('GeoError', error.message);\r\n        return of(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  // Convert the address to lat and lng\r\n  getLatLng(address: string): Observable<any> {\r\n    const url = `${this.apiUrl}/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('address', address)\r\n      .set('key', environment.apiKey);\r\n\r\n    return this.http.get(url, { params }).pipe(\r\n      map((response: any) => response),\r\n      catchError((error) => {\r\n        console.error('Error in geocoding:', error);\r\n        this.overlay.showAlert('GeoError', error.message);\r\n        return of(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  \r\n\r\n  // Get the distance between the origin and destination\r\n  async getDirections(from: string, to: string): Promise<any> {\r\n    try {\r\n      // You can implement the directions request here using google.maps.DirectionsService\r\n    } catch (e) {\r\n      this.overlay.showAlert('GeoError', e);\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  getDistanceMatrix(origin: any, destination: any): Observable<any> {\r\n    const distanceMatrixService = new google.maps.DistanceMatrixService();\r\n    \r\n    return new Observable(observer => {\r\n      distanceMatrixService.getDistanceMatrix({\r\n        origins: [new google.maps.LatLng(origin.lat, origin.lng)],\r\n        destinations: [new google.maps.LatLng(destination.lat, destination.lng)],\r\n        travelMode: google.maps.TravelMode.DRIVING,\r\n      }, (response, status) => {\r\n        if (status === 'OK') {\r\n          observer.next(response);\r\n        } else {\r\n          observer.error(status);\r\n        }\r\n        observer.complete();\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { GoogleMap, Marker } from '@capacitor/google-maps';\r\nimport { environment } from 'src/environments/environment';\r\nimport { GeocodeService } from './geocode.service';\r\nimport { OverlayService } from './overlay.service';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MapService {\r\n  private _map: GoogleMap | null = null;\r\n  \r\n  get newMap(): GoogleMap {\r\n    if (!this._map) {\r\n      throw new Error('Map not initialized');\r\n    }\r\n    return this._map;\r\n  }\r\n\r\n  set newMap(map: GoogleMap) {\r\n    this._map = map;\r\n  }\r\n\r\n  LatLng: { lat: any; lng: any; };\r\n  locationAddress: string = 'Loading..';\r\n  showResetLocationButton: boolean;\r\n  mapPinStage: any;\r\n  D_LatLng: { lat: any; lng: any; };\r\n  actualLocation: any;\r\n  exampleMapId: any;\r\n\r\n  constructor(private overlay: OverlayService, private geocode: GeocodeService, private http: HttpClient) {}\r\n\r\n  async createMap(ref: HTMLElement, coords: { coords: { latitude: number; longitude: number } }) {\r\n    try {\r\n      // Validate coords before using\r\n      const lat = coords?.coords?.latitude || 3.1390; // Default to Kuala Lumpur, Malaysia\r\n      const lng = coords?.coords?.longitude || 101.6869;\r\n      \r\n      // Destroy existing map if it exists\r\n      this._map = await GoogleMap.create({\r\n        id: 'my-cool-map',\r\n        element: ref,\r\n        apiKey: environment.apiKey,\r\n        config: {\r\n          center: {\r\n            lat: lat,\r\n            lng: lng\r\n          },\r\n          zoom: 15,\r\n          styles: [],\r\n          scaleControl: false,\r\n          streetViewControl: false,\r\n          rotateControl: false,\r\n          fullscreenControl: false,\r\n        },\r\n      });\r\n\r\n      this.LatLng = {\r\n        lat: lat,\r\n        lng: lng\r\n      };\r\n\r\n      await Promise.all([\r\n        this._map.enableTrafficLayer(true),\r\n        this._map.enableCurrentLocation(true),\r\n        this._map.setCamera({\r\n          animate: true,\r\n          animationDuration: 500,\r\n          zoom: 15,\r\n          coordinate: this.LatLng\r\n        })\r\n      ]);\r\n\r\n      const address = await this.getAddress(this.LatLng.lat, this.LatLng.lng);\r\n      this.processAddressResponse(address);\r\n\r\n    } catch (error) {\r\n      console.error('Error creating map:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async destroyMap() {\r\n    if (this._map) {\r\n      try {\r\n        await this._map.destroy();\r\n        this._map = null;\r\n      } catch (error) {\r\n        console.error('Error destroying map:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  private processAddressResponse(address: any) {\r\n    if (address?.results?.length > 0) {\r\n      this.actualLocation = address.results[0].formatted_address;\r\n      \r\n      if (address.results.length > 1) {\r\n        const components = address.results[1].address_components;\r\n        if (components?.length >= 2) {\r\n          this.locationAddress = `${components[0].long_name} ${components[1].long_name}`;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  calculateCenter(points) {\r\n    const latitudes = points.map(p => p.geoCode.latitude);\r\n    const longitudes = points.map(p => p.geoCode.longitude);\r\n  \r\n    const avgLat = latitudes.reduce((a, b) => a + b, 0) / latitudes.length;\r\n    const avgLng = longitudes.reduce((a, b) => a + b, 0) / longitudes.length;\r\n  \r\n    return { latitude: avgLat, longitude: avgLng };\r\n  }\r\n\r\n  async setCameraToLocation(coordinate: { lat: number; lng: number }, zoom: number, bearing: number) {\r\n    if (!this._map) {\r\n      console.error('Map not initialized');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await this._map.setCamera({\r\n        animate: true,\r\n        animationDuration: 500,\r\n        zoom,\r\n        coordinate,\r\n        bearing\r\n      });\r\n    } catch (error) {\r\n      console.error('Error setting camera:', error);\r\n    }\r\n  }\r\n  \r\n  // Add other necessary methods like getAddress here\r\n\r\n  \r\n  \r\n   getBoundsZoomLevel(bounds, mapDim) {\r\n    const WORLD_DIM = { height: 256, width: 256 };\r\n      const ZOOM_MAX = 21;\r\n\r\n      const latRad = lat => {\r\n        const sin = Math.sin((lat * Math.PI) / 180);\r\n        const radX2 = Math.log((1 + sin) / (1 - sin)) / 2;\r\n        return Math.max(Math.min(radX2, Math.PI), -Math.PI) / 2;\r\n      };\r\n\r\n      const zoom = (mapPx, worldPx, fraction) =>\r\n        Math.floor(Math.log(mapPx / worldPx / fraction) / Math.LN2);\r\n\r\n      const ne = bounds.getNorthEast();\r\n      const sw = bounds.getSouthWest();\r\n\r\n      const latFraction = (latRad(ne.lat()) - latRad(sw.lat())) / Math.PI;\r\n\r\n      const lngDiff = ne.lng() - sw.lng();\r\n      const lngFraction = (lngDiff < 0 ? lngDiff + 360 : lngDiff) / 360;\r\n\r\n      const latZoom = zoom(mapDim.height, WORLD_DIM.height, latFraction);\r\n      const lngZoom = zoom(mapDim.width, WORLD_DIM.width, lngFraction);\r\n\r\n      return Math.min(latZoom, lngZoom, ZOOM_MAX);\r\n  }\r\n  \r\n  calculateBearing(start, end) {\r\n    const startLat = start.lat * (Math.PI / 180);\r\n    const startLng = start.lng * (Math.PI / 180);\r\n    const endLat = end.lat * (Math.PI / 180);\r\n    const endLng = end.lng * (Math.PI / 180);\r\n  \r\n    const dLng = endLng - startLng;\r\n    const y = Math.sin(dLng) * Math.cos(endLat);\r\n    const x = Math.cos(startLat) * Math.sin(endLat) - Math.sin(startLat) * Math.cos(endLat) * Math.cos(dLng);\r\n    const bearing = Math.atan2(y, x) * (180 / Math.PI);\r\n  \r\n    return (bearing + 360) % 360;\r\n  }\r\n  async getDirections(from: string, to: string): Promise<any> {\r\n    try {\r\n      const url = `https://maps.googleapis.com/maps/api/directions/json?origin=${from}&destination=${to}&key=${environment.apiKey}`;\r\n      const response = await this.http.get(url).toPromise();\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Error in getting directions:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n getAddress(lat: number, lng: number): Promise<any> {\r\n    const url = `https://maps.googleapis.com/maps/api/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('latlng', `${lat},${lng}`)\r\n      .set('key', environment.apiKey);\r\n\r\n    return this.http.get(url, { params }).toPromise();\r\n  }\r\n\r\n  // Add the addMarker method to the MapService class\r\n  async addMarker(lat: number, lng: number, title: string): Promise<Marker> {\r\n    try {\r\n      const marker: Marker = {\r\n        coordinate: { lat, lng },\r\n        title,\r\n      };\r\n      await this._map.addMarker(marker);\r\n      return marker;\r\n    } catch (error) {\r\n      console.error('Error adding marker:', error);\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","// src/app/services/network.service.ts\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { Network } from '@capacitor/network';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NetworkService {\r\n  private networkStatus = new BehaviorSubject<boolean>(true);\r\n  networkStatus$ = this.networkStatus.asObservable();\r\n\r\n  constructor() {\r\n    this.initializeNetworkListener();\r\n  }\r\n\r\n  private initializeNetworkListener() {\r\n    try {\r\n      Network.addListener('networkStatusChange', status => {\r\n        console.log('Network status changed', status);\r\n        this.networkStatus.next(status.connected);\r\n\r\n        if (status.connected) {\r\n          this.handleReconnect();\r\n        } else {\r\n          this.handleDisconnect();\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to add network listener:', error);\r\n    }\r\n\r\n    this.checkInitialNetworkStatus();\r\n  }\r\n\r\n  private async checkInitialNetworkStatus() {\r\n    try {\r\n      const status = await Network.getStatus();\r\n      console.log('Initial network status:', status);\r\n      this.networkStatus.next(status.connected);\r\n      if (!status.connected) {\r\n        this.handleDisconnect();\r\n      }\r\n    } catch (error) {\r\n      console.warn('Network status check failed, performing fallback check:', error);\r\n      // Fallback: try to make a simple network request with timeout\r\n      try {\r\n        const controller = new AbortController();\r\n        const timeoutId = setTimeout(() => controller.abort(), 5000); // 5 second timeout\r\n        \r\n        await fetch('https://www.google.com/favicon.ico', { \r\n          method: 'HEAD',\r\n          mode: 'no-cors',\r\n          cache: 'no-cache',\r\n          signal: controller.signal\r\n        });\r\n        \r\n        clearTimeout(timeoutId);\r\n        this.networkStatus.next(true);\r\n        console.log('Fallback network check: connected');\r\n      } catch (fetchError) {\r\n        console.warn('Fallback network check failed:', fetchError);\r\n        // Be more conservative - assume connected if we can't determine\r\n        this.networkStatus.next(true);\r\n        console.log('Network status uncertain, assuming connected');\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleDisconnect() {\r\n    console.log('Disconnected from network');\r\n    // Handle the UI or logic when the network is disconnected\r\n  }\r\n\r\n  private handleReconnect() {\r\n    console.log('Reconnected to network');\r\n    // Handle the UI or logic when the network is reconnected\r\n  }\r\n\r\n  isConnected(): boolean {\r\n    return this.networkStatus.value;\r\n  }\r\n}\r\n","/// <reference types=\"@capacitor/cli\" />\nexport {};\n","import { registerPlugin } from '@capacitor/core';\nconst App = registerPlugin('App', {\n    web: () => import('./web').then(m => new m.AppWeb()),\n});\nexport * from './definitions';\nexport { App };\n","export {};\n","import { registerPlugin } from '@capacitor/core';\nconst Geolocation = registerPlugin('Geolocation', {\n    web: () => import('./web').then(m => new m.GeolocationWeb()),\n});\nexport * from './definitions';\nexport { Geolocation };\n","import { CapacitorGoogleMaps } from './implementation';\nexport class LatLngBounds {\n    constructor(bounds) {\n        this.southwest = bounds.southwest;\n        this.center = bounds.center;\n        this.northeast = bounds.northeast;\n    }\n    async contains(point) {\n        const result = await CapacitorGoogleMaps.mapBoundsContains({\n            bounds: this,\n            point,\n        });\n        return result['contains'];\n    }\n    async extend(point) {\n        const result = await CapacitorGoogleMaps.mapBoundsExtend({\n            bounds: this,\n            point,\n        });\n        this.southwest = result['bounds']['southwest'];\n        this.center = result['bounds']['center'];\n        this.northeast = result['bounds']['northeast'];\n        return this;\n    }\n}\nexport var MapType;\n(function (MapType) {\n    /**\n     * Basic map.\n     */\n    MapType[\"Normal\"] = \"Normal\";\n    /**\n     * Satellite imagery with roads and labels.\n     */\n    MapType[\"Hybrid\"] = \"Hybrid\";\n    /**\n     * Satellite imagery with no labels.\n     */\n    MapType[\"Satellite\"] = \"Satellite\";\n    /**\n     * Topographic data.\n     */\n    MapType[\"Terrain\"] = \"Terrain\";\n    /**\n     * No base map tiles.\n     */\n    MapType[\"None\"] = \"None\";\n})(MapType || (MapType = {}));\n","import { registerPlugin } from '@capacitor/core';\nconst CapacitorGoogleMaps = registerPlugin('CapacitorGoogleMaps', {\n    web: () => import('./web').then((m) => new m.CapacitorGoogleMapsWeb()),\n});\nCapacitorGoogleMaps.addListener('isMapInFocus', (data) => {\n    var _a;\n    const x = data.x;\n    const y = data.y;\n    const elem = document.elementFromPoint(x, y);\n    const internalId = (_a = elem === null || elem === void 0 ? void 0 : elem.dataset) === null || _a === void 0 ? void 0 : _a.internalId;\n    const mapInFocus = internalId === data.mapId;\n    CapacitorGoogleMaps.dispatchMapEvent({ id: data.mapId, focus: mapInFocus });\n});\nexport { CapacitorGoogleMaps };\n","/* eslint-disable @typescript-eslint/no-namespace */\nimport { LatLngBounds, MapType } from './definitions';\nimport { GoogleMap } from './map';\nexport { GoogleMap, LatLngBounds, MapType };\n","import { Capacitor } from '@capacitor/core';\nimport { LatLngBounds, MapType } from './definitions';\nimport { CapacitorGoogleMaps } from './implementation';\nclass MapCustomElement extends HTMLElement {\n    constructor() {\n        super();\n    }\n    connectedCallback() {\n        this.innerHTML = '';\n        if (Capacitor.getPlatform() == 'ios') {\n            this.style.overflow = 'scroll';\n            this.style['-webkit-overflow-scrolling'] = 'touch';\n            const overflowDiv = document.createElement('div');\n            overflowDiv.style.height = '200%';\n            this.appendChild(overflowDiv);\n        }\n    }\n}\ncustomElements.define('capacitor-google-map', MapCustomElement);\nexport class GoogleMap {\n    constructor(id) {\n        this.element = null;\n        this.resizeObserver = null;\n        this.handleScrollEvent = () => this.updateMapBounds();\n        this.id = id;\n    }\n    /**\n     * Creates a new instance of a Google Map\n     * @param options\n     * @param callback\n     * @returns GoogleMap\n     */\n    static async create(options, callback) {\n        const newMap = new GoogleMap(options.id);\n        if (!options.element) {\n            throw new Error('container element is required');\n        }\n        if (options.config.androidLiteMode === undefined) {\n            options.config.androidLiteMode = false;\n        }\n        newMap.element = options.element;\n        newMap.element.dataset.internalId = options.id;\n        const elementBounds = await GoogleMap.getElementBounds(options.element);\n        options.config.width = elementBounds.width;\n        options.config.height = elementBounds.height;\n        options.config.x = elementBounds.x;\n        options.config.y = elementBounds.y;\n        options.config.devicePixelRatio = window.devicePixelRatio;\n        if (Capacitor.getPlatform() == 'android') {\n            newMap.initScrolling();\n        }\n        if (Capacitor.isNativePlatform()) {\n            options.element = {};\n            const getMapBounds = () => {\n                var _a, _b;\n                const mapRect = (_b = (_a = newMap.element) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) !== null && _b !== void 0 ? _b : {};\n                return {\n                    x: mapRect.x,\n                    y: mapRect.y,\n                    width: mapRect.width,\n                    height: mapRect.height,\n                };\n            };\n            const onDisplay = () => {\n                CapacitorGoogleMaps.onDisplay({\n                    id: newMap.id,\n                    mapBounds: getMapBounds(),\n                });\n            };\n            const onResize = () => {\n                CapacitorGoogleMaps.onResize({\n                    id: newMap.id,\n                    mapBounds: getMapBounds(),\n                });\n            };\n            const ionicPage = newMap.element.closest('.ion-page');\n            if (Capacitor.getPlatform() === 'ios' && ionicPage) {\n                ionicPage.addEventListener('ionViewWillEnter', () => {\n                    setTimeout(() => {\n                        onDisplay();\n                    }, 100);\n                });\n                ionicPage.addEventListener('ionViewDidEnter', () => {\n                    setTimeout(() => {\n                        onDisplay();\n                    }, 100);\n                });\n            }\n            const lastState = {\n                width: elementBounds.width,\n                height: elementBounds.height,\n                isHidden: false,\n            };\n            newMap.resizeObserver = new ResizeObserver(() => {\n                if (newMap.element != null) {\n                    const mapRect = newMap.element.getBoundingClientRect();\n                    const isHidden = mapRect.width === 0 && mapRect.height === 0;\n                    if (!isHidden) {\n                        if (lastState.isHidden) {\n                            if (Capacitor.getPlatform() === 'ios' && !ionicPage) {\n                                onDisplay();\n                            }\n                        }\n                        else if (lastState.width !== mapRect.width || lastState.height !== mapRect.height) {\n                            onResize();\n                        }\n                    }\n                    lastState.width = mapRect.width;\n                    lastState.height = mapRect.height;\n                    lastState.isHidden = isHidden;\n                }\n            });\n            newMap.resizeObserver.observe(newMap.element);\n        }\n        // small delay to allow for iOS WKWebView to setup corresponding element sub-scroll views ???\n        await new Promise((resolve, reject) => {\n            setTimeout(async () => {\n                try {\n                    await CapacitorGoogleMaps.create(options);\n                    resolve(undefined);\n                }\n                catch (err) {\n                    reject(err);\n                }\n            }, 200);\n        });\n        if (callback) {\n            const onMapReadyListener = await CapacitorGoogleMaps.addListener('onMapReady', (data) => {\n                if (data.mapId == newMap.id) {\n                    callback(data);\n                    onMapReadyListener.remove();\n                }\n            });\n        }\n        return newMap;\n    }\n    static async getElementBounds(element) {\n        return new Promise((resolve) => {\n            let elementBounds = element.getBoundingClientRect();\n            if (elementBounds.width == 0) {\n                let retries = 0;\n                const boundsInterval = setInterval(function () {\n                    if (elementBounds.width == 0 && retries < 30) {\n                        elementBounds = element.getBoundingClientRect();\n                        retries++;\n                    }\n                    else {\n                        if (retries == 30) {\n                            console.warn('Map size could not be determined');\n                        }\n                        clearInterval(boundsInterval);\n                        resolve(elementBounds);\n                    }\n                }, 100);\n            }\n            else {\n                resolve(elementBounds);\n            }\n        });\n    }\n    /**\n     * Enable touch events on native map\n     *\n     * @returns void\n     */\n    async enableTouch() {\n        return CapacitorGoogleMaps.enableTouch({\n            id: this.id,\n        });\n    }\n    /**\n     * Disable touch events on native map\n     *\n     * @returns void\n     */\n    async disableTouch() {\n        return CapacitorGoogleMaps.disableTouch({\n            id: this.id,\n        });\n    }\n    /**\n     * Enable marker clustering\n     *\n     * @param minClusterSize - The minimum number of markers that can be clustered together.\n     * @defaultValue 4\n     *\n     * @returns void\n     */\n    async enableClustering(minClusterSize) {\n        return CapacitorGoogleMaps.enableClustering({\n            id: this.id,\n            minClusterSize,\n        });\n    }\n    /**\n     * Disable marker clustering\n     *\n     * @returns void\n     */\n    async disableClustering() {\n        return CapacitorGoogleMaps.disableClustering({\n            id: this.id,\n        });\n    }\n    /**\n     * Adds a tile overlay to the map\n     *\n     * @param tileOverlay\n     * @returns created tile overlay id\n     */\n    async addTileOverlay(tileOverlay) {\n        const res = await CapacitorGoogleMaps.addTileOverlay({\n            id: this.id,\n            tileOverlay,\n        });\n        return res.id;\n    }\n    /**\n     * Removes a tile overlay from the map\n     *\n     * @param id of the tile overlay to remove from the map\n     * @returns void\n     */\n    async removeTileOverlay(id) {\n        return CapacitorGoogleMaps.removeTileOverlay({\n            id: this.id,\n            tileOverlayId: id,\n        });\n    }\n    /**\n     * Adds a marker to the map\n     *\n     * @param marker\n     * @returns created marker id\n     */\n    async addMarker(marker) {\n        const res = await CapacitorGoogleMaps.addMarker({\n            id: this.id,\n            marker,\n        });\n        return res.id;\n    }\n    /**\n     * Adds multiple markers to the map\n     *\n     * @param markers\n     * @returns array of created marker IDs\n     */\n    async addMarkers(markers) {\n        const res = await CapacitorGoogleMaps.addMarkers({\n            id: this.id,\n            markers,\n        });\n        return res.ids;\n    }\n    /**\n     * Remove marker from the map\n     *\n     * @param id id of the marker to remove from the map\n     * @returns\n     */\n    async removeMarker(id) {\n        return CapacitorGoogleMaps.removeMarker({\n            id: this.id,\n            markerId: id,\n        });\n    }\n    /**\n     * Remove markers from the map\n     *\n     * @param ids array of ids to remove from the map\n     * @returns\n     */\n    async removeMarkers(ids) {\n        return CapacitorGoogleMaps.removeMarkers({\n            id: this.id,\n            markerIds: ids,\n        });\n    }\n    async addPolygons(polygons) {\n        const res = await CapacitorGoogleMaps.addPolygons({\n            id: this.id,\n            polygons,\n        });\n        return res.ids;\n    }\n    async addPolylines(polylines) {\n        const res = await CapacitorGoogleMaps.addPolylines({\n            id: this.id,\n            polylines,\n        });\n        return res.ids;\n    }\n    async removePolygons(ids) {\n        return CapacitorGoogleMaps.removePolygons({\n            id: this.id,\n            polygonIds: ids,\n        });\n    }\n    async addCircles(circles) {\n        const res = await CapacitorGoogleMaps.addCircles({\n            id: this.id,\n            circles,\n        });\n        return res.ids;\n    }\n    async removeCircles(ids) {\n        return CapacitorGoogleMaps.removeCircles({\n            id: this.id,\n            circleIds: ids,\n        });\n    }\n    async removePolylines(ids) {\n        return CapacitorGoogleMaps.removePolylines({\n            id: this.id,\n            polylineIds: ids,\n        });\n    }\n    /**\n     * Destroy the current instance of the map\n     */\n    async destroy() {\n        var _a;\n        if (Capacitor.getPlatform() == 'android') {\n            this.disableScrolling();\n        }\n        if (Capacitor.isNativePlatform()) {\n            (_a = this.resizeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        }\n        this.removeAllMapListeners();\n        return CapacitorGoogleMaps.destroy({\n            id: this.id,\n        });\n    }\n    /**\n     * Update the map camera configuration\n     *\n     * @param config\n     * @returns\n     */\n    async setCamera(config) {\n        return CapacitorGoogleMaps.setCamera({\n            id: this.id,\n            config,\n        });\n    }\n    async getMapType() {\n        const { type } = await CapacitorGoogleMaps.getMapType({ id: this.id });\n        return MapType[type];\n    }\n    /**\n     * Sets the type of map tiles that should be displayed.\n     *\n     * @param mapType\n     * @returns\n     */\n    async setMapType(mapType) {\n        return CapacitorGoogleMaps.setMapType({\n            id: this.id,\n            mapType,\n        });\n    }\n    /**\n     * Sets whether indoor maps are shown, where available.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableIndoorMaps(enabled) {\n        return CapacitorGoogleMaps.enableIndoorMaps({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Controls whether the map is drawing traffic data, if available.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableTrafficLayer(enabled) {\n        return CapacitorGoogleMaps.enableTrafficLayer({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Show accessibility elements for overlay objects, such as Marker and Polyline.\n     *\n     * Only available on iOS.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableAccessibilityElements(enabled) {\n        return CapacitorGoogleMaps.enableAccessibilityElements({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Set whether the My Location dot and accuracy circle is enabled.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableCurrentLocation(enabled) {\n        return CapacitorGoogleMaps.enableCurrentLocation({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Set padding on the 'visible' region of the view.\n     *\n     * @param padding\n     * @returns\n     */\n    async setPadding(padding) {\n        return CapacitorGoogleMaps.setPadding({\n            id: this.id,\n            padding,\n        });\n    }\n    /**\n     * Get the map's current viewport latitude and longitude bounds.\n     *\n     * @returns {LatLngBounds}\n     */\n    async getMapBounds() {\n        return new LatLngBounds(await CapacitorGoogleMaps.getMapBounds({\n            id: this.id,\n        }));\n    }\n    async fitBounds(bounds, padding) {\n        return CapacitorGoogleMaps.fitBounds({\n            id: this.id,\n            bounds,\n            padding,\n        });\n    }\n    initScrolling() {\n        const ionContents = document.getElementsByTagName('ion-content');\n        // eslint-disable-next-line @typescript-eslint/prefer-for-of\n        for (let i = 0; i < ionContents.length; i++) {\n            ionContents[i].scrollEvents = true;\n        }\n        window.addEventListener('ionScroll', this.handleScrollEvent);\n        window.addEventListener('scroll', this.handleScrollEvent);\n        window.addEventListener('resize', this.handleScrollEvent);\n        if (screen.orientation) {\n            screen.orientation.addEventListener('change', () => {\n                setTimeout(this.updateMapBounds, 500);\n            });\n        }\n        else {\n            window.addEventListener('orientationchange', () => {\n                setTimeout(this.updateMapBounds, 500);\n            });\n        }\n    }\n    disableScrolling() {\n        window.removeEventListener('ionScroll', this.handleScrollEvent);\n        window.removeEventListener('scroll', this.handleScrollEvent);\n        window.removeEventListener('resize', this.handleScrollEvent);\n        if (screen.orientation) {\n            screen.orientation.removeEventListener('change', () => {\n                setTimeout(this.updateMapBounds, 1000);\n            });\n        }\n        else {\n            window.removeEventListener('orientationchange', () => {\n                setTimeout(this.updateMapBounds, 1000);\n            });\n        }\n    }\n    updateMapBounds() {\n        if (this.element) {\n            const mapRect = this.element.getBoundingClientRect();\n            CapacitorGoogleMaps.onScroll({\n                id: this.id,\n                mapBounds: {\n                    x: mapRect.x,\n                    y: mapRect.y,\n                    width: mapRect.width,\n                    height: mapRect.height,\n                },\n            });\n        }\n    }\n    /*\n    private findContainerElement(): HTMLElement | null {\n      if (!this.element) {\n        return null;\n      }\n  \n      let parentElement = this.element.parentElement;\n      while (parentElement !== null) {\n        if (window.getComputedStyle(parentElement).overflowY !== 'hidden') {\n          return parentElement;\n        }\n  \n        parentElement = parentElement.parentElement;\n      }\n  \n      return null;\n    }\n    */\n    /**\n     * Set the event listener on the map for 'onCameraIdle' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCameraIdleListener(callback) {\n        if (this.onCameraIdleListener) {\n            this.onCameraIdleListener.remove();\n        }\n        if (callback) {\n            this.onCameraIdleListener = await CapacitorGoogleMaps.addListener('onCameraIdle', this.generateCallback(callback));\n        }\n        else {\n            this.onCameraIdleListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onBoundsChanged' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnBoundsChangedListener(callback) {\n        if (this.onBoundsChangedListener) {\n            this.onBoundsChangedListener.remove();\n        }\n        if (callback) {\n            this.onBoundsChangedListener = await CapacitorGoogleMaps.addListener('onBoundsChanged', this.generateCallback(callback));\n        }\n        else {\n            this.onBoundsChangedListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onCameraMoveStarted' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCameraMoveStartedListener(callback) {\n        if (this.onCameraMoveStartedListener) {\n            this.onCameraMoveStartedListener.remove();\n        }\n        if (callback) {\n            this.onCameraMoveStartedListener = await CapacitorGoogleMaps.addListener('onCameraMoveStarted', this.generateCallback(callback));\n        }\n        else {\n            this.onCameraMoveStartedListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onClusterClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnClusterClickListener(callback) {\n        if (this.onClusterClickListener) {\n            this.onClusterClickListener.remove();\n        }\n        if (callback) {\n            this.onClusterClickListener = await CapacitorGoogleMaps.addListener('onClusterClick', this.generateCallback(callback));\n        }\n        else {\n            this.onClusterClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onClusterInfoWindowClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnClusterInfoWindowClickListener(callback) {\n        if (this.onClusterInfoWindowClickListener) {\n            this.onClusterInfoWindowClickListener.remove();\n        }\n        if (callback) {\n            this.onClusterInfoWindowClickListener = await CapacitorGoogleMaps.addListener('onClusterInfoWindowClick', this.generateCallback(callback));\n        }\n        else {\n            this.onClusterInfoWindowClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onInfoWindowClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnInfoWindowClickListener(callback) {\n        if (this.onInfoWindowClickListener) {\n            this.onInfoWindowClickListener.remove();\n        }\n        if (callback) {\n            this.onInfoWindowClickListener = await CapacitorGoogleMaps.addListener('onInfoWindowClick', this.generateCallback(callback));\n        }\n        else {\n            this.onInfoWindowClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMapClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMapClickListener(callback) {\n        if (this.onMapClickListener) {\n            this.onMapClickListener.remove();\n        }\n        if (callback) {\n            this.onMapClickListener = await CapacitorGoogleMaps.addListener('onMapClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMapClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onPolygonClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnPolygonClickListener(callback) {\n        if (this.onPolygonClickListener) {\n            this.onPolygonClickListener.remove();\n        }\n        if (callback) {\n            this.onPolygonClickListener = await CapacitorGoogleMaps.addListener('onPolygonClick', this.generateCallback(callback));\n        }\n        else {\n            this.onPolygonClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onCircleClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCircleClickListener(callback) {\n        if (this.onCircleClickListener)\n            [this.onCircleClickListener.remove()];\n        if (callback) {\n            this.onCircleClickListener = await CapacitorGoogleMaps.addListener('onCircleClick', this.generateCallback(callback));\n        }\n        else {\n            this.onCircleClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerClickListener(callback) {\n        if (this.onMarkerClickListener) {\n            this.onMarkerClickListener.remove();\n        }\n        if (callback) {\n            this.onMarkerClickListener = await CapacitorGoogleMaps.addListener('onMarkerClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onPolylineClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnPolylineClickListener(callback) {\n        if (this.onPolylineClickListener) {\n            this.onPolylineClickListener.remove();\n        }\n        if (callback) {\n            this.onPolylineClickListener = await CapacitorGoogleMaps.addListener('onPolylineClick', this.generateCallback(callback));\n        }\n        else {\n            this.onPolylineClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDragStart' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragStartListener(callback) {\n        if (this.onMarkerDragStartListener) {\n            this.onMarkerDragStartListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragStartListener = await CapacitorGoogleMaps.addListener('onMarkerDragStart', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragStartListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDrag' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragListener(callback) {\n        if (this.onMarkerDragListener) {\n            this.onMarkerDragListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragListener = await CapacitorGoogleMaps.addListener('onMarkerDrag', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDragEnd' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragEndListener(callback) {\n        if (this.onMarkerDragEndListener) {\n            this.onMarkerDragEndListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragEndListener = await CapacitorGoogleMaps.addListener('onMarkerDragEnd', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragEndListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMyLocationButtonClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMyLocationButtonClickListener(callback) {\n        if (this.onMyLocationButtonClickListener) {\n            this.onMyLocationButtonClickListener.remove();\n        }\n        if (callback) {\n            this.onMyLocationButtonClickListener = await CapacitorGoogleMaps.addListener('onMyLocationButtonClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMyLocationButtonClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMyLocationClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMyLocationClickListener(callback) {\n        if (this.onMyLocationClickListener) {\n            this.onMyLocationClickListener.remove();\n        }\n        if (callback) {\n            this.onMyLocationClickListener = await CapacitorGoogleMaps.addListener('onMyLocationClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMyLocationClickListener = undefined;\n        }\n    }\n    /**\n     * Remove all event listeners on the map.\n     *\n     * @param callback\n     * @returns\n     */\n    async removeAllMapListeners() {\n        if (this.onBoundsChangedListener) {\n            this.onBoundsChangedListener.remove();\n            this.onBoundsChangedListener = undefined;\n        }\n        if (this.onCameraIdleListener) {\n            this.onCameraIdleListener.remove();\n            this.onCameraIdleListener = undefined;\n        }\n        if (this.onCameraMoveStartedListener) {\n            this.onCameraMoveStartedListener.remove();\n            this.onCameraMoveStartedListener = undefined;\n        }\n        if (this.onClusterClickListener) {\n            this.onClusterClickListener.remove();\n            this.onClusterClickListener = undefined;\n        }\n        if (this.onClusterInfoWindowClickListener) {\n            this.onClusterInfoWindowClickListener.remove();\n            this.onClusterInfoWindowClickListener = undefined;\n        }\n        if (this.onInfoWindowClickListener) {\n            this.onInfoWindowClickListener.remove();\n            this.onInfoWindowClickListener = undefined;\n        }\n        if (this.onMapClickListener) {\n            this.onMapClickListener.remove();\n            this.onMapClickListener = undefined;\n        }\n        if (this.onPolylineClickListener) {\n            this.onPolylineClickListener.remove();\n            this.onPolylineClickListener = undefined;\n        }\n        if (this.onMarkerClickListener) {\n            this.onMarkerClickListener.remove();\n            this.onMarkerClickListener = undefined;\n        }\n        if (this.onPolygonClickListener) {\n            this.onPolygonClickListener.remove();\n            this.onPolygonClickListener = undefined;\n        }\n        if (this.onCircleClickListener) {\n            this.onCircleClickListener.remove();\n            this.onCircleClickListener = undefined;\n        }\n        if (this.onMarkerDragStartListener) {\n            this.onMarkerDragStartListener.remove();\n            this.onMarkerDragStartListener = undefined;\n        }\n        if (this.onMarkerDragListener) {\n            this.onMarkerDragListener.remove();\n            this.onMarkerDragListener = undefined;\n        }\n        if (this.onMarkerDragEndListener) {\n            this.onMarkerDragEndListener.remove();\n            this.onMarkerDragEndListener = undefined;\n        }\n        if (this.onMyLocationButtonClickListener) {\n            this.onMyLocationButtonClickListener.remove();\n            this.onMyLocationButtonClickListener = undefined;\n        }\n        if (this.onMyLocationClickListener) {\n            this.onMyLocationClickListener.remove();\n            this.onMyLocationClickListener = undefined;\n        }\n    }\n    generateCallback(callback) {\n        const mapId = this.id;\n        return (data) => {\n            if (data.mapId == mapId) {\n                callback(data);\n            }\n        };\n    }\n}\n","import { asyncScheduler } from '../scheduler/async';\nimport { timer } from './timer';\nexport function interval(period = 0, scheduler = asyncScheduler) {\n    if (period < 0) {\n        period = 0;\n    }\n    return timer(period, period, scheduler);\n}\n"],"names":["ElementRef","NgZone","Geolocation","AutocompleteComponent","Observable","interval","BehaviorSubject","Subscription","updateDoc","getDoc","collection","onSnapshot","doc","Firestore","query","where","EnrouteChatComponent","Network","App","AddCardComponent","switchMap","Preferences","onAuthStateChanged","TripSummaryComponent","i0","ctx_r33","HomePage","constructor","auth","authService","router","networkService","map","nav","platform","firestore","database","ngZone","geocode","overlay","modalCtrl","alert","payME","toastController","actionSheetController","BOOKING","CONFIRM","TRACKING","SEARCHING","DRIVING","NO_DRIVER","MAP_PIN","NO_DRIVERS","initializeApp","ngOnDestroy","unsubscribe","window","removeEventListener","setMapHeight","bind","clearSubscriptions","clearPrevMarkers","clearAllPolylines","ngAfterViewInit","hasPermission","checkAndRequestLocationPermissions","initializeProfile","initializeNetworkMonitoring","fetchSavedPaymentMethods","loadPresets","EnterBookingStage","initializeGeolocation","initializeMap","initializeRideStateListener","e","console","error","hideLoader","showAlert","raw","localStorage","getItem","presets","JSON","parse","name","address","lat","lng","setItem","stringify","savePresets","addCurrentAsPreset","destinationAddress","D_LatLng","create","header","message","buttons","present","unshift","length","deletePreset","i","splice","selectPreset","preset","getDistanceAndDirections","showAutocompleteModal","user","Promise","resolve","Error","profile","getUserProfile","log","userId","uid","email","createdAt","Date","toISOString","createUserProfile","ensureProfileInitialized","lastHandledState","requestsQuery","snapshot","empty","setStage","STAGES","activeRides","docs","currentRide","rideData","data","requestID","id","price","status","isAppInitialization","Loc_lat","Loc_lng","LatLng","Des_lat","Des_lng","locationAddress","Rider_Location","Rider_Destination","handlePendingState","handleRideConfirmation","handleRideStart","handleRideCancellation","code","handleRemovedRide","clearRideData","driverInfo","rideHasStarted","is","permissionStatus","checkPermissions","location","text","handler","newStatus","requestPermissions","showLocationRequiredAlert","backdropDismiss","role","onDidDismiss","navigator","permissions","then","result","state","showWebLocationPrompt","geolocation","getCurrentPosition","savedPaymentMethods","getSavedPaymentMethods","selectedCard","cash","cardId","chooseCard","event","detail","value","processPayment","amount","showLoader","paymentResult","processPaymentWithCardId","toPromise","errorMessage","showPaymentErrorModal","modal","component","onWillDismiss","newCardId","setMapContainerHeight","extraPadding","mapRef","topBar","bottomBar","topHeight","nativeElement","offsetHeight","bottomHeight","availableHeight","innerHeight","style","height","top","position","zIndex","left","right","setMapHeightCreateAndAddMarkers","setMapHeightHandleDrivertoRider","setMapHeightHandleDrivertoDestination","ResetMapHeight","getStatus","isConnected","connected","networkStatus$","next","addListener","subscribe","navigate","ready","coordinates","timeout","reject","coords","latitude","longitude","accuracy","altitude","altitudeAccuracy","heading","speed","timestamp","updateLocation","startPollingPosition","startPermissionPolling","permissionCheckInterval","setInterval","clearInterval","lastLatLng","lastAddress","pollingInterval","newLatLng","hasSignificantLocationChange","getAddress","results","components","address_components","long_name","actualLocation","formatted_address","stopPolling","center","radiusInM","fetchAndDisplayDrivers","err","oldLatLng","minDistance","R","1","Math","PI","2","","","a","sin","cos","c","atan2","sqrt","distance","stopPollingPosition","warn","now","createMap","mapy","initializeDatabaseSubscriptions","getKnownPlaces","d","places","slice","initializeBackButtonCustomHandler","backButton","subscribeWithPriority","canGoBack","confirm","exitApp","history","back","setupMapListeners","newMap","setOnCameraIdleListener","g","run","showResetLocationButton","mapPinStage","addressResponse","processAddressResponse","logout","drivers","checkDriversWithin","handleDrivers","drivers_Requested","current_Request_Number","UpdateCarMarker","NoDrivers","closeDrivers","forEach","driver","duration","onlineState","push","updateDriverInfo","min","cleanupListeners","Object","values","activeListeners","carname","Driver_car","driverImage","Driver_imgUrl","driver_duration_apart","ceil","driver_ID","Driver_id","driver_number_of_seats","seats","DriverLatLng","Driver_lat","Driver_lng","StartRide","isLoadingDriver","all","enableTouch","BookRide","clearMarkers","marker1","removeMarker","marker2","toString","_carmarkers","marker","hasValidDriver","showNoDriversAlert","userDocRef","docSnapshot","exists","handleNoAvailableDriver","requestRideWithDriverDetails","requestDetails","latLng","dLatLng","driverId","RequestRideWithRiderDetails","currentDriver","rideRequestDocRef","unsub","handleRideUpdates","routeUpdateSubscription","numCalls","countDown","animatedMarker","handleRideStop","ReturnHome","locationPromise","getDriverLocation","timeoutPromise","_","setTimeout","race","clearPolyline","newPoly","setCamera","animate","animationDuration","zoom","coordinate","handleDriverToRider","EnterSearchingStage","startCountdown","presentCancelRideActionSheet","actionSheet","cancelRide","reason","rideRef","cancellationReason","canceledBy","toast","stopCountdown","ClearRide","driverDetails","driverDoc","addEventListener","mapError","driverLocationFetched","driverLocation","locationError","driver_lat","driver_lng","EnterDrivingToDestinationStage","canCheck","handleRiderToDestination","visualError","isRideStopProcessed","attempt","docData","tripId","driverName","Driver_name","driverCar","driverPlate","Driver_plate","pickup","destination","rating","Driver_rating","completed","completedAt","remove","key","RIDE_STATE_KEY","componentProps","clearRideState","driver_marker","rider_marker","destinationMarker","routePolyline","routePath","bookingStage","confirmStage","trackingStage","searchingStage","noDriverStage","drivingToDestinationStage","enableCurrentLocation","docOrData","docId","requestId","EnterTrackingStage","saveRideStateToStorage","rideState","stage","getCurrentStage","set","catch","EnterChat","options","initialTime","countdownActive","timeRemaining","updateCountdown","UpdateCountDown","handleCountdownEnd","requestNextDriver","goBackToAutoComplete","ResetState","markers","clearPromises","filter","undefined","clearMarker","removePolylines","actualDestination","pinOnMap","EnterMapPinStage","mapPinDrag","home","searching","AddKnownPlace","full","whole","getLatLng","description","geometry","RequestRide","dat","place","EnterNoDriverStage","EnterConfirmStage","origin1","google","maps","origin2","request","origin","travelMode","TravelMode","directions","route","response","direction","routes","legs","bounds","getPriceEstimate","path","overview_path","latlng","createAndAddMarkers","getDistanceAndDirectionsDriver","D_duration","resetLocation","addressComponents","elements","LatLngBounds","driverMap","Map","element","updatedMarkers","get","extend","existingMarkerIndex","findIndex","mapDim","width","offsetWidth","minZoom","maxZoom","zoomLevel","getBoundsZoomLevel","max","getCenter","fitBounds","GoHome","GotoSupport","navigateForward","CancelRide","riderCleared","currentUser","riderDocRef","currentRequestId","bearing","CallDriver","driverLatLng","riderLatLng","markerSize","iconAnchor","x","y","driverMarker","addMarker","iconUrl","title","iconSize","riderMarker","photoURL","updateRoute","locs","geoCode","calculateCenter","adjustedZoomLevel","setCameraToLocation","calculateBearing","addPolyline","animateMarker","routeUpdate$","UPDATE_INTERVAL","pipe","polylineId","destinationLatLng","iconOrigin","loc","des","polylineColor","pathPoints","Array","isArray","polylines","strokeColor","strokeWeight","geodesic","addedPolylines","addPolylines","disableTouch","lastMarker","ShowDriverInfoPop","ngOnInit","navigation","getCurrentNavigation","extras","mapLoadedSubscription","mapLoadedSubject","loaded","processBookAgainData","addLocationMarker","geocodeService","geocodeAddress","addDestinationMarker","drawRoute","calculatePrice","toastCtrl","color","selectors","viewQuery","ctx","environment","of","HttpParams","catchError","GeocodeService","client","http","DistanceMatrixService","DirectionsService","url","apiUrl","params","apiKey","getDirections","from","to","getDistanceMatrix","distanceMatrixService","observer","origins","destinations","complete","factory","providedIn","GoogleMap","MapService","_map","ref","config","styles","scaleControl","streetViewControl","rotateControl","fullscreenControl","enableTrafficLayer","destroyMap","destroy","points","latitudes","p","longitudes","avgLat","reduce","b","avgLng","WORLD_DIM","ZOOM_MAX","latRad","radX2","mapPx","worldPx","fraction","floor","LN2","ne","getNorthEast","sw","getSouthWest","latFraction","lngDiff","lngFraction","latZoom","lngZoom","start","end","startLat","startLng","endLat","endLng","dLng","NetworkService","networkStatus","asObservable","initializeNetworkListener","handleReconnect","handleDisconnect","checkInitialNetworkStatus","controller","AbortController","timeoutId","abort","fetch","method","mode","cache","signal","clearTimeout","fetchError","registerPlugin","web","m","AppWeb","GeolocationWeb","CapacitorGoogleMaps","southwest","northeast","contains","point","mapBoundsContains","mapBoundsExtend","MapType","CapacitorGoogleMapsWeb","_a","elem","document","elementFromPoint","internalId","dataset","mapInFocus","mapId","dispatchMapEvent","focus","Capacitor","MapCustomElement","HTMLElement","connectedCallback","innerHTML","getPlatform","overflow","overflowDiv","createElement","appendChild","customElements","define","resizeObserver","handleScrollEvent","updateMapBounds","callback","androidLiteMode","elementBounds","getElementBounds","devicePixelRatio","initScrolling","isNativePlatform","getMapBounds","_b","mapRect","getBoundingClientRect","onDisplay","mapBounds","onResize","ionicPage","closest","lastState","isHidden","ResizeObserver","observe","onMapReadyListener","retries","boundsInterval","enableClustering","minClusterSize","disableClustering","addTileOverlay","tileOverlay","res","removeTileOverlay","tileOverlayId","addMarkers","ids","markerId","removeMarkers","markerIds","addPolygons","polygons","removePolygons","polygonIds","addCircles","circles","removeCircles","circleIds","polylineIds","disableScrolling","disconnect","removeAllMapListeners","getMapType","type","setMapType","mapType","enableIndoorMaps","enabled","enableAccessibilityElements","setPadding","padding","ionContents","getElementsByTagName","scrollEvents","screen","orientation","onScroll","onCameraIdleListener","generateCallback","setOnBoundsChangedListener","onBoundsChangedListener","setOnCameraMoveStartedListener","onCameraMoveStartedListener","setOnClusterClickListener","onClusterClickListener","setOnClusterInfoWindowClickListener","onClusterInfoWindowClickListener","setOnInfoWindowClickListener","onInfoWindowClickListener","setOnMapClickListener","onMapClickListener","setOnPolygonClickListener","onPolygonClickListener","setOnCircleClickListener","onCircleClickListener","setOnMarkerClickListener","onMarkerClickListener","setOnPolylineClickListener","onPolylineClickListener","setOnMarkerDragStartListener","onMarkerDragStartListener","setOnMarkerDragListener","onMarkerDragListener","setOnMarkerDragEndListener","onMarkerDragEndListener","setOnMyLocationButtonClickListener","onMyLocationButtonClickListener","setOnMyLocationClickListener","onMyLocationClickListener","asyncScheduler","timer","period","scheduler"],"sourceRoot":"webpack:///","x_google_ignoreList":[7,8,9,10,11,12,13,14,15]}