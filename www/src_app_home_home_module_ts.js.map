{"version":3,"file":"src_app_home_home_module_ts.js","mappings":"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","sources":["./src/app/home/home-routing.module.ts","./src/app/home/home.module.ts","./src/app/home/home.page.ts","./src/app/home/home.page.html","./src/app/services/geocode.service.ts","./src/app/services/map.service.ts","./src/app/services/network.service.ts","./node_modules/@capacitor/app/dist/esm/index.js","./node_modules/@capacitor/geolocation/dist/esm/index.js","./node_modules/@capacitor/google-maps/dist/esm/definitions.js","./node_modules/@capacitor/google-maps/dist/esm/implementation.js","./node_modules/@capacitor/google-maps/dist/esm/index.js","./node_modules/@capacitor/google-maps/dist/esm/map.js","./node_modules/rxjs/_esm2015/internal/observable/interval.js"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\nimport { HomePage } from './home.page';\nimport { CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';\n\nimport { HomePageRoutingModule } from './home-routing.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    \n    IonicModule,\n    HomePageRoutingModule\n  ],\n  schemas: [CUSTOM_ELEMENTS_SCHEMA],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","import { AfterViewInit, Component, ElementRef, NgZone, ViewChild } from '@angular/core';\nimport { Geolocation, Position } from '@capacitor/geolocation';\nimport { ModalOptions, ModalController, Platform, NavController, AlertController, ToastController, ActionSheetController } from '@ionic/angular';\nimport { AutocompleteComponent } from '../autocomplete/autocomplete.component';\nimport { OverlayService } from '../services/overlay.service';\nimport { GeocodeService } from '../services/geocode.service';\nimport { MapService } from '../services/map.service';\nimport { AvatarService } from '../services/avatar.service';\nimport { Drivers } from '../interfaces/drivers';\nimport { Observable, timer, interval, BehaviorSubject, throwError, Subscription } from 'rxjs';\nimport { doc as firestoreDoc, updateDoc, getDoc, collection, onSnapshot, doc, Firestore, query, where } from '@angular/fire/firestore';\nimport { Marker, Polyline } from '@capacitor/google-maps';\nimport { AuthService } from '../services/auth.service';\nimport { EnrouteChatComponent } from '../enroute-chat/enroute-chat.component';\nimport { NetworkService } from '../services/network.service'\nimport { Network } from '@capacitor/network';\nimport { Router } from '@angular/router';\nimport { App } from '@capacitor/app';\nimport { PaymentService } from '../services/payment.service';\nimport { AddCardComponent } from '../add-card/add-card.component';\nimport { switchMap } from 'rxjs/operators';\nimport { LatLngLiteral } from '@googlemaps/google-maps-services-js';\nimport { LatLng } from '@capacitor/google-maps/dist/typings/definitions';\nimport { Preferences } from '@capacitor/preferences';\nimport { Auth, onAuthStateChanged } from '@angular/fire/auth';\nimport Debug from 'onesignal-cordova-plugin/dist/DebugNamespace';\nimport { TripSummaryComponent } from '../trip-summary/trip-summary.component';\nimport { geohashForLocation } from 'geofire-common';\n\ndeclare var google;\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage implements AfterViewInit {\n  [x: string]: any;\n  profile = null;\n  @ViewChild('map',  { static: true }) mapRef: ElementRef<HTMLElement>;\n  @ViewChild('topBar', { static: true }) topBar: ElementRef<HTMLElement>;\n  @ViewChild('bottomBar', { static: true }) bottomBar: ElementRef<HTMLElement>;\n  mappy;\n  @ViewChild('mapElement') mapElement: ElementRef<HTMLElement>;\n  coordinates: Position;\n  address: any = 'Unknown';\n  bookingStage: any;\n  confirmStage: any;\n  trackingStage: any;\n  searchingStage: any;\n  noDriverStage: any;\n  drivingToDestinationStage: any;\n  data: any;\n  cash: any = false;\n  state: any = [];\n  mapPinStage: boolean;\n  D_LatLng: { lat: any; lng: any; };\n  mapPinDrag: any;\n  showResetLocationButton: any = false;\n  showloader: boolean;\n  mapClass: any;\n  destinationAddress: string = 'Drag To Pick Destination';\n  locationAddress: string = null;\n  distance: any;\n  direction: any;\n  actualDestination: any;\n  markers: any;\n  allDrivers: Observable<Drivers[]>;\n  NoDrivers: boolean;\n  driverMarker: string;\n  driver_duration_apart: number;\n  driver_number_of_seats: any;\n  price: any = 0;\n  carname: any;\n  driver_ID: any;\n  bounds: any;\n  DriverLatLng: { lat: any; lng: any; };\n  drivers_Requested: any[];\n  current_Request_Number: number = -1;\n  Driver_Rejected: any;\n  numCalls: any;\n  currentDriver: any;\n  private countdownActive = false;\n\n  unsubscribe: import(\"@angular/fire/firestore\").Unsubscribe;\n  driverInfo: import(\"@angular/fire/firestore\").DocumentData;\n  duration: any = null;\n  riderCleared: any;\n  updateDriverSubcription: any;\n  canCheck: boolean;\n  marker1: any;\n  marker2: any;\n  actualLocation: string;\n  LatLng: { lat: number; lng: number; };\n  mapy: boolean;\n  AllCarMarkers: Marker[];\n  private _carmarkers: { id: string, marker: any }[] = [];\n  private rider_marker: any;\n  private driver_marker: any;\n\n  cards: import(\"@angular/fire/firestore\").DocumentData[];\n  selected: any;\n  selectedCard: any;\n  closeDrivers: any;\n  countDown: any;\n  places: import(\"@angular/fire/firestore\").DocumentData[];\n  newPoly: string[];\n  isConnected: boolean;\n  private networkStatus$ = new BehaviorSubject<boolean>(true);\n  pollingInterval: any;\n  animatedMarker: any;\n  driverImage: any;\n  private permissionCheckInterval: any;\n  savedPaymentMethods: any;\n  requestID: string;\n  rideHasStarted: boolean;\n  driverLocation: { lat: number, lng: number } | null = null;\n  stopPolling: boolean = false;\n  riderMarker: string;\n  routePath: google.maps.MVCArray<google.maps.LatLng> | (google.maps.LatLng | google.maps.LatLngLiteral)[];\n  destinationMarker: any;\n  D_duration: any;\n  routePolyline: any;\n  private routeUpdateSubscription: Subscription;\n  topBarHeight: any;\n  bottomBarHeight:any;\n  private readonly RIDE_STATE_KEY = 'activeRideState';\n  private isLoadingDriver = false;\n\n  // Add these stage constants at the class level\n  private readonly STAGES = {\n    BOOKING: 'booking',\n    CONFIRM: 'confirm',\n    TRACKING: 'tracking',\n    SEARCHING: 'searching',\n    DRIVING: 'driving',\n    NO_DRIVER: 'noDriver',\n    MAP_PIN: 'mapPin',\n    NO_DRIVERS: 'noDrivers'\n  } as const;\n\n  // Add this to your class properties\n  private lastHandledState: string | null = null;\n\n  // Add this property to the class\n  private isRideStopProcessed = false;\n\n  constructor(\n    private auth: Auth,\n    private authService: AuthService,\n    private router: Router,\n    private networkService: NetworkService,\n    public map: MapService,\n    private nav: NavController,\n    private platform: Platform,\n    private firestore: Firestore,\n    private readonly database: AvatarService,\n    private ngZone: NgZone,\n    private geocode: GeocodeService,\n    private overlay: OverlayService,\n    private modalCtrl: ModalController,\n    private alert: AlertController,\n    private payME: PaymentService,\n    private toastController: ToastController,\n    private actionSheetController: ActionSheetController\n  \n  ) {\n    this.initializeApp();\n  }\n\n  async ngOnDestroy() {\n    if (this.unsubscribe) {\n      this.unsubscribe();\n    }\n    window.removeEventListener('resize', this.setMapHeight.bind(this));\n    this.clearSubscriptions();\n    await this.clearPrevMarkers();\n    await this.clearAllPolylines();\n  }\n\n\n  async ngAfterViewInit() {\n    try {\n      // First check location permissions\n      const hasPermission = await this.checkAndRequestLocationPermissions();\n      if (!hasPermission) {\n        return;\n      }\n      \n      // Initialize profile first\n      await this.initializeProfile();\n      \n      // Then proceed with other initializations\n      await this.initializeApp();\n      await this.initializeNetworkMonitoring();\n      await this.fetchSavedPaymentMethods();\n      this.EnterBookingStage();\n      await this.initializeGeolocation();\n      await this.initializeMap();\n      \n      // Set up real-time listener for ride state\n      this.initializeRideStateListener();\n    } catch (e) {\n      console.error('Error in ngAfterViewInit:', e);\n      this.overlay.hideLoader();\n      this.overlay.showAlert('Error', 'An error occurred during initialization. Please try again.');\n    }\n  }\n\n  // Add this new method\n  private async initializeProfile() {\n    try {\n      // Show loader while initializing profile\n     // await this.overlay.showLoader('Loading profile...');\n\n      // Wait for auth state to be ready\n      const user = await new Promise<any>((resolve) => {\n        const unsubscribe = onAuthStateChanged(this.auth, (user) => {\n          unsubscribe();\n          resolve(user);\n        });\n      });\n\n      if (!user) {\n        throw new Error('User not authenticated');\n      }\n\n      // Get profile data\n      this.profile = await this.database.getUserProfile();\n      \n      if (!this.profile) {\n        console.log('Creating new profile...');\n        // If profile doesn't exist, create it with default values\n        this.profile = {\n          userId: user.uid,\n          email: user.email,\n          createdAt: new Date().toISOString(),\n          // Add any other default profile fields you need\n        };\n        await this.database.createUserProfile(this.profile);\n      }\n\n      console.log('Profile initialized:', this.profile);\n      this.overlay.hideLoader();\n    } catch (error) {\n      console.error('Error initializing profile:', error);\n      this.overlay.hideLoader();\n      await this.overlay.showAlert(\n        'Profile Error',\n        'Unable to initialize user profile. Please try again or contact support.'\n      );\n      throw error;\n    }\n  }\n\n  // Add this method to check profile before any ride-related action\n  private async ensureProfileInitialized(): Promise<boolean> {\n    if (!this.profile) {\n      try {\n        await this.initializeProfile();\n        return true;\n      } catch (error) {\n        console.error('Error ensuring profile is initialized:', error);\n        return false;\n      }\n    }\n    return true;\n  }\n\n  private initializeRideStateListener() {\n    console.log('Initializing ride state listener');\n    \n    // Reset lastHandledState on initialization to ensure proper state restoration\n    this.lastHandledState = null;\n    \n    onAuthStateChanged(this.auth, (user) => {\n      if (!user) return;\n\n      // Listen to the Request collection for active rides for this user\n      const requestsQuery = query(\n        collection(this.firestore, 'Request'),\n        where('Rider_id', '==', user.uid),\n        where('status', 'in', ['pending', 'confirmed', 'started'])\n      );\n\n      this.unsubscribe = onSnapshot(requestsQuery, async (snapshot) => {\n        try {\n          // If no active rides found, go to booking stage\n          if (snapshot.empty) {\n            console.log('No active rides found');\n            this.setStage(this.STAGES.BOOKING);\n            return;\n          }\n\n          // Get the most recent active ride\n          const activeRides = snapshot.docs;\n          const currentRide = activeRides[0];\n          const rideData = currentRide.data();\n          this.requestID = currentRide.id;\n\n          // Restore price information\n          this.price = rideData.price || 0;\n          console.log('Restored ride price:', this.price);\n          console.log('Current ride status:', rideData.status);\n\n          // IMPORTANT: On app initialization, always restore ride state regardless of lastHandledState\n          const isAppInitialization = !this.lastHandledState;\n          \n          // Only skip if we've already handled this state AND it's not initial app load\n          if (this.lastHandledState === rideData.status && !isAppInitialization) {\n            console.log('State already properly handled:', rideData.status);\n            return;\n          }\n\n          // Store location data for later use\n          if (rideData.Loc_lat && rideData.Loc_lng) {\n            this.LatLng = {\n              lat: rideData.Loc_lat,\n              lng: rideData.Loc_lng\n            };\n          }\n          \n          if (rideData.Des_lat && rideData.Des_lng) {\n            this.D_LatLng = {\n              lat: rideData.Des_lat,\n              lng: rideData.Des_lng\n            };\n          }\n          \n          // Store addresses\n          this.locationAddress = rideData.Rider_Location || 'Unknown location';\n          this.destinationAddress = rideData.Rider_Destination || 'Unknown destination';\n\n          console.log('Restoring ride state:', rideData.status);\n\n          // Handle different ride states\n          switch (rideData.status) {\n            case 'pending':\n              await this.handlePendingState();\n              break;\n            case 'confirmed':\n              console.log('Handling confirmed state on restore...');\n              await this.handleRideConfirmation(rideData);\n              break;\n            case 'started':\n              await this.handleRideStart(currentRide);\n              break;\n            case 'cancelled':\n              await this.handleRideCancellation(rideData);\n              break;\n            default:\n              console.log('Unknown ride status:', rideData.status);\n              this.setStage(this.STAGES.BOOKING);\n          }\n          \n          // Only update lastHandledState AFTER successful handling\n          this.lastHandledState = rideData.status;\n          \n        } catch (error) {\n          console.error('Error handling ride state:', error);\n          if (error.code === 'permission-denied' || error.code === 'not-found') {\n            this.overlay.showAlert('Error', 'Failed to restore ride state. Please try again.');\n            this.setStage(this.STAGES.BOOKING);\n          }\n        }\n      }, (error) => {\n        console.error('Error in ride state listener:', error);\n        this.setStage(this.STAGES.BOOKING);\n      });\n    });\n  }\n\n\n  private handleRemovedRide() {\n    console.log('Ride was removed');\n    this.clearRideData();\n    this.setStage(this.STAGES.BOOKING);\n  }\n\n  private clearRideData() {\n    this.requestID = null;\n    this.driverInfo = null;\n    this.rideHasStarted = false;\n    this.lastHandledState = null;\n    // Clear any other ride-specific data\n  }\n\n  async checkAndRequestLocationPermissions() {\n    try {\n      // Check if running on web platform\n      if (this.platform.is('capacitor')) {\n        const permissionStatus = await Geolocation.checkPermissions();\n        \n        if (permissionStatus.location === 'granted') {\n          this.overlay.hideLoader();\n          return true;\n        }\n\n        const alert = await this.alert.create({\n          header: 'Location Permission Required',\n          message: 'This app needs access to your location to function properly.',\n          buttons: [\n            {\n              text: 'Enable Location',\n              handler: async () => {\n                const newStatus = await Geolocation.requestPermissions();\n                this.overlay.hideLoader();\n                \n                if (newStatus.location !== 'granted') {\n                  await this.showLocationRequiredAlert();\n                  return false;\n                }\n                return true;\n              }\n            }\n          ],\n          backdropDismiss: false\n        });\n\n        await alert.present();\n        const { role } = await alert.onDidDismiss();\n        \n        if (role === 'backdrop') {\n          this.overlay.hideLoader();\n          await this.showLocationRequiredAlert();\n          return false;\n        }\n      } else {\n        // Web platform - use browser's geolocation API\n        if ('geolocation' in navigator) {\n          return new Promise((resolve) => {\n            navigator.permissions.query({ name: 'geolocation' }).then((result) => {\n              if (result.state === 'granted') {\n                this.overlay.hideLoader();\n                resolve(true);\n              } else {\n                this.overlay.hideLoader();\n                resolve(this.showWebLocationPrompt());\n              }\n            });\n          });\n        } else {\n          this.overlay.hideLoader();\n          await this.overlay.showAlert('Error', 'Geolocation is not supported in this browser.');\n          return false;\n        }\n      }\n\n      return true;\n    } catch (error) {\n      console.error('Error checking/requesting location permissions:', error);\n      this.overlay.hideLoader();\n      throw error;\n    }\n  }\n\n  private async showWebLocationPrompt(): Promise<boolean> {\n    const alert = await this.alert.create({\n      header: 'Location Access',\n      message: 'This app needs your location. Please allow location access when prompted by your browser.',\n      buttons: [\n        {\n          text: 'OK',\n          handler: () => {\n            return new Promise((resolve) => {\n              navigator.geolocation.getCurrentPosition(\n                () => resolve(true),\n                () => {\n                  this.showLocationRequiredAlert();\n                  resolve(false);\n                }\n              );\n            });\n          }\n        }\n      ]\n    });\n    await alert.present();\n    return true;\n  }\n\n  private async showLocationRequiredAlert() {\n    const alert = await this.alert.create({\n      header: 'Location Required',\n      message: 'Location permission is required to use this app. Please enable location services in your device settings.',\n      buttons: ['OK']\n    });\n    await alert.present();\n  }\n\n  async fetchSavedPaymentMethods() {\n    try {\n      this.savedPaymentMethods = await this.database.getSavedPaymentMethods();\n      console.log('Saved Payment Methods:', this.savedPaymentMethods);\n      \n      // Set default payment method to cash if no cards are saved\n      if (this.savedPaymentMethods.length === 0) {\n        this.selectedCard = 'cash';\n        this.cash = true;\n      } else {\n        this.selectedCard = this.savedPaymentMethods[0].cardId;\n        this.cash = false;\n      }\n    } catch (error) {\n      console.error('Error fetching saved payment methods:', error);\n    }\n  }\n\n  chooseCard(event: any) {\n    this.selectedCard = event.detail.value;\n    this.cash = this.selectedCard === 'cash';\n    if (!this.cash) {\n     // this.processPayment(this.authService.user.email, this.defaultAmount, this.selectedCard);\n    }\n  }\n\n  async processPayment(email: string, amount: number, cardId: any) {\n    this.overlay.showLoader('Processing payment...');\n\n    try {\n      const paymentResult = await this.payME.processPaymentWithCardId(email, amount, cardId).toPromise();\n      console.log('Payment successful:', paymentResult);\n      await this.overlay.showAlert('Success', 'Payment successful!');\n    } catch (error) {\n      console.error('Error during payment:', error);\n      const errorMessage = error.error ? error.error.error : 'An unexpected error occurred.';\n      await this.showPaymentErrorModal(errorMessage);\n    } finally {\n      this.overlay.hideLoader();\n    }\n  }\n\n  async showPaymentErrorModal(errorMessage: string) {\n    const alert = await this.alert.create({\n      header: 'Payment Error',\n      message: errorMessage,\n      buttons: [\n        {\n          text: 'Add New Card',\n          handler: async () => {\n            const modal = await this.modalCtrl.create({\n              component: AddCardComponent, // Create this component to handle adding a new card\n            });\n            await modal.present();\n            const { data } = await modal.onWillDismiss();\n            if (data && data.newCardId) {\n              this.selectedCard = data.newCardId;\n              this.cash = false;\n            }\n          }\n        },\n        {\n          text: 'Cancel',\n          role: 'cancel'\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n\n  // Add this single unified method for all map height calculations\n  setMapContainerHeight(extraPadding = 0) {\n    if (!this.mapRef || !this.topBar || !this.bottomBar) return;\n    \n    // Get proper measurements of the bars\n    const topHeight = this.topBar.nativeElement.offsetHeight || 0;\n    const bottomHeight = this.bottomBar.nativeElement.offsetHeight || 0;\n    \n    // Calculate available height properly\n    const availableHeight = window.innerHeight - topHeight - bottomHeight + extraPadding;\n    \n    // Set map height\n    this.mapRef.nativeElement.style.height = `${availableHeight}px`;\n    \n    // Ensure map container is positioned properly\n    this.mapRef.nativeElement.style.top = `${topHeight}px`;\n    this.mapRef.nativeElement.style.position = 'absolute';\n    this.mapRef.nativeElement.style.zIndex = '1'; // Lower than UI elements\n    this.mapRef.nativeElement.style.left = '0';\n    this.mapRef.nativeElement.style.right = '0';\n    \n    console.log(`Map container height set to: ${availableHeight}px (top: ${topHeight}px, bottom: ${bottomHeight}px)`);\n  }\n\n  // Update these methods to use the unified approach\n  setMapHeight() {\n    this.setMapContainerHeight(0);\n  }\n\n  setMapHeightCreateAndAddMarkers() {\n    this.setMapContainerHeight(40); // Add some padding if needed\n  }\n\n  setMapHeightHandleDrivertoRider() {\n    this.setMapContainerHeight(20);\n  }\n\n  setMapHeightHandleDrivertoDestination() {\n    this.setMapContainerHeight(0);\n  }\n\n  ResetMapHeight() {\n    this.setMapContainerHeight(0);\n  }\n\n  private async initializeNetworkMonitoring() {\n    const status = await Network.getStatus();\n    this.isConnected = status.connected;\n    this.networkStatus$.next(this.isConnected);\n    console.log('Network monitoring initialized. Initial status:', this.isConnected);\n\n    Network.addListener('networkStatusChange', (status) => {\n      console.log('Network status changed:', status);\n      this.isConnected = status.connected;\n      this.networkStatus$.next(this.isConnected);\n    });\n\n    this.networkStatus$.subscribe((isConnected) => {\n      if (isConnected) {\n        this.router.navigate(['home']);\n      } else {\n        this.router.navigate(['network']);\n      }\n    });\n  }\n\n\n  initializeApp() {\n    this.platform.ready().then(async () => {\n      try {\n        await this.initializeRideStateListener();\n      } catch (error) {\n        console.error('Error initializing app:', error);\n        this.setStage(this.STAGES.BOOKING);\n      }\n    });\n  }\n\n  \n \n  async initializeGeolocation() {\n    try {\n      let coordinates;\n      \n      if (this.platform.is('capacitor')) {\n        coordinates = await Geolocation.getCurrentPosition({\n          timeout: 10000\n        });\n      } else {\n        // Web fallback\n        coordinates = await new Promise((resolve, reject) => {\n          navigator.geolocation.getCurrentPosition(\n            (position) => {\n              resolve({\n                coords: {\n                  latitude: position.coords.latitude,\n                  longitude: position.coords.longitude,\n                  accuracy: position.coords.accuracy,\n                  altitude: position.coords.altitude,\n                  altitudeAccuracy: position.coords.altitudeAccuracy,\n                  heading: position.coords.heading,\n                  speed: position.coords.speed\n                },\n                timestamp: position.timestamp\n              });\n            },\n            (error) => reject(error),\n            { timeout: 10000 }\n          );\n        });\n      }\n      \n      this.coordinates = coordinates;\n      this.LatLng = {\n        lat: coordinates.coords.latitude,\n        lng: coordinates.coords.longitude\n      };\n      \n      await this.database.updateLocation(this.LatLng);\n      console.log('Geolocation initialized:', this.LatLng);\n      \n      this.startPollingPosition();\n    } catch (error) {\n      console.error('Error initializing geolocation:', error);\n      this.overlay.hideLoader();\n      await this.overlay.showAlert(\n        'Location Error',\n        'Unable to get your location. Please check your device settings and try again.'\n      );\n    }\n  }\n  \n  startPermissionPolling() {\n    this.permissionCheckInterval = setInterval(async () => {\n      const permissionStatus = await Geolocation.checkPermissions();\n      if (permissionStatus.location === 'granted') {\n        this.overlay.hideLoader();\n        clearInterval(this.permissionCheckInterval);\n        // Try to get the current position again if permissions are granted\n        const coordinates = await Geolocation.getCurrentPosition();\n        this.coordinates = coordinates;\n        this.LatLng = {\n          lat: coordinates.coords.latitude,\n          lng: coordinates.coords.longitude,\n        };\n        console.log('Geolocation initialized:', this.LatLng);\n  \n        // Start polling the user's position\n        this.startPollingPosition();\n      }\n    }, 1000); // Check every second\n  }\n\n  \n  startPollingPosition() {\n    let lastLatLng = { lat: null, lng: null };\n    let lastAddress = null;\n  \n    this.pollingInterval = setInterval(async () => {\n      try {\n        let position;\n        \n        if (this.platform.is('capacitor')) {\n          position = await Geolocation.getCurrentPosition();\n        } else {\n          // Web fallback\n          position = await new Promise((resolve, reject) => {\n            navigator.geolocation.getCurrentPosition(resolve, reject);\n          });\n        }\n\n        const newLatLng = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        };\n\n        await this.database.updateLocation(newLatLng);\n  \n        if (this.hasSignificantLocationChange(lastLatLng, newLatLng, 50)) { // Check if moved at least 50 meters\n          lastLatLng = newLatLng;\n  \n          const address = await this.map.getAddress(newLatLng.lat, newLatLng.lng);\n          \n          if (address && address.results && address.results.length > 1) {\n            const components = address.results[1].address_components;\n            if (components.length >= 2) {\n              this.locationAddress = components[0].long_name + ' ' + components[1].long_name;\n              this.actualLocation = address.results[0].formatted_address;\n              if (this.locationAddress !== lastAddress) {\n                console.log('Updated Location Address:', this.locationAddress);\n                lastAddress = this.locationAddress;\n              }\n            }\n          } else {\n            console.log('Unable to update location address');\n          }\n        }\n  \n        if (this.networkService.isConnected() && !this.stopPolling) {\n          const center: [number, number] = [newLatLng.lat, newLatLng.lng];\n          const radiusInM = 5000; // Example radius in meters\n          await this.fetchAndDisplayDrivers(center, radiusInM);\n        } else {\n          console.log('No network connection.', this.stopPolling);\n        }\n      } catch (err) {\n        console.error('Error getting position:', err);\n        // Reduce error alerts by not showing specific errors repeatedly\n      }\n    }, 5000); // Poll every 10 seconds\n  }\n  \n  hasSignificantLocationChange(oldLatLng, newLatLng, minDistance) {\n    if (!oldLatLng.lat || !oldLatLng.lng) return true;\n    \n    const R = 6371e3; // Earth radius in meters\n    const 1 = oldLatLng.lat * Math.PI/180;\n    const 2 = newLatLng.lat * Math.PI/180;\n    const  = (newLatLng.lat - oldLatLng.lat) * Math.PI/180;\n    const  = (newLatLng.lng - oldLatLng.lng) * Math.PI/180;\n  \n    const a = Math.sin(/2) * Math.sin(/2) +\n              Math.cos(1) * Math.cos(2) *\n              Math.sin(/2) * Math.sin(/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n  \n    const distance = R * c; // Distance in meters\n  \n    return distance >= minDistance;\n  }\n\n  \n  stopPollingPosition() {\n    if (this.pollingInterval) {\n      clearInterval(this.pollingInterval);\n      this.pollingInterval = null;\n      console.log('Stopped polling position.');\n    } else {\n      console.log('No polling to stop.');\n    }\n  }\n  \n  async initializeMap() {\n    try {\n      // Ensure coordinates are available before creating map\n      if (!this.coordinates || !this.coordinates.coords) {\n        console.warn('Coordinates not available, using default location');\n        // Use default coordinates (Kuala Lumpur, Malaysia)\n        this.coordinates = {\n          coords: {\n            latitude: 3.1390,\n            longitude: 101.6869,\n            accuracy: 0,\n            altitude: null,\n            altitudeAccuracy: null,\n            heading: null,\n            speed: null\n          },\n          timestamp: Date.now()\n        };\n      }\n      \n      await this.map.createMap(this.mapRef.nativeElement, this.coordinates);\n      this.mapy = true;\n      this.actualLocation = this.map.actualLocation;\n     // console.log('Map initialized:', this.actualLocation, this.locationAddress);\n    } catch (error) {\n      console.error('Error initializing map:', error);\n      throw new Error('Map initialization failed');\n    }\n  }\n  \n  initializeDatabaseSubscriptions() {\n    this.database.getKnownPlaces().subscribe((d) => {\n      console.log('Received data:', d);\n      this.places = d.slice(0, 3);\n    });\n  }\n\n\n  initializeBackButtonCustomHandler(): void {\n    this.platform.backButton.subscribeWithPriority(10, () => {\n      console.log('Back button pressed');\n    });\n  \n    App.addListener('backButton', ({ canGoBack }) => {\n      if (!canGoBack) {\n        // Show a confirmation dialog before exiting the app\n        if (confirm('Are you sure you want to exit the app?')) {\n          App.exitApp();\n        }\n      } else {\n        console.log(\"back clicked\");\n        // Use Ionic's NavController to navigate back\n        // Replace 'NavController' with your specific navigation method\n        // this.navCtrl.pop();\n        window.history.back();\n      }\n    });\n\n    // App.addListener('appStateChange', (state) => {\n    //   if (!state.isActive) {\n    //     this.stopPollingPosition();\n    //   } else {\n    //     this.startPollingPosition();\n    //   }\n    // });\n  }\n  \n\n\n  \n  setupMapListeners() {\n    this.map.newMap.setOnCameraIdleListener(async (g) => {\n      this.ngZone.run(async () => {\n        this.showResetLocationButton = true;\n        if (this.mapPinStage) {\n          const addressResponse = await this.geocode.getAddress(g.latitude, g.longitude).toPromise();\n          this.processAddressResponse(addressResponse);\n        }\n      });\n    });\n  }\n  \n  async logout() {\n    await this.authService.logout();\n  }\n  \n  async fetchAndDisplayDrivers(center: [number, number], radiusInM: number): Promise<void> {\n    try {\n      const drivers: Drivers[] = await this.database.checkDriversWithin(center, radiusInM);\n      console.log('Fetched drivers:', drivers);\n  \n      await this.handleDrivers(drivers);\n  \n      if (this.drivers_Requested.length > 0) {\n        this.current_Request_Number = 0; // Set to the first available driver\n        await this.UpdateCarMarker(this.drivers_Requested);\n        this.NoDrivers = false;\n      } else {\n        this.current_Request_Number = -1; // No valid driver\n        await this.UpdateCarMarker([]); // Clear all markers if no drivers are requested\n        this.NoDrivers = true;\n      }\n    } catch (error) {\n      console.error('Error fetching drivers:', error);\n      this.current_Request_Number = -1; // Reset the request number\n      await this.UpdateCarMarker([]); // Clear all markers if there's an error\n      this.NoDrivers = true;\n    }\n  }\n  \n  \n  async handleDrivers(drivers: Drivers[]) {\n    this.drivers_Requested = [];\n    this.closeDrivers = null;\n  \n    console.log('Handling drivers:', drivers);\n  \n    if (drivers.length === 0) {\n      this.NoDrivers = true;\n      console.log('No drivers found.');\n      return;\n    }\n  \n    drivers.forEach((driver) => {\n      if (driver) {\n        console.log('Processing driver:', driver);\n        if (driver.duration <= 1000 && driver.onlineState) {\n          this.drivers_Requested.push(driver);\n          this.updateDriverInfo(driver);\n        }\n  \n        if (!this.closeDrivers || driver.duration < this.closeDrivers.duration) {\n          this.closeDrivers = driver;\n        }\n      } else {\n        console.error('Driver is null or undefined:', driver);\n      }\n    });\n  \n    if (this.drivers_Requested.length === 0) {\n      this.NoDrivers = true;\n    } else {\n      // Ensuring current_Request_Number is within the bounds\n      this.current_Request_Number = Math.min(this.current_Request_Number, this.drivers_Requested.length - 1);\n    }\n  \n    console.log('Final requested drivers list:', this.drivers_Requested);\n  }\n  \n   // Unsubscribe from all active listeners (for cleanup)\n   cleanupListeners() {\n    Object.values(this.database.activeListeners).forEach(unsubscribe => unsubscribe());\n    this.database.activeListeners = {};\n  }\n \n  \n  updateDriverInfo(driver) {\n    console.log(this.drivers_Requested);\n    this.carname = driver.Driver_car;\n    this.driverImage = driver.Driver_imgUrl,\n    this.driver_duration_apart = Math.ceil(driver.duration / 60000);\n    this.driver_ID = driver.Driver_id;\n    this.driver_number_of_seats = driver.seats;\n    this.DriverLatLng = {\n      lat: driver.Driver_lat,\n      lng: driver.Driver_lng\n    };\n  }\n  \n  async StartRide() {\n    if (this.isLoadingDriver) {\n      console.log('Ride request already in progress...');\n      return;\n    }\n\n    this.isLoadingDriver = true;\n    this.overlay.showLoader('Preparing your ride...');\n\n    try {\n      // Group operations that can be done concurrently\n      await Promise.all([\n        this.clearPrevMarkers(),\n        this.clearAllPolylines()\n      ]);\n      \n      this.map.newMap.enableTouch();\n      await this.BookRide();\n      \n    } catch (error) {\n      console.error('Error starting ride:', error);\n      await this.overlay.showAlert('Starting Ride Error', error.message || 'Failed to start ride');\n    } finally {\n      // Ensure we always hide the loader and reset the loading state\n      this.isLoadingDriver = false;\n      this.overlay.hideLoader();\n    }\n  }\n\nasync clearMarkers() {\n  if (this.marker1) {\n    await this.map.newMap.removeMarker(this.marker1);\n    this.marker1 = null;\n  }\n\n  if (this.marker2) {\n    await this.map.newMap.removeMarker(this.marker2.toString());\n    this.marker2 = null;\n  }\n\n  if (this._carmarkers) {\n    for (const { marker } of this._carmarkers) {\n      await this.map.newMap.removeMarker(marker); // Assuming marker is the instance\n    }\n    this._carmarkers = []; // Clear the array after removing markers\n  }\n}\n\nasync BookRide() {\n  try {\n    if (!await this.ensureProfileInitialized()) {\n      throw new Error('Profile not initialized');\n    }\n    if (!this.hasValidDriver()) {\n      this.showNoDriversAlert();\n      return;\n    }\n    \n    const driver = this.drivers_Requested[this.current_Request_Number];\n    const userDocRef = doc(this.firestore, `Drivers`, driver.Driver_id);\n    \n    const docSnapshot = await getDoc(userDocRef);\n    \n    if (!docSnapshot.exists()) {\n      throw new Error('Driver document not found');\n    }\n\n    const data = docSnapshot.data();\n    if (!data?.onlineState) {\n      await this.handleNoAvailableDriver();\n      return;\n    }\n\n    this.driverInfo = data;\n    await this.requestRideWithDriverDetails(driver, userDocRef);\n    this.updateDriverInfo(driver);\n    \n  } catch (error) {\n    console.error('Error in BookRide:', error);\n    this.overlay.showAlert('Error', 'Unable to book ride. Please try again.');\n  }\n}\n\nhasValidDriver(): boolean {\n  return this.drivers_Requested?.[this.current_Request_Number]?.Driver_id != null;\n}\n\nasync requestRideWithDriverDetails(driver, userDocRef) {\n  try {\n    if (!await this.ensureProfileInitialized()) {\n      throw new Error('Profile not initialized');\n    }\n    const requestDetails = {\n      latLng: this.LatLng,\n      destinationAddress: this.destinationAddress,\n      locationAddress: this.locationAddress,\n      dLatLng: this.D_LatLng,\n      driverId: driver.Driver_id,\n      price: this.price,\n      cash: this.cash\n    };\n\n    this.requestID = await this.database.RequestRideWithRiderDetails(requestDetails);\n\n    if (this.requestID) {\n      this.currentDriver = driver;\n      \n      // Set up listener before handling pending state\n      const rideRequestDocRef = doc(this.firestore, `Request`, this.requestID);\n      const unsub = onSnapshot(rideRequestDocRef, async (doc) => {\n        if (doc.exists()) {\n          await this.handleRideUpdates(doc);\n        } else {\n          console.error('Ride request document does not exist.');\n        }\n      });\n\n      this.unsubscribe = unsub;\n      \n      // Now handle the pending state\n      await this.handlePendingState();\n    } else {\n      throw new Error('Failed to generate requestID');\n    }\n  } catch (error) {\n    console.error('Error in requestRideWithDriverDetails:', error);\n    this.overlay.showAlert('Error', 'Unable to request ride. Please try again.');\n  }\n}\n\nshowNoDriversAlert() {\n  console.error('No valid driver available to book a ride.');\n  this.overlay.showAlert('No Drivers ', 'No available drivers found. Please try again later.');\n}\n\nasync handleNoAvailableDriver() {\n  console.log('Driver is not available, moving to next.');\n  this.current_Request_Number++;\n  if (this.hasValidDriver()) {\n    await this.BookRide();\n  } else {\n    this.showNoDriversAlert();\n  }\n}\n\n// Make sure to clear the subscription when it's no longer needed\nclearSubscriptions() {\n  console.log('Clearing all subscriptions');\n  \n  // Clear routeUpdateSubscription first as it's the main culprit\n  if (this.routeUpdateSubscription) {\n    this.routeUpdateSubscription.unsubscribe();\n    this.routeUpdateSubscription = null;\n  }\n  \n  // Clear other subscriptions\n  if (this.numCalls) {\n    this.numCalls.unsubscribe();\n    this.numCalls = null;\n  }\n  if (this.countDown) {\n    this.countDown.unsubscribe();\n    this.countDown = null;\n  }\n  if (this.unsubscribe) {\n    this.unsubscribe();\n    this.unsubscribe = null;\n  }\n  \n  // Stop any polling interval\n  if (this.pollingInterval) {\n    clearInterval(this.pollingInterval);\n    this.pollingInterval = null;\n  }\n  \n  // Reset any animation state\n  this.animatedMarker = null;\n}\n\nasync handleRideUpdates(doc) {\n  const data = doc.data();\n  if (!data) return;\n\n  try {\n    switch (data.status) {\n      case 'confirmed':\n        await this.handleRideConfirmation(doc);\n        break;\n      case 'started':\n        await this.handleRideStart(doc);\n        break;\n      case 'stopped':\n        await this.handleRideStop(doc);\n        break;\n      case 'cancelled':\n        await this.handleRideCancellation(data);\n        break;\n    }\n  } catch (error) {\n    console.error('Error handling ride updates:', error);\n    if (error.code === 'permission-denied' || error.code === 'not-found') {\n      await this.ReturnHome();\n    }\n  }\n}\n\n\nasync handlePendingState() {\n  try {\n    // Don't show another loader here since BookRide is already showing one\n    if (!this.currentDriver?.Driver_id) {\n      throw new Error('No valid driver ID found');\n    }\n\n    // Get driver location with timeout\n    const locationPromise = this.getDriverLocation(this.currentDriver.Driver_id);\n    const timeoutPromise = new Promise((_, reject) => \n      setTimeout(() => reject(new Error('Location fetch timeout')), 10000)\n    );\n    \n    await Promise.race([locationPromise, timeoutPromise]);\n\n    if (!this.DriverLatLng) {\n      throw new Error('Failed to get driver location');\n    }\n\n    // Group all map operations\n    await Promise.all([\n      this.clearPrevMarkers(),\n      this.clearPolyline(this.newPoly),\n      this.map.newMap.setCamera({\n        animate: true,\n        animationDuration: 500,\n        zoom: 15,\n        coordinate: this.DriverLatLng\n      })\n    ]);\n    \n    // Update map height properly instead of using fixed positioning\n    this.ngZone.run(() => {\n      this.setMapHeightHandleDrivertoRider();\n    });\n    \n    await this.handleDriverToRider(this.DriverLatLng, this.LatLng);\n    this.EnterSearchingStage();\n    await this.startCountdown(20, this.requestID);\n    \n  } catch (error) {\n    console.error('Error in handlePendingState:', error);\n    throw error; // Let BookRide handle the error and cleanup\n  }\n}\n\n\nasync presentCancelRideActionSheet() {\n  const actionSheet = await this.actionSheetController.create({\n    header: 'Cancel Ride',\n    buttons: [\n      {\n        text: 'Changed my mind',\n        handler: () => {\n          this.cancelRide('Changed my mind');\n        }\n      },\n      {\n        text: 'Driver took too long',\n        handler: () => {\n          this.cancelRide('Driver took too long');\n        }\n      },\n      {\n        text: 'Found another ride',\n        handler: () => {\n          this.cancelRide('Found another ride');\n        }\n      },\n      {\n        text: 'Other',\n        handler: () => {\n          this.cancelRide('Other');\n        }\n      },\n      {\n        text: 'Cancel',\n        role: 'cancel'\n      }\n    ]\n  });\n  await actionSheet.present();\n}\n\nasync cancelRide(reason: string) {\n  const rideRef = doc(this.firestore, 'Request', this.requestID);\n  await updateDoc(rideRef, {\n    status: 'cancelled',\n    cancellationReason: reason,\n    canceledBy: 'rider'\n  });\n  const toast = await this.toastController.create({\n    message: 'Ride has been cancelled.',\n    duration: 2000\n  });\n  await toast.present();\n}\n\n\n\nasync handleRideCancellation(data) {\n  this.stopCountdown();\n  await this.clearPrevMarkers();\n  this.unsubscribe();\n  this.clearSubscriptions();\n  if (this.drivers_Requested[this.current_Request_Number + 1] && !this.rideHasStarted) {\n    this.current_Request_Number++;\n    await this.BookRide();\n        } else {\n    if (data.canceledBy == 'driver') {\n      this.overlay.showAlert('Cancelled', 'Driver cancelled');\n    } \n    this.ClearRide();\n      this.ReturnHome();\n  }\n}\n\n\nasync handleRideStart(doc) {\n  try {\n    console.log('Starting ride tracking setup...');\n    \n    // Clear previous visual elements\n    await this.clearPrevMarkers();\n    await this.clearPolyline(this.newPoly);\n    \n    // Get ride data and validate\n    const data = doc.data();\n    if (!data) {\n      console.warn('handleRideStart: No data found in document');\n      throw new Error('No ride data available');\n    }\n    \n    console.log('handleRideStart data:', data);\n    \n    // Set ride state flag first to prevent race conditions\n    this.rideHasStarted = true;\n    \n    // Set current driver from document data with fallback options\n    if (data.driverDetails) {\n      this.currentDriver = data.driverDetails;\n      this.driverInfo = data.driverDetails;\n    } else if (data.driverId) {\n      console.log('Driver details missing, attempting to fetch from driver ID');\n      try {\n        const driverDoc = await getDoc(doc(this.firestore, 'Drivers', data.driverId));\n        if (driverDoc.exists()) {\n          this.driverInfo = driverDoc.data();\n          this.currentDriver = this.driverInfo;\n        }\n      } catch (error) {\n        console.warn('Failed to fetch driver details:', error);\n        // Continue with limited driver info\n      }\n    }\n    \n    // Adjust map height before adding markers\n    this.setMapHeightHandleDrivertoDestination();\n    window.addEventListener('resize', this.setMapHeightHandleDrivertoDestination.bind(this));\n    \n    // Initialize locations with fallbacks\n    this.LatLng = {\n      lat: data.Loc_lat || (this.LatLng?.lat || 0),\n      lng: data.Loc_lng || (this.LatLng?.lng || 0)\n    };\n    \n    this.D_LatLng = {\n      lat: data.Des_lat || (this.D_LatLng?.lat || 0),\n      lng: data.Des_lng || (this.D_LatLng?.lng || 0)\n    };\n    \n    // Ensure map is initialized\n    if (!this.map.newMap) {\n      console.log('Map not initialized in handleRideStart, initializing now...');\n      try {\n        await this.initializeMap();\n      } catch (mapError) {\n        console.error('Failed to initialize map:', mapError);\n        // Allow continuation with limited functionality\n      }\n    }\n    \n    // Get driver location with better error handling\n    let driverLocationFetched = false;\n    \n    if (data.driverId) {\n      try {\n        console.log('Fetching driver location for ID:', data.driverId);\n        \n        // Use Promise.race with a timeout to prevent hanging\n        const locationPromise = this.database.getDriverLocation(data.driverId);\n        const timeoutPromise = new Promise((_, reject) => \n          setTimeout(() => reject(new Error('Driver location fetch timeout')), 5000)\n        );\n        \n        const driverLocation = await Promise.race([locationPromise, timeoutPromise]) as any;\n        \n        if (driverLocation && typeof driverLocation === 'object' && 'lat' in driverLocation && 'lng' in driverLocation) {\n          console.log('Got real-time driver location:', driverLocation);\n          this.DriverLatLng = {\n            lat: driverLocation.lat,\n            lng: driverLocation.lng\n          };\n          driverLocationFetched = true;\n        }\n      } catch (locationError) {\n        console.warn('Error getting real-time driver location:', locationError);\n        // Will use fallback below\n      }\n    }\n    \n    // Fallback to location in document if real-time fetch failed\n    if (!driverLocationFetched) {\n      console.log('Using driver location from document data');\n      this.DriverLatLng = {\n        lat: data.driverDetails?.Driver_lat || data.driver_lat || this.LatLng.lat,\n        lng: data.driverDetails?.Driver_lng || data.driver_lng || this.LatLng.lng\n      };\n    }\n    \n    // Setup UI state even if visualization might fail\n    this.EnterDrivingToDestinationStage();\n    this.canCheck = true;\n    \n    // Proceed with visualization if we have valid coordinates\n    if (this.DriverLatLng?.lat && this.D_LatLng?.lat) {\n      console.log('Calling handleRiderToDestination with locations:', \n                  'Driver:', this.DriverLatLng, \n                  'Destination:', this.D_LatLng);\n      \n      try {\n        await this.handleRiderToDestination(this.DriverLatLng, this.D_LatLng);\n      } catch (visualError) {\n        console.warn('Failed to visualize route, but ride is still active:', visualError);\n        // Show a non-blocking toast or notification\n        const toast = await this.toastController.create({\n          message: 'Route visualization failed, but your ride is still active',\n          duration: 3000\n        });\n        toast.present();\n      }\n    } else {\n      console.warn('Invalid coordinates for visualization:', this.DriverLatLng, this.D_LatLng);\n      const toast = await this.toastController.create({\n        message: 'Location data incomplete. Your ride is active but not fully visualized.',\n        duration: 3000\n      });\n      toast.present();\n    }\n    \n    console.log('Ride tracking setup completed successfully');\n    \n  } catch (error) {\n    console.error('Error in handleRideStart:', error);\n    \n    // Still enter driving stage so user can see at least some UI\n    this.EnterDrivingToDestinationStage();\n    this.canCheck = true;\n    \n    // Show a less alarming message to the user\n    const toast = await this.toastController.create({\n      message: 'Some ride details couldn\\'t be loaded. Your ride is still active.',\n      duration: 3000\n    });\n    toast.present();\n  }\n}\n\n// Improve handleRideStop to better handle map errors\nasync handleRideStop(docSnapshot) {\n  try {\n    console.log('Handling ride stop...');\n    \n    // If already processed, exit immediately\n    if (this.isRideStopProcessed) {\n      console.log('Ride stop already processed, exiting function');\n      return;\n    }\n    \n    // Set flag immediately to prevent re-processing\n    this.isRideStopProcessed = true;\n    \n    // Stop all location polling and mapping activities immediately\n    this.stopPolling = true;\n    \n    // Unsubscribe from route updates first\n    if (this.routeUpdateSubscription) {\n      this.routeUpdateSubscription.unsubscribe();\n      this.routeUpdateSubscription = null;\n    }\n    \n    // Then clear other subscriptions\n    this.clearSubscriptions();\n    \n    // Force removal of all map elements with multiple attempts if needed\n    for (let attempt = 0; attempt < 3; attempt++) {\n      try {\n        await this.clearPrevMarkers();\n        await this.clearAllPolylines();\n        break; // Exit loop if successful\n      } catch (e) {\n        console.error(`Map cleanup attempt ${attempt + 1} failed:`, e);\n        // Short delay before retry\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n    }\n    \n    // Prepare ride data with proper fallbacks for required fields\n    const docData = docSnapshot.data ? docSnapshot.data() : docSnapshot;\n    const tripId = docSnapshot.id || this.requestID;\n    \n    \n    const rideData = {\n      tripId: tripId || '',\n      driverId: docData?.driverDetails?.Driver_id || this.driverInfo?.Driver_id || '',\n      driverName: docData?.driverDetails?.Driver_name || this.driverInfo?.Driver_name || 'Unknown Driver',\n      driverImage: docData?.driverDetails?.Driver_imgUrl || this.driverInfo?.Driver_imgUrl || '',\n      driverCar: docData?.driverDetails?.Driver_car || this.driverInfo?.Driver_car || '',\n      driverPlate: docData?.driverDetails?.Driver_plate || this.driverInfo?.Driver_plate || '',\n      pickup: docData?.Rider_Location || this.locationAddress || 'Unknown pickup',\n      destination: docData?.Rider_Destination || this.destinationAddress || 'Unknown destination',\n      price: docData?.price || this.price || 0,\n      distance: docData?.distance || this.distance || 0,\n      duration: docData?.duration || this.duration || '',\n      rating: docData?.driverDetails?.Driver_rating || this.driverInfo?.Driver_rating || 0,\n      completed: true,\n      completedAt: new Date()\n    };\n\n    // CRITICAL: Clear ride state from storage BEFORE showing modal\n    try {\n      await Preferences.remove({ key: this.RIDE_STATE_KEY });\n      console.log('Cleared ride state from storage');\n    } catch (e) {\n      console.warn('Error clearing storage:', e);\n    }\n\n    // Reset ride properties BEFORE showing modal\n    this.rideHasStarted = false;\n    this.driverLocation = null;\n    this.lastHandledState = null;\n    \n    console.log('Showing trip summary with data:', rideData);\n    \n    // Show the trip summary\n    const modal = await this.modalCtrl.create({\n      component: TripSummaryComponent,\n      componentProps: { rideData }\n    });\n    \n    await modal.present();\n    \n    // Clean up once modal is dismissed\n    modal.onDidDismiss().then(() => {\n      console.log('Trip summary dismissed, resetting state');\n      this.isRideStopProcessed = false; // Reset the flag\n      this.clearRideState();            // Additional cleanup\n      this.ReturnHome();                // Return to booking view\n    });\n\n  } catch (error) {\n    console.error('Error in handleRideStop:', error);\n    this.isRideStopProcessed = false;\n    this.ReturnHome();\n  }\n}\n\n// Add this method for more thorough ride state cleanup\nprivate clearRideState() {\n  console.log('Clearing ride state completely');\n  \n  // First clear all subscriptions\n  this.clearSubscriptions();\n  \n  // Reset all ride-related properties\n  this.requestID = null;\n  this.driverInfo = null;\n  this.currentDriver = null;\n  this.driver_marker = null;\n  this.rider_marker = null;\n  this.destinationMarker = null;\n  this.routePolyline = null;\n  this.routePath = null;\n  this.newPoly = null;\n  this.animatedMarker = null;\n  this.driverLocation = null;\n  this.isRideStopProcessed = false;\n  \n  // Reset stage-related properties\n  this.bookingStage = false;\n  this.confirmStage = false;\n  this.trackingStage = false;\n  this.searchingStage = false;\n  this.noDriverStage = false;\n  this.drivingToDestinationStage = false;\n  this.mapPinStage = false;\n  \n  // Set default stage\n  this.EnterBookingStage();\n  \n  // Stop polling\n  this.stopPolling = false;\n  \n  // Re-enable map interactions if needed\n  if (this.map && this.map.newMap) {\n    this.map.newMap.enableCurrentLocation(true);\n    this.map.newMap.enableTouch();\n  }\n}\n\nasync handleRideConfirmation(docOrData) {\n  try {\n    console.log('Starting ride confirmation handling...', docOrData);\n    this.stopCountdown();\n\n    // Clear existing markers and polylines\n    await Promise.all([\n      this.clearPrevMarkers(),\n      this.clearPolyline(this.newPoly)\n    ]);\n\n    // Get the ride data\n    let rideData;\n    let docId;\n    \n    if (!docOrData) {\n      throw new Error('Invalid input: null or undefined');\n    }\n    \n    // Handle different input types\n    if (typeof docOrData.data === 'function') {\n      // It's a Firebase DocumentSnapshot\n      rideData = docOrData.data();\n      docId = docOrData.id;\n    } else {\n      // It's already a data object from currentRide.data()\n      rideData = docOrData;\n      docId = this.requestID; // Use the current requestID if available\n    }\n    \n    if (!rideData) {\n      throw new Error('No ride data found');\n    }\n\n    // Update ride information\n    this.requestID = docId || rideData.requestId;\n    this.driverInfo = rideData.driverDetails;\n    \n    // Set driver information for UI display to avoid template errors\n    if (this.driverInfo) {\n      this.carname = this.driverInfo.Driver_car || 'Unknown Car';\n      this.driverImage = this.driverInfo.Driver_imgUrl || 'assets/icon/profile.png';\n      this.driver_ID = this.driverInfo.Driver_id;\n      this.driver_number_of_seats = this.driverInfo.seats || 4;\n      this.driver_duration_apart = this.driverInfo.duration ? \n        Math.ceil(this.driverInfo.duration / 60000) : 0;\n    }\n    \n    // Set locations\n    this.LatLng = {\n      lat: rideData.Loc_lat,\n      lng: rideData.Loc_lng\n    };\n    \n    this.D_LatLng = {\n      lat: rideData.Des_lat,\n      lng: rideData.Des_lng\n    };\n\n    // Initialize map if not already initialized\n    if (!this.map.newMap) {\n      await this.initializeMap();\n    }\n\n    // Get and wait for driver location\n    if (!this.driverInfo?.Driver_id) {\n      console.warn('Driver ID not found in driver details, using fallback location');\n      // Use fallback location from driver details\n      this.driverLocation = {\n        lat: this.driverInfo?.Driver_lat || this.driverInfo?.driver_lat,\n        lng: this.driverInfo?.Driver_lng || this.driverInfo?.driver_lng\n      };\n    } else {\n      try {\n        await this.getDriverLocation(this.driverInfo.Driver_id);\n      } catch (locationError) {\n        console.warn('Error getting real-time driver location, using fallback:', locationError);\n        // Use fallback location from driver details\n        this.driverLocation = {\n          lat: this.driverInfo?.Driver_lat || this.driverInfo?.driver_lat,\n          lng: this.driverInfo?.Driver_lng || this.driverInfo?.driver_lng\n        };\n      }\n    }\n\n    if (!this.driverLocation?.lat || !this.driverLocation?.lng) {\n      throw new Error('Unable to determine driver location');\n    }\n\n    this.DriverLatLng = {\n      lat: this.driverLocation.lat,\n      lng: this.driverLocation.lng\n    };\n\n    console.log('Driver location set:', this.DriverLatLng);\n\n    // Set map height and add event listener\n    this.setMapHeightHandleDrivertoRider();\n    window.addEventListener('resize', this.setMapHeightHandleDrivertoRider.bind(this));\n\n    // Initialize the map view with driver and rider markers\n    await this.handleDriverToRider(this.DriverLatLng, this.LatLng);\n\n    // Update UI state\n    this.EnterTrackingStage();\n    \n    // Save ride state to local storage\n    await this.saveRideStateToStorage();\n\n    console.log('Ride confirmation handled successfully');\n    return true;\n  } catch (error) {\n    console.error('Error handling ride confirmation:', error);\n    return false;\n  }\n}\n\n// Add this method to save ride state to storage\nprivate async saveRideStateToStorage() {\n  try {\n    const rideState = {\n      requestID: this.requestID,\n      driverInfo: this.driverInfo,\n      LatLng: this.LatLng,\n      D_LatLng: this.D_LatLng,\n      DriverLatLng: this.DriverLatLng,\n      stage: this.getCurrentStage()\n    };\n    \n    await Preferences.set({\n      key: 'RIDE_STATE',\n      value: JSON.stringify(rideState)\n    });\n    \n    console.log('Ride state saved successfully');\n  } catch (error) {\n    console.error('Error saving ride state:', error);\n    // Don't throw the error as this is not critical\n  }\n}\n\n\n// Update getDriverLocation to return a Promise<void> and handle errors better\ngetDriverLocation(driverId: string): Promise<void> {\n  if (!driverId) {\n    return Promise.reject(new Error('No driver ID provided'));\n  }\n\n  console.log('Getting driver location for:', driverId);\n  return this.database.getDriverLocation(driverId)\n    .then(location => {\n      if (!location || !location.lat || !location.lng) {\n        throw new Error('Invalid location data received');\n      }\n      console.log('Driver location received:', location);\n      this.driverLocation = location;\n    })\n    .catch(error => {\n      console.error('Error getting driver location:', error);\n      throw error;\n    });\n}\n\n\n\nasync EnterChat(): Promise<void> {\nconst options: ModalOptions = {\n    component: EnrouteChatComponent,\n    componentProps: {\n        userId: this.requestID,\n        message: \"\"\n    },\n    swipeToClose: true,\n};\n\nconst modal = await this.modalCtrl.create(options);\nreturn await modal.present();\n}\n\nasync startCountdown(initialTime, requestId) {\n  this.countdownActive = true;\n  let timeRemaining = initialTime;\n\n  const updateCountdown = async () => {\n    if (!this.countdownActive) {\n      console.log('Countdown stopped');\n      return;\n    }\n\n    if (timeRemaining > 0) {\n      try {\n        await this.database.UpdateCountDown(timeRemaining, requestId);\n        timeRemaining--;\n        setTimeout(updateCountdown, 1000);\n      } catch (error) {\n        console.error('Error updating countdown:', error);\n        // Retry after a short delay\n        setTimeout(updateCountdown, 2000);\n      }\n    } else {\n      await this.handleCountdownEnd(requestId);\n      console.log('Countdown ended');\n    }\n  };\n\n  updateCountdown();\n}\n\nasync handleCountdownEnd(requestId) {\n  try {\n    // Implement a grace period to account for any delays\n    setTimeout(async () => {\n      await this.clearPrevMarkers();\n      await this.requestNextDriver();\n    }, 5000); // 5-second grace period\n  } catch (error) {\n    console.error('Error handling countdown end:', error);\n    // Optionally, retry the operation or notify the user\n  }\n}\n\n\nstopCountdown() {\n  this.countdownActive = false;\n}\n\nasync goBackToAutoComplete() {\n  try {\n    this.stopPolling = false;\n    // Enable current location and set the camera to the initial position\n    await this.map.newMap.enableCurrentLocation(true);\n \n\n    await this.ResetState();\n\n    await this.showAutocompleteModal();\n    \n\n    console.log('Game state reset successfully');\n  } catch (error) {\n    console.error('Error resetting game state:', error);\n  }\n}\n\nprivate async clearPrevMarkers() {\n  try {\n    // Check if map is initialized\n    if (!this.map || !this.map.newMap) {\n      console.warn('Map not initialized when clearing markers');\n      return; // Exit early if map is not available\n    }\n    \n    console.log('Clearing all markers...');\n    \n    // Clear individual markers with proper error handling\n    const markers = [\n      this.rider_marker,\n      this.driver_marker,\n      this.destinationMarker,\n      this.marker1,\n      this.marker2,\n      this.animatedMarker\n    ];\n    \n    const clearPromises = markers\n      .filter(marker => marker !== null && marker !== undefined)\n      .map(marker => this.clearMarker(marker).catch(e => {\n        console.error('Error clearing specific marker:', e);\n        // Continue despite error\n        return null;\n      }));\n    \n    await Promise.all(clearPromises);\n    \n    // Reset all marker references\n    this.rider_marker = null;\n    this.driver_marker = null;\n    this.destinationMarker = null;\n    this.marker1 = null;\n    this.marker2 = null;\n    this.animatedMarker = null;\n    \n    console.log('All markers cleared successfully');\n  } catch (e) {\n    console.error('Error in clearPrevMarkers:', e);\n    // Just log the error but don't throw, allowing the process to continue\n  }\n}\n\n// Add this helper method for individual marker clearing\nprivate async clearMarker(marker) {\n  if (!marker || !this.map?.newMap) return Promise.resolve();\n  \n  try {\n    console.log('Clearing marker:', marker);\n    await this.map.newMap.removeMarker(marker);\n    return true;\n  } catch (error) {\n    console.error('Error clearing marker:', error);\n    return false;\n  }\n}\n\n// Modify clearAllPolylines for safer handling\nasync clearAllPolylines() {\n  try {\n    if (!this.map || !this.map.newMap) {\n      console.warn('Map not initialized when clearing polylines');\n      return;\n    }\n    \n    console.log('Clearing all polylines...');\n    \n    // Try to clear specific polyline first\n    if (this.newPoly) {\n      try {\n        await this.map.newMap.removePolylines(this.newPoly);\n        console.log('Specific polyline cleared');\n      } catch (error) {\n        console.error('Error clearing specific polyline:', error);\n      }\n    }\n    \n    // Reset reference\n    this.newPoly = null;\n      } catch (error) {\n    console.error('Error in clearAllPolylines:', error);\n    // Just log the error but don't throw\n  }\n}\n\n\nasync ResetState(){\n  try{\n    // Clear previous markers\n    await this.clearPrevMarkers();\n\n    // Clear any existing polylines\n    await this.clearPolyline(this.newPoly);\n\n    await this.map.newMap.setCamera({\n      animate: true,\n      animationDuration: 500,\n      zoom: 15,\n      coordinate: this.LatLng\n    });\n\n    this.ResetMapHeight();\n    window.addEventListener('resize', this.ResetMapHeight.bind(this));\n  \n    this.map.newMap.enableTouch();\n    // Ensure the map respects the boundaries of the top and bottom bars\n    this.current_Request_Number = 0;\n    this.price = null;\n    this.actualDestination = null;\n    this.D_LatLng = { lat: null, lng: null };\n    this.destinationAddress = 'Unknown location';\n\n    await this.map.newMap.enableCurrentLocation(true);\n    \n  }catch(e){\n    throw new Error(e);\n    \n  }\n}\n\nasync showAutocompleteModal(): Promise<void> {\n  const options: ModalOptions = {\n      component: AutocompleteComponent,\n      componentProps: {\n          LatLng: this.LatLng,\n          locationAddress: this.locationAddress,\n      },\n      swipeToClose: true,\n  };\n\n  const modal = await this.modalCtrl.create(options);\n  await modal.present();\n\n  const { data } = await modal.onWillDismiss();\n  console.log('Modal dismissed with data:', data);\n\n  this.data = data;\n\n  if (data.pinOnMap) {\n      this.EnterMapPinStage();\n      this.mapPinDrag = true;\n      this.stopPolling = true;\n\n  }\n\n  if (data.home) {\n      console.log(\"Entering Booking Stage...\");\n      this.EnterBookingStage();\n      this.stopPolling = false;\n      this.ResetState();\n  }\n\n  if (data.searching) {\n      this.database.AddKnownPlace(data);\n      this.destinationAddress = data.full;\n      this.actualDestination = data.whole.full;\n\n      try {\n          const latLng = await this.geocode.getLatLng(data.whole.description).toPromise();\n          this.D_LatLng = {\n              lat: latLng.results[0].geometry.location.lat,\n              lng: latLng.results[0].geometry.location.lng,\n          };\n          console.log(\"Destination LatLng:\", this.D_LatLng);\n\n          await this.getDistanceAndDirections();\n    } catch (error) {\n          console.error(\"Error in geocoding:\", error);\n          this.overlay.showAlert('Error in geocoding:', error.message);\n      }\n  }\n}\n\n\nasync RequestRide(dat) {\n  if (!this.NoDrivers) {\n    this.destinationAddress = dat.place.full;\n    this.actualDestination = dat.place.whole.full;\n\n    try {\n      const latLng = await this.geocode.getLatLng(dat.place.whole.description).toPromise();\n      this.D_LatLng = {\n        lat: latLng.results[0].geometry.location.lat,\n        lng: latLng.results[0].geometry.location.lng,\n      };\n\n      await this.getDistanceAndDirections();\n  } catch (error) {\n      console.error(\"Error in geocoding:\", error);\n      this.overlay.showAlert('Check Your Network', error.message);\n    }\n  } else {\n    this.EnterNoDriverStage();\n    console.log(\"No drivers available\");\n  }\n}\n\nasync getDistanceAndDirections() {\n  console.log(\"getDistanceAndDirections called\");\n  this.duration = null;\n  await this.clearMarkers();\n  this.cleanupListeners();\n  this.stopPolling = true;\n\n  if (this.D_LatLng && this.D_LatLng.lat) {\n    console.log(\"D_LatLng is set:\", this.D_LatLng);\n\n    if (!this.NoDrivers) {\n      this.EnterConfirmStage();\n    } else {\n      this.EnterNoDriverStage();\n      console.log(\"No drivers available\");\n      return;\n    }\n    \n    const origin1 = new google.maps.LatLng(this.LatLng.lat, this.LatLng.lng);\n    const origin2 = new google.maps.LatLng(this.D_LatLng.lat, this.D_LatLng.lng);\n    \n    const request = {\n      origin: origin1,\n      destination: origin2,\n      travelMode: google.maps.TravelMode.DRIVING,\n    };\n    \n    this.geocode.directions.route(request, async (response, status) => {\n      if (status === 'OK') {\n        this.direction = response;\n        this.distance = response.routes[0].legs[0].distance.value;\n        this.bounds = response.routes[0].bounds;\n        this.price = await this.database.getPriceEstimate(this.distance);\n        this.duration = response.routes[0].legs[0].duration.text;\n\n        await this.createAndAddMarkers(this.LatLng, this.D_LatLng);\n\n        // Call getDistanceAndDirectionsDriver after this part is successful\n        await this.getDistanceAndDirectionsDriver();\n      } else {\n        console.error('Direction ERROR:', response);\n        this.overlay.showAlert('Check Your Network', JSON.stringify(response));\n      }\n    });\n  } else {\n    this.overlay.showAlert('Drag Map', 'Drag the map and stop on your required destination');\n    console.error('D_LatLng or D_LatLng.lat is undefined');\n  }\n}\n\nasync getDistanceAndDirectionsDriver() {\n  console.log(\"getDistanceAndDirectionsDriver called\");\n\n  if (!this.NoDrivers) {\n    console.log(\"Driver LatLng:\", this.DriverLatLng);\n\n    if (this.DriverLatLng) {\n      const origin1 = new google.maps.LatLng(this.LatLng.lat, this.LatLng.lng);\n      const origin2 = new google.maps.LatLng(this.DriverLatLng.lat, this.DriverLatLng.lng);\n\n      const request = {\n        origin: origin1,\n        destination: origin2,\n        travelMode: google.maps.TravelMode.DRIVING,\n      };\n\n      this.geocode.directions.route(request, (response, status) => {\n        if (status === 'OK') {\n          this.D_duration = response.routes[0].legs[0].duration.text;\n          console.log(\"Driver duration:\", this.D_duration);\n        } else {\n          console.error('Direction ERROR:', response);\n          this.overlay.showAlert('Direction ERROR:', JSON.stringify(response));\n        }\n      });\n    } else {\n      console.log(\"DriverLatLng is undefined\");\n    }\n  } else {\n    console.log(\"No drivers available\");\n  }\n}\n\n\n\n\nasync resetLocation(): Promise<void> {\nconsole.log(this.LatLng);\nawait this.map.newMap.setCamera({\n    animate: true,\n    animationDuration: 500,\n    zoom: 15,\n    coordinate: this.LatLng\n});\nthis.showResetLocationButton = false;\n}\n\n\n\nprocessAddressResponse(addressResponse) {\n  console.log(\"processAddressResponse : \" + addressResponse);\n  if (addressResponse) {\n      console.log(addressResponse);\n      this.actualDestination = this.map.actualLocation;\n      const results = addressResponse.results;\n\n      if (results && results.length > 1 && results[1].geometry && results[1].geometry.location) {\n          this.D_LatLng = {\n              lat: results[1].geometry.location.lat,\n              lng: results[1].geometry.location.lng\n          };\n\n          const addressComponents = results[1].address_components;\n          if (addressComponents && addressComponents.length > 1) {\n              this.destinationAddress = `${addressComponents[0].long_name} ${addressComponents[1].long_name}`;\n              console.log(\"this is it \" + this.destinationAddress);\n          } else {\n              console.log('Address components are missing or incomplete.');\n              this.destinationAddress = 'Unknown address';\n          }\n      } else {\n          console.log('Results are missing or incomplete.');\n          this.D_LatLng = { lat: null, lng: null };\n          this.destinationAddress = 'Unknown location';\n      }\n  } else {\n      console.log('Failed to fetch address.');\n      this.D_LatLng = { lat: null, lng: null };\n      this.destinationAddress = 'Failed to fetch address';\n  }\n}\n\n\nasync UpdateCarMarker(elements: Drivers[]) {\n  console.log('Elements to update car markers:', elements);\n\n  const bounds = new google.maps.LatLngBounds();\n\n  // Create a map of driver IDs to driver elements for quick lookup\n  const driverMap = new Map(elements.map(element => [element.Driver_id, element]));\n\n  // Track markers to keep and update\n  const updatedMarkers: { id: string, marker: any }[] = [];\n\n  // Remove markers that are not needed and update positions\n  for (const { id, marker } of this._carmarkers) {\n    const driver = driverMap.get(id);\n    if (!driver || !driver.onlineState) {\n      console.log(`Removing marker for driver ID: ${id}`);\n      await this.map.newMap.removeMarker(marker); // Remove the marker from the map\n    } else if (driver.Driver_lat !== undefined && driver.Driver_lng !== undefined) {\n      const latlng = { lat: driver.Driver_lat, lng: driver.Driver_lng };\n      // Remove old marker and add a new one with updated position\n      await this.map.newMap.removeMarker(marker);\n     // updatedMarkers.push({ id, marker: newMarker });\n      bounds.extend(latlng);\n      console.log(`Updated marker for driver ID: ${id}`);\n    } else {\n      console.error('Invalid driver coordinates:', driver);\n    }\n  }\n\n  // Add new markers for drivers that are online and not in the existing markers\n  for (const element of elements) {\n    if (element.onlineState) {\n      const existingMarkerIndex = updatedMarkers.findIndex(({ id }) => id === element.Driver_id);\n      if (existingMarkerIndex === -1 && element.Driver_lat !== undefined && element.Driver_lng !== undefined) {\n        const latlng = { lat: element.Driver_lat, lng: element.Driver_lng };\n        console.log(`Adding new marker for driver ID: ${element.Driver_id} at`, latlng);\n        try {\n          // const marker = await this.map.newMap.addMarker({\n          //   coordinate: latlng,\n          //   iconUrl: 'https://i.ibb.co/KDy365b/hatchback.png',\n          //   title: 'Driver',\n          //   iconSize: { width: 30, height: 30 }\n          // });\n\n          // if (marker) {\n          //   updatedMarkers.push({ id: element.Driver_id, marker });\n          //   bounds.extend(latlng);\n          // }\n        } catch (error) {\n          console.error('Error adding marker:', error);\n        }\n      }\n    }\n  }\n\n  // Update the _carmarkers array with the updated markers\n  this._carmarkers = updatedMarkers;\n\n  // Center the map around the car markers if there are any markers\n  if (updatedMarkers.length > 0) {\n    const mapDim = {\n      height: this.mapRef.nativeElement.offsetHeight,\n      width: this.mapRef.nativeElement.offsetWidth\n    };\n\n    const minZoom = 5; // Define your minimum zoom level\n    const maxZoom = 18; // Define your maximum zoom level\n    \n    let zoomLevel = await this.map.getBoundsZoomLevel(bounds, mapDim);\n    \n    // Constrain the zoom level within the min and max range\n    zoomLevel = Math.max(minZoom, Math.min(maxZoom, zoomLevel));\n    \n    console.log('Setting camera with zoom level:', zoomLevel);\n    \n    await this.map.newMap.setCamera({\n      animate: true,\n      animationDuration: 500,\n      zoom: zoomLevel,\n      coordinate: bounds.getCenter()\n    });\n\n    this.map.newMap.fitBounds(bounds);\n      } else {\n    console.log('No markers to display on the map.');\n  }\n}\n\n\n\nasync GoHome() {\n  await this.map.newMap.enableCurrentLocation(true);\n  this.current_Request_Number = 0;\n  this.stopPolling = false;\n  this.price = null;\n  this.EnterBookingStage();\n  await this.map.newMap.setCamera({\n      animate: true,\n      animationDuration: 500,\n      zoom: 15,\n      coordinate: this.LatLng\n  });\n}\n\nasync GotoSupport() {\n  await this.nav.navigateForward('support');\n}\n\n\nasync ReturnHome() {\n  await this.ResetState();\n  this.EnterBookingStage();\n  this.stopPolling = false;\n  await this.map.newMap.setCamera({\n      animate: true,\n      animationDuration: 500,\n      zoom: 15,\n      coordinate: this.LatLng\n  });\n}\n\nasync CancelRide() {\n  try {\n    this.overlay.showLoader('Cancelling your ride...');\n    await this.clearPrevMarkers();\n    await this.clearPolyline(this.newPoly);\n\n    this.unsubscribe();\n    this.numCalls.unsubscribe();\n    this.riderCleared = true;\n    await this.database.cancelRide(this.requestID);\n    await this.map.newMap.enableCurrentLocation(true);\n    this.current_Request_Number = 0;\n    this.price = null;\n    this.EnterBookingStage();\n    this.overlay.hideLoader();\n    await this.map.newMap.setCamera({\n      animate: true,\n      animationDuration: 500,\n      zoom: 15,\n      coordinate: this.LatLng\n    });\n    await this.clearRideState();\n  } catch (error) {\n    this.overlay.hideLoader();\n    console.error('Error cancelling ride:', error);\n    this.overlay.showAlert('Error', 'Failed to cancel ride. Please try again.');\n  }\n}\n\nasync ClearRide() {\n  try {\n    const user = this.auth.currentUser;\n    if (user) {\n      const riderDocRef = doc(this.firestore, 'Riders', user.uid);\n      await updateDoc(riderDocRef, {\n        currentRequestId: null\n      });\n    }\n  } catch (error) {\n    console.error('Error clearing ride state:', error);\n  }\n\n  this.EnterBookingStage();\n  await this.clearPrevMarkers();\n  await this.clearPolyline(this.newPoly);\n  this.newPoly = null;\n\n  await this.map.newMap.enableCurrentLocation(true);\n  this.current_Request_Number = 0;\n  this.price = null;\n  await this.map.newMap.setCamera({\n    animate: true,\n    animationDuration: 500,\n    zoom: 15,\n    coordinate: this.LatLng,\n    bearing: 0\n  });\n}\n\nasync CallDriver() {\n  // Implement CallDriver logic\n}\n\n\n// Interval in milliseconds for updating the route\nUPDATE_INTERVAL = 10000; // Update every 10 seconds\n\nasync handleDriverToRider(driverLatLng, riderLatLng) {\n  const markerSize = { width: 30, height: 30 };\n  const iconAnchor = { x: 15, y: 30 }; // Center bottom of the icon\n\n  try {\n    // Cancel any existing route update subscription first\n    if (this.routeUpdateSubscription) {\n      this.routeUpdateSubscription.unsubscribe();\n      this.routeUpdateSubscription = null;\n    }\n    \n    // Check if map is initialized, if not initialize it\n    if (!this.map.newMap) {\n      console.log('Map not initialized, initializing now...');\n      await this.initializeMap();\n    }\n    \n    // Thoroughly clean up previous visual elements\n    await this.clearPrevMarkers();\n    await this.clearAllPolylines();\n    \n    // Use the unified height method and ensure proper positioning\n    this.setMapContainerHeight(20);\n    \n    // Add driver marker at the starting position with adjusted z-index\n    const driverMarker = await this.map.newMap.addMarker({\n      coordinate: driverLatLng,\n      iconUrl: 'assets/icon/car.png',\n      title: 'Driver',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      zIndex: 10 // Ensure marker appears above polylines\n    });\n    this.driver_marker = driverMarker;\n\n    // Add rider marker with higher z-index\n    const riderMarker = await this.map.newMap.addMarker({\n      coordinate: riderLatLng,\n      iconUrl: this.database.user?.photoURL || 'assets/icon/person.png',\n      title: 'Rider',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      zIndex: 11 // Higher than driver marker\n    });\n    this.rider_marker = riderMarker;\n\n    // Function to update route, duration, and distance\n    const updateRoute = async () => {\n        const request = {\n          origin: driverLatLng,\n        destination: riderLatLng,\n          travelMode: google.maps.TravelMode.DRIVING,\n        };\n\n        this.geocode.directions.route(request, async (response, status) => {\n          if (status === 'OK') {\n            const path = response.routes[0].overview_path.map(latlng => ({\n              lat: latlng.lat(),\n              lng: latlng.lng()\n            }));\n            this.duration = response.routes[0].legs[0].duration.text;\n            this.distance = response.routes[0].legs[0].distance.text;\n\n            console.log(`Duration: ${this.duration}, Distance: ${this.distance}`);\n\n            const locs = [\n              { geoCode: { latitude: driverLatLng.lat, longitude: driverLatLng.lng } },\n            { geoCode: { latitude: riderLatLng.lat, longitude: riderLatLng.lng } },\n            ];\n\n            const center = this.map.calculateCenter(locs);\n\n            const bounds = new google.maps.LatLngBounds();\n            bounds.extend(new google.maps.LatLng(driverLatLng.lat, driverLatLng.lng));\n          bounds.extend(new google.maps.LatLng(riderLatLng.lat, riderLatLng.lng));\n    \n            const availableHeight = this.mapRef.nativeElement.offsetHeight;\n    \n            // Prepare map dimensions for calculating zoom level\n            const mapDim = {\n              height: availableHeight,\n              width: this.mapRef.nativeElement.offsetWidth,\n            };\n    \n            // Calculate zoom level\n            const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\n    \n            // Manually set zoom level if needed\n            const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\n    \n          await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(driverLatLng, riderLatLng));\n    \n          // Clear existing polyline before drawing a new one\n          await this.clearAllPolylines();\n          await this.addPolyline(driverLatLng, riderLatLng);\n            \n            // Clear any existing animated marker before starting a new animation\n            if (this.animatedMarker) {\n              await this.map.newMap.removeMarker(this.animatedMarker);\n              this.animatedMarker = null;\n            }\n            \n          // Animate the driver marker along the path to the rider\n            await this.animateMarker(this.driver_marker, path, 'assets/icon/car.png');\n          } else {\n            console.error('Direction ERROR:', response);\n            this.overlay.showAlert('Direction ERROR', JSON.stringify(response));\n          }\n        });\n    };\n\n    // Start updating the route periodically\n    const routeUpdate$ = interval(this.UPDATE_INTERVAL).pipe(\n      switchMap(() => updateRoute())\n    );\n\n    // Subscribe to the interval observable to start updating\n    this.routeUpdateSubscription = routeUpdate$.subscribe();\n\n  } catch (error) {\n    console.error('Error handling driver to rider:', error);\n  }\n}\n\n// Update clearPolyline to handle null map\nasync clearPolyline(polylineId) {\n  if (!polylineId || !this.map?.newMap) return;\n  \n  try {\n    await this.map.newMap.removePolylines(polylineId);\n  } catch (error) {\n    console.error('Error clearing polyline:', error);\n  }\n}\n\n\nasync handleRiderToDestination(driverLatLng, destinationLatLng) {\n  const markerSize = { width: 30, height: 30 };\n  const iconAnchor = { x: 10, y: 0 }; // Center bottom of the icon\n\n  try {\n    // Cancel any existing route update subscription first\n    if (this.routeUpdateSubscription) {\n      this.routeUpdateSubscription.unsubscribe();\n      this.routeUpdateSubscription = null;\n    }\n    \n    // Check if map is initialized, if not initialize it\n    if (!this.map.newMap) {\n      console.log('Map not initialized, initializing now...');\n      await this.initializeMap();\n    }\n    \n    // Reset map position and apply proper height first\n    this.mapRef.nativeElement.style.top = '0';\n    this.setMapHeightHandleDrivertoDestination();\n    \n    // Thoroughly clean up previous visual elements\n    await this.clearPrevMarkers();\n    await this.clearAllPolylines();\n    \n    // Update driver marker to driver's current position\n    const driverMarker = await this.map.newMap.addMarker({\n      coordinate: driverLatLng,\n      iconUrl: 'assets/icon/car.png',\n      title: 'Driver',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      iconOrigin: { x: 0, y: 0 },\n      zIndex: 10, // Higher z-index to appear above polyline\n    });\n    this.driver_marker = driverMarker;\n\n    // Add destination marker\n    const destinationMarker = await this.map.newMap.addMarker({\n      coordinate: destinationLatLng,\n      iconUrl: 'assets/icon/flag.png',\n      title: 'Destination',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      iconOrigin: { x: 0, y: 0 },\n      zIndex: 11, // Higher z-index than driver marker\n    });\n    this.destinationMarker = destinationMarker;\n\n    // Function to update route, duration, and distance\n    const updateRoute = async () => {\n        const request = {\n          origin: driverLatLng,\n          destination: destinationLatLng,\n          travelMode: google.maps.TravelMode.DRIVING,\n        };\n\n        this.geocode.directions.route(request, async (response, status) => {\n          if (status === 'OK') {\n            const path = response.routes[0].overview_path.map(latlng => ({\n              lat: latlng.lat(),\n              lng: latlng.lng()\n            }));\n            this.duration = response.routes[0].legs[0].duration.text;\n            this.distance = response.routes[0].legs[0].distance.text;\n\n            console.log(`Duration: ${this.duration}, Distance: ${this.distance}`);\n\n            const locs = [\n              { geoCode: { latitude: driverLatLng.lat, longitude: driverLatLng.lng } },\n              { geoCode: { latitude: destinationLatLng.lat, longitude: destinationLatLng.lng } },\n            ];\n\n            const center = this.map.calculateCenter(locs);\n\n            const bounds = new google.maps.LatLngBounds();\n            bounds.extend(new google.maps.LatLng(driverLatLng.lat, driverLatLng.lng));\n            bounds.extend(new google.maps.LatLng(destinationLatLng.lat, destinationLatLng.lng));\n    \n            const availableHeight = this.mapRef.nativeElement.offsetHeight;\n    \n            // Prepare map dimensions for calculating zoom level\n            const mapDim = {\n              height: availableHeight,\n              width: this.mapRef.nativeElement.offsetWidth,\n            };\n    \n            // Calculate zoom level\n            const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\n    \n            // Manually set zoom level if needed\n            const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\n    \n            // Set the camera to focus on the center point with appropriate zoom level\n            await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(driverLatLng, destinationLatLng));\n    \n          // Clear existing polyline before drawing a new one\n          await this.clearAllPolylines();\n            await this.addPolyline(driverLatLng, destinationLatLng);\n            \n            // Clear any existing animated marker before starting a new animation\n            if (this.animatedMarker) {\n              await this.map.newMap.removeMarker(this.animatedMarker);\n              this.animatedMarker = null;\n            }\n            \n            // Animate the driver marker along the path to the destination\n            await this.animateMarker(this.driver_marker, path, 'assets/icon/car.png');\n          } else {\n            console.error('Direction ERROR:', response);\n            this.overlay.showAlert('Direction ERROR', JSON.stringify(response));\n          }\n        });\n    };\n\n    // Start updating the route periodically\n    const routeUpdate$ = interval(this.UPDATE_INTERVAL).pipe(\n      switchMap(() => updateRoute())\n    );\n\n    // Subscribe to the interval observable to start updating\n    this.routeUpdateSubscription = routeUpdate$.subscribe();\n\n  } catch (error) {\n    console.error('Error handling rider to destination:', error);\n  }\n}\n\nasync addPolyline(loc: { lat: number, lng: number }, des: { lat: number, lng: number }) {\n  try {\n    const polylineColor = \"#007bff\";\n    const polylines: Polyline[] = [\n      {\n        path: [\n          { lat: loc.lat, lng: loc.lng },\n          { lat: des.lat, lng: des.lng }\n        ],\n        strokeColor: polylineColor,\n        strokeWeight: 8,\n        geodesic: true\n      }\n    ];\n    const addedPolylines = await this.map.newMap.addPolylines(polylines);\n    if (Array.isArray(addedPolylines) && addedPolylines.length > 0) {\n      this.newPoly = addedPolylines; // Change to assign the entire array\n      console.log('Polylines added:', this.newPoly);\n      return this.newPoly;\n    } else {\n      throw new Error('Failed to add polyline: Unexpected response format');\n    }\n  } catch (e) {\n    console.error('Error Adding Polyline: ', e);\n    throw e; // Re-throw the error to be handled by the caller\n  }\n}\n\nasync createAndAddMarkers(loc, des) {\n  const markerSize = { width: 30, height: 30 };\n  const iconAnchor = { x: 10, y: 0 }; // Center bottom of the icon\n\n  try {\n    this.map.newMap.disableTouch();\n\n    // Add start marker\n    this.marker1 = await this.map.newMap.addMarker({\n      coordinate: loc,\n      iconUrl: 'assets/icon/point.png',\n      title: 'Start',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      iconOrigin: { x: 1, y: 0 },\n    });\n\n    // Add destination marker\n    this.marker2 = await this.map.newMap.addMarker({\n      coordinate: des,\n      iconUrl: 'assets/icon/flag.png',\n      title: 'Destination',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      iconOrigin: { x: 1, y: 0 },\n    });\n\n    // Calculate the center point between the start and destination\n    const locs = [\n      { geoCode: { latitude: loc.lat, longitude: loc.lng } },\n      { geoCode: { latitude: des.lat, longitude: des.lng } },\n    ];\n\n    const center = this.map.calculateCenter(locs);\n\n    // Calculate the bounds\n    const bounds = new google.maps.LatLngBounds();\n    bounds.extend(new google.maps.LatLng(loc.lat, loc.lng));\n    bounds.extend(new google.maps.LatLng(des.lat, des.lng));\n\n    // Set map height before calculating zoom level\n    this.setMapHeight();\n    const availableHeight = this.mapRef.nativeElement.offsetHeight;\n\n    // Prepare map dimensions for calculating zoom level\n    const mapDim = {\n      height: availableHeight,\n      width: this.mapRef.nativeElement.offsetWidth,\n    };\n\n    // Calculate zoom level\n    const zoomLevel = this.map.getBoundsZoomLevel(bounds, mapDim);\n\n    // Manually set zoom level if needed\n    const adjustedZoomLevel = zoomLevel - 1; // Adjust as necessary\n\n    // Set the camera to focus on the center point with appropriate zoom level\n    await this.map.setCameraToLocation({ lat: center.latitude, lng: center.longitude }, adjustedZoomLevel, this.map.calculateBearing(loc, des));\n\n    // Add polyline for the route\n    const polylineColor = \"#007bff\";\n    const polylines: Polyline[] = [\n      {\n        path: [\n          { lat: loc.lat, lng: loc.lng },\n          { lat: des.lat, lng: des.lng }\n        ],\n        strokeColor: polylineColor,\n        strokeWeight: 8,\n        geodesic: true\n      }\n    ];\n\n    // Add polyline to the map\n    this.newPoly = await this.map.newMap.addPolylines(polylines);\n  } catch (error) {\n    console.error('Error creating and adding markers:', error);\n  }\n}\n\n\n\n// Update the animateMarker method to properly handle cleanup\nasync animateMarker(marker, path, iconUrl) {\n  const markerSize = { width: 50, height: 50 };\n  const iconAnchor = { x: 25, y: 50 }; // Center bottom of the icon\n  \n  // Remove any existing animated marker\n  if (this.animatedMarker) {\n    await this.map.newMap.removeMarker(this.animatedMarker);\n    this.animatedMarker = null;\n  }\n\n  let lastMarker = null;\n  \n  for (let i = 0; i < path.length; i++) {\n    // Remove previous animation step marker if it exists\n    if (lastMarker) {\n      await this.map.newMap.removeMarker(lastMarker);\n    }\n    \n    // Remove the original marker for the first frame of animation\n    if (i === 0) {\n      await this.map.newMap.removeMarker(marker);\n    }\n    \n    const coordinate = path[i] instanceof google.maps.LatLng ? \n                     { lat: path[i].lat(), lng: path[i].lng() } : \n                     { lat: path[i].lat, lng: path[i].lng };\n                     \n    lastMarker = await this.map.newMap.addMarker({\n      coordinate: coordinate,\n      iconUrl: iconUrl,\n      title: 'Moving Marker',\n      iconSize: markerSize,\n      iconAnchor: iconAnchor,\n      iconOrigin: { x: 0, y: 0 },\n      zIndex: 20, // Higher than other markers\n    });\n    \n    await new Promise(resolve => setTimeout(resolve, 100)); // Adjust the interval as needed\n  }\n\n  // Store the last position of the animated marker\n  this.animatedMarker = lastMarker;\n}\n\n\n\n\nasync ShowDriverInfoPop() {\n  const alert = await this.alert.create({\n    header: 'Driver Information',\n    message: `\n      <div style=\"text-align: center;\">\n        <h2 style=\"font-size: 1.2em; margin-bottom: 0.5em;\">Car Name: ${this.carname}</h2>\n        <div style=\"margin: 10px 0;\">\n          <img src=\"${this.driverImage}\" alt=\"Driver Image\" style=\"width: 60px; height: 60px; border-radius: 50%;\">\n        </div>\n        <p><strong>Duration Apart:</strong> ${this.driver_duration_apart} minutes</p>\n        <p><strong>Driver ID:</strong> ${this.driver_ID}</p>\n        <p><strong>Number of Seats:</strong> ${this.driver_number_of_seats}</p>\n        <p><strong>Driver Location:</strong> (${this.DriverLatLng.lat}, ${this.DriverLatLng.lng})</p>\n      </div>\n    `,\n    buttons: ['OK']\n  });\n\n  await alert.present();\n}\n\n\n// State management methods\nEnterBookingStage() {\n  this.setStage(this.STAGES.BOOKING);\n}\n\nEnterMapPinStage() {\n  this.setStage(this.STAGES.MAP_PIN);\n}\n\nEnterConfirmStage() {\n  this.setStage(this.STAGES.CONFIRM);\n}\n\nEnterSearchingStage() {\n  this.setStage(this.STAGES.SEARCHING);\n}\n\nEnterNoDriverStage() {\n  this.setStage(this.STAGES.NO_DRIVER);\n}\n\nEnterTrackingStage() {\n  this.setStage(this.STAGES.TRACKING);\n}\n\nEnterDrivingToDestinationStage() {\n  this.setStage(this.STAGES.DRIVING);\n}\n\nprivate setStage(stage: string) {\n  // Reset all stages first\n  this.bookingStage = false;\n  this.confirmStage = false;\n  this.trackingStage = false;\n  this.searchingStage = false;\n  this.drivingToDestinationStage = false;\n  this.noDriverStage = false;\n  this.mapPinStage = false;\n\n  // Set the appropriate stage without calling Enter methods\n  switch (stage) {\n    case this.STAGES.BOOKING:\n      this.bookingStage = true;\n      break;\n    case this.STAGES.CONFIRM:\n      this.confirmStage = true;\n      break;\n    case this.STAGES.TRACKING:\n      this.trackingStage = true;\n      break;\n    case this.STAGES.SEARCHING:\n      this.searchingStage = true;\n      break;\n    case this.STAGES.DRIVING:\n      this.drivingToDestinationStage = true;\n      break;\n    case this.STAGES.NO_DRIVER:\n      this.noDriverStage = true;\n      break;\n    case this.STAGES.MAP_PIN:\n      this.mapPinStage = true;\n      break;\n  }\n}\n\nprivate getCurrentStage(): string {\n  if (this.bookingStage) return this.STAGES.BOOKING;\n  if (this.confirmStage) return this.STAGES.CONFIRM;\n  if (this.trackingStage) return this.STAGES.TRACKING;\n  if (this.searchingStage) return this.STAGES.SEARCHING;\n  if (this.drivingToDestinationStage) return this.STAGES.DRIVING;\n  if (this.noDriverStage) return this.STAGES.NO_DRIVER;\n  if (this.mapPinStage) return this.STAGES.MAP_PIN;\n  return this.STAGES.BOOKING; // default\n}\n\nngOnInit() {\n  // ... existing code ...\n  \n  // Check for \"book again\" navigation state\n  const navigation = this.router.getCurrentNavigation();\n  if (navigation?.extras.state) {\n    const state = navigation.extras.state;\n    console.log('Navigation state received:', state);\n    \n    if (state['bookAgain']) {\n      // Wait for the map to be ready\n      this.mapLoadedSubscription = this.mapLoadedSubject.subscribe(loaded => {\n        if (loaded) {\n          setTimeout(() => {\n            console.log('Processing book again data:', state);\n            this.processBookAgainData(state);\n          }, 1000); // Small delay to ensure map is fully ready\n        }\n      });\n    }\n  }\n  \n  // ... existing code ...\n}\n\nasync processBookAgainData(state) {\n  try {\n    console.log('Setting up rebooking with data:', state);\n    \n    // Set pickup location\n    if (state.pickup && state.pickup.address) {\n      this.locationAddress = state.pickup.address;\n      \n      if (state.pickup.lat && state.pickup.lng) {\n        this.LatLng = {\n          lat: state.pickup.lat,\n          lng: state.pickup.lng\n        };\n        \n        // Add location marker\n        await this.addLocationMarker(this.LatLng);\n      } else {\n        // If no coordinates, geocode the address\n        const coords = await this.geocodeService.geocodeAddress(state.pickup.address);\n        if (coords) {\n          this.LatLng = coords;\n          await this.addLocationMarker(coords);\n        }\n      }\n    }\n    \n    // Set destination\n    if (state.destination && state.destination.address) {\n      this.destinationAddress = state.destination.address;\n      \n      if (state.destination.lat && state.destination.lng) {\n        this.D_LatLng = {\n          lat: state.destination.lat,\n          lng: state.destination.lng\n        };\n        \n        // Add destination marker\n        await this.addDestinationMarker(this.D_LatLng);\n      } else {\n        // If no coordinates, geocode the address\n        const coords = await this.geocodeService.geocodeAddress(state.destination.address);\n        if (coords) {\n          this.D_LatLng = coords;\n          await this.addDestinationMarker(coords);\n        }\n      }\n    }\n    \n    // If both locations are set, calculate route\n    if (this.LatLng && this.D_LatLng) {\n      await this.drawRoute();\n      await this.calculatePrice();\n      this.EnterConfirmStage();\n    }\n    \n  } catch (error) {\n    console.error('Error processing book again data:', error);\n    // Show error toast\n    const toast = await this.toastCtrl.create({\n      message: 'Could not load previous ride data. Please try again.',\n      duration: 3000,\n      position: 'bottom',\n      color: 'danger'\n    });\n    toast.present();\n  }\n}\n\n}","<ion-header class=\"ion-no-border\" [translucent]=\"true\" style=\"position: relative; z-index: 1000;\">\n  <!--destination bar-->\n  <ion-toolbar class=\"ion-padding\" *ngIf=\"confirmStage\">\n    <ion-buttons slot=\"start\">\n      <ion-button shape=\"round\" (click)=\"goBackToAutoComplete()\">\n        <ion-icon slot=\"icon-only\" name=\"arrow-back\" color=\"tertiary\"></ion-icon> \n      </ion-button>\n    </ion-buttons>\n    <ion-title> Cancel </ion-title>\n    <ion-buttons slot=\"end\">\n      <ion-item fill=\"outline\" class=\"duration\" color=\"primary\" lines=\"none\">\n        <ion-icon slot=\"icon-only\" name=\"flag\" color=\"primary\"></ion-icon>\n        <ion-label *ngIf=\"duration\" color=\"primary\"><h1>{{duration}}</h1></ion-label>\n      </ion-item>\n    </ion-buttons>\n  </ion-toolbar>\n\n  \n  <ion-item lines=\"none\" color='light' class=\"main-buttons ion-no-padding\" class='top_bar'  (click)=\"goBackToAutoComplete()\" *ngIf=\"confirmStage\">\n      <ion-icon slot=\"start\" color='primary' name=\"pencil\"></ion-icon>\n      <ion-label color='primary' >{{destinationAddress}}</ion-label>\n  </ion-item>\n  \n\n  <!--menu button-->\n  <ion-fab *ngIf=\"bookingStage\" vertical=\"top\" horizontal=\"start\" style=\"top: 35px;\">\n    <ion-fab-button color=\"light\">\n      <ion-menu-button color=\"primary\"></ion-menu-button>\n    </ion-fab-button>\n  </ion-fab>\n\n  <!--sos button-->\n  <ion-fab *ngIf=\"bookingStage\" vertical=\"top\" horizontal=\"end\" (click)=\"GotoSupport()\" style=\"top: 35px;\">\n    <ion-fab-button color=\"light\">\n      <ion-icon color=\"primary\" name=\"chatbubble-ellipses\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n\n   <!--back button if map Pin-->\n   <ion-fab *ngIf=\"mapPinStage\" vertical=\"top\" (click)=\"goBackToAutoComplete()\" horizontal=\"start\" style=\"top: 35px;\">\n    <ion-fab-button color=\"light\">\n      <ion-icon name=\"arrow-back\" color=\"primary\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n\n  <!--Search Bar-->\n\n  <!-- Driver arrival time header -->\n  <ion-toolbar *ngIf=\"trackingStage\" class=\"ion-text-center\">\n    <ion-title>Driver Arrives in {{duration}}</ion-title>\n  </ion-toolbar>\n  \n  <!-- Destination arrival time header -->\n  <ion-toolbar *ngIf=\"drivingToDestinationStage\" class=\"ion-text-center\">\n    <ion-title>Arrival in {{duration}}</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n\n<!--Capacitor Google Map-->\n\n<ion-content [fullscreen]=\"true\" scroll-y=\"false\">\n  \n  <capacitor-google-maps #map style=\"z-index: 1;\">\n   \n  </capacitor-google-maps>\n\n\n  <ion-fab *ngIf=\"bookingStage && showResetLocationButton\" vertical=\"bottom\" horizontal=\"end\" style=\"bottom: 130px;\">\n    <ion-fab-button color=\"light\" (click)=\"resetLocation()\">\n      <ion-icon name=\"locate\"></ion-icon>\n    </ion-fab-button>\n  </ion-fab>\n\n  \n</ion-content>\n\n\n\n<ion-fab class=\"centerPin\" *ngIf=\"mapPinStage\" vertical=\"center\" horizontal=\"center\" style=\"z-index: 1000;\">\n    <ion-avatar>\n      <ion-img src=\"../../assets/icon/pin.png\"></ion-img>\n    </ion-avatar>\n</ion-fab>\n\n  <ion-footer  [translucent]=\"true\" class=\"ion-no-border\" style=\"position: relative; z-index: 1000;\">\n    <div #bottomBar>\n    <ion-row>\n\n\n      <!--where to bar and button-->\n      <ion-list class=\"bottomItems shadow-top\" *ngIf=\"bookingStage\" lines=\"full\">\n  \n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom \">\n          <ion-button \n          [disabled]=\"!locationAddress\" \n          shape=\"round\" \n          class=\"main-button\" \n          size=\"large\" \n          type=\"submit\" \n          (click)=\"showAutocompleteModal()\" \n          expand=\"block\">\n          <ion-icon slot=\"start\" name=\"search\" color=\"primary\"></ion-icon>\n          <ion-label>{{ locationAddress ? 'Where To?' : 'Waiting for address...' }}</ion-label>\n        </ion-button>\n        \n        </ion-item-group>\n\n      </ion-list>\n\n      <!--Map Pin Choose Bar-->\n      <ion-list class='bottomItems shadow-top' [hidden]=\"!mapPinStage\" lines=\"full\">\n\n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\n          <ion-button shape=\"round\" size=\"large\" type=\"submit\" (click)=\"getDistanceAndDirections()\" expand=\"block\">\n            <ion-icon slot=\"end\" name=\"arrow-forward\"></ion-icon>\n            <ion-label>{{destinationAddress}}</ion-label>\n          </ion-button>\n        </ion-item-group>\n\n      </ion-list>\n\n      <!--No driver Found Bar-->\n      \n      <ion-list class='bottomItems shadow-top' *ngIf=\"noDriverStage\" lines=\"none\">\n        <ion-list-header>\n          <ion-item style=\"margin:0 auto;\">\n              <img src=\"../../assets/imgs/No connection-pana.svg\">\n          </ion-item>\n            \n         </ion-list-header>\n       <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\n        \n               <ion-button shape=\"round\"  class='main-button' size=\"large\" type=\"submit\" color=\"primary\" (click)=\"ReturnHome()\" expand=\"block\">\n                 <ion-icon slot=\"start\" name=\"arrow-back\"></ion-icon>\n                 <ion-label> No Drivers Here </ion-label>\n               </ion-button>\n            \n       </ion-item-group>\n\n     </ion-list>\n\n      <!--Car type, payment, confirmation and Selection Bar-->\n      <ion-list class='bottomItems shadow-top' *ngIf=\"confirmStage\" lines=\"none\">\n        <!-- Modern card layout -->\n        <div class=\"ride-confirmation-card\">\n          <!-- Vehicle info with price section -->\n          <div *ngIf=\"price\" class=\"ride-details\">\n            <div class=\"vehicle-info\" (click)=\"ShowDriverInfoPop()\">\n              <ion-avatar>\n                <ion-img src=\"../../assets/icon/hatchback.png\"></ion-img>\n              </ion-avatar>\n              <div class=\"vehicle-details\">\n                <h2>{{carname}} <ion-icon name=\"information-circle\" color=\"primary\"></ion-icon></h2>\n                <p class=\"vehicle-stats\">\n                  <span><ion-icon name=\"time\" color=\"primary\"></ion-icon> {{D_duration}}</span>\n                  <span><ion-icon name=\"person\" color=\"primary\"></ion-icon> {{driver_number_of_seats}} seats</span>\n                </p>\n              </div>\n              <div class=\"price-tag\">\n                <h2>${{price}}</h2>\n                <p class=\"original-price\"><del>${{price*2}}</del></p>\n              </div>\n            </div>\n          </div>\n          \n          <!-- Loading skeleton for ride details -->\n          <div *ngIf=\"!price\" class=\"ride-details skeleton\">\n            <div class=\"vehicle-info\">\n              <ion-avatar>\n                <ion-skeleton-text [animated]=\"true\"></ion-skeleton-text>\n              </ion-avatar>\n              <div class=\"vehicle-details\">\n                <h2><ion-skeleton-text [animated]=\"true\" style=\"width: 130px\"></ion-skeleton-text></h2>\n                <p class=\"vehicle-stats\">\n                  <ion-skeleton-text [animated]=\"true\" style=\"width: 130px\"></ion-skeleton-text>\n                </p>\n              </div>\n              <div class=\"price-tag\">\n                <h2><ion-skeleton-text [animated]=\"true\" style=\"width: 60px\"></ion-skeleton-text></h2>\n                <p><ion-skeleton-text [animated]=\"true\" style=\"width: 60px\"></ion-skeleton-text></p>\n              </div>\n            </div>\n          </div>\n          \n          <!-- Payment method selector -->\n          <div class=\"payment-selector\">\n            <ion-item lines=\"none\">\n              <ion-icon name=\"wallet-outline\" slot=\"start\" color=\"primary\"></ion-icon>\n              <ion-label>Payment Method</ion-label>\n              <ion-select [value]=\"selectedCard\" (ionChange)=\"chooseCard($event)\" interface=\"popover\">\n                <ion-select-option value=\"cash\">\n                  <ion-icon name=\"cash-outline\"></ion-icon> Cash\n                </ion-select-option>\n                <ion-select-option *ngFor=\"let card of savedPaymentMethods\" [value]=\"card.cardId\">\n                  <ion-icon name=\"card-outline\"></ion-icon>  {{card.last4}}\n                </ion-select-option>\n              </ion-select>\n            </ion-item>\n          </div>\n          \n          <!-- Book ride button -->\n          <div class=\"book-button-container\">\n            <ion-button class=\"book-ride-btn\" shape=\"round\" color=\"primary\" size=\"large\" \n                      expand=\"block\" (click)=\"StartRide()\">\n              <ion-icon *ngIf='price' slot=\"start\" name=\"checkmark-sharp\"></ion-icon>\n              <ion-progress-bar color=\"light\" *ngIf='!price' type=\"indeterminate\"></ion-progress-bar>\n              <ion-label *ngIf='price'>Book Ride</ion-label>\n            </ion-button>\n          </div>\n        </div>\n      </ion-list>\n\n\n<!-- Connecting to driver bar-->\n      <ion-list class='bottomItems shadow-top' *ngIf=\"searchingStage\" lines=\"none\">\n         <ion-list-header>\n          <ion-item>\n            <ion-avatar slot=\"start\">\n              <ion-img [src]=\"currentDriver.Driver_imgUrl\"></ion-img>\n            </ion-avatar>\n            <ion-label>\n\n              <h1>{{currentDriver.Driver_name}}</h1>\n              <p>Arrives In {{duration}}</p>\n\n            </ion-label>\n          </ion-item>\n            \n         </ion-list-header>\n        <ion-item-group class=\"ion-margin-horizontal ion-margin-bottom\">\n\n                <ion-button  fill=\"outline\" shape=\"round\" color=\"danger\"  class='main-button' size=\"small\" type=\"submit\" expand=\"block\" (click)=\"presentCancelRideActionSheet()\">\n                  <ion-label></ion-label>\n                  <ion-icon slot=\"start\" slot=\"icon-only\" name=\"close-sharp\" color=\"danger\"></ion-icon>\n                </ion-button>\n                 \n                <ion-progress-bar color=\"primary\" class=\"ion-padding\" type=\"indeterminate\"></ion-progress-bar>\n\n             \n        </ion-item-group>\n       \n      </ion-list>\n\n\n\n       <!--Driver tracking to user bar (FIXED LAYOUT)-->\n       <ion-list class='bottomItems shadow-top' *ngIf=\"trackingStage\" lines=\"none\">\n         <div class=\"card\">\n           <!-- Car information row -->\n           <ion-item lines=\"none\" class=\"driver-card-item\">\n             <ion-label>\n               <p>{{driverInfo.Driver_car}}.{{driverInfo.Driver_cartype}}</p>\n               <h1>{{driverInfo.Driver_plate}}</h1>\n             </ion-label>\n             \n             <!-- Driver avatar and rating on right side -->\n             <div slot=\"end\" class=\"driver-avatar-container\">\n               <ion-avatar>\n                 <ion-img [src]=\"driverInfo.Driver_imgUrl\"></ion-img>\n               </ion-avatar>\n               <div class=\"driver-rating\">\n                 <ion-icon color=\"warning\" name=\"star\"></ion-icon>\n                 <span>{{driverInfo.Driver_rating}}</span>\n               </div>\n             </div>\n           </ion-item>\n\n           <!-- Driver name row -->\n           <ion-item lines=\"none\" class=\"driver-card-item\">\n             <ion-label>\n               <ion-text color=\"primary\">{{driverInfo.Driver_name}}</ion-text>\n               <p>1,832 rides</p>\n             </ion-label>\n           </ion-item>\n\n           <!-- Payment row -->\n           <ion-item lines=\"none\" class=\"driver-card-item\">\n             <ion-label *ngIf=\"cash\">\n               <h2><ion-icon color='primary' name=\"cash\"></ion-icon> Cash</h2>\n             </ion-label>\n             <ion-label *ngIf=\"!cash\">\n               <h2><ion-icon color='primary' name=\"card\"></ion-icon> Card</h2>\n             </ion-label>\n             \n             <div slot=\"end\" class=\"price-container\">\n               <h1>${{price}}</h1>\n             </div>\n           </ion-item>\n\n           <!-- More options accordion (made more visible) -->\n           <ion-accordion-group class=\"driver-actions-accordion\">\n             <ion-accordion value=\"first\">\n               <ion-item slot=\"header\" class=\"accordion-header\">\n                 <ion-label><h2>More Options</h2></ion-label>\n               </ion-item>\n               <div slot=\"content\" class=\"accordion-content\">\n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"CallDriver()\">\n                   <ion-icon color='primary' slot=\"start\" name=\"person\"></ion-icon>\n                   <ion-label>Contact</ion-label>\n                 </ion-button>\n                 \n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"EnterChat()\">\n                   <ion-icon color='primary' slot=\"start\" name=\"chatbubbles\"></ion-icon>\n                   <ion-label>Chat</ion-label>\n                 </ion-button>\n                 \n                 <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"presentCancelRideActionSheet()\">\n                   <ion-icon color='primary' slot=\"start\" name=\"close\"></ion-icon>\n                   <ion-label>Cancel ride</ion-label>\n                 </ion-button>\n               </div>\n             </ion-accordion>\n           </ion-accordion-group>\n         </div>\n       </ion-list>\n\n\n\n    \n   <!--Rider Picked Up now tracking to destination bar (FIXED LAYOUT)-->\n      <ion-list class='bottomItems shadow-top' *ngIf=\"drivingToDestinationStage\" lines=\"none\">\n        <div class=\"card\">\n          <!-- Car information row -->\n          <ion-item lines=\"none\" class=\"driver-card-item\">\n            <ion-label>\n              <p>{{driverInfo.Driver_car}}.{{driverInfo.Driver_cartype}}</p>\n              <h1>{{driverInfo.Driver_plate}}</h1>\n            </ion-label>\n            \n            <!-- Driver avatar and rating on right side -->\n            <div slot=\"end\" class=\"driver-avatar-container\">\n              <ion-avatar>\n                <ion-img [src]=\"driverInfo.Driver_imgUrl\"></ion-img>\n              </ion-avatar>\n              <div class=\"driver-rating\">\n                <ion-icon color=\"secondary\" name=\"star\"></ion-icon>\n                <span>{{driverInfo.Driver_rating || 5}}</span>\n              </div>\n            </div>\n          </ion-item>\n\n          <!-- Driver name row -->\n          <ion-item lines=\"none\" class=\"driver-card-item\">\n            <ion-label>\n              <ion-text color=\"primary\">{{driverInfo.Driver_name}}</ion-text>\n              <p>1,832 rides</p>\n            </ion-label>\n          </ion-item>\n\n          <!-- Payment row -->\n          <ion-item lines=\"none\" class=\"driver-card-item\">\n            <ion-label *ngIf=\"cash\">\n              <h2><ion-icon color='primary' name=\"cash\"></ion-icon> Cash</h2>\n            </ion-label>\n            <ion-label *ngIf=\"!cash\">\n              <h2><ion-icon color='primary' name=\"card\"></ion-icon> Card</h2>\n            </ion-label>\n            \n            <div slot=\"end\" class=\"price-container\">\n              <h1>${{price}}</h1>\n            </div>\n          </ion-item>\n\n          <!-- Added accordion here too for consistency -->\n          <ion-accordion-group class=\"driver-actions-accordion\">\n            <ion-accordion value=\"first\">\n              <ion-item slot=\"header\" class=\"accordion-header\">\n                <ion-label><h2>More Options</h2></ion-label>\n              </ion-item>\n              <div slot=\"content\" class=\"accordion-content\">\n                <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"CallDriver()\">\n                  <ion-icon color='primary' slot=\"start\" name=\"person\"></ion-icon>\n                  <ion-label>Contact</ion-label>\n                </ion-button>\n                \n                <ion-button shape=\"round\" class='main-button' size=\"large\" expand=\"block\" (click)=\"EnterChat()\">\n                  <ion-icon color='primary' slot=\"start\" name=\"chatbubbles\"></ion-icon>\n                  <ion-label>Chat</ion-label>\n                </ion-button>\n              </div>\n            </ion-accordion>\n          </ion-accordion-group>\n        </div>\n      </ion-list>\n      \n\n\n    </ion-row>\n    </div>\n  </ion-footer>","import { Injectable } from '@angular/core';\r\nimport { Client } from '@googlemaps/google-maps-services-js';\r\nimport { environment } from 'src/environments/environment';\r\nimport { OverlayService } from './overlay.service';\r\nimport { Observable, of } from 'rxjs';\r\nimport { HttpParams, HttpClient } from '@angular/common/http';\r\nimport { catchError, map } from 'rxjs/operators';\r\n\r\ndeclare let google;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GeocodeService {\r\n  service = new google.maps.DistanceMatrixService();\r\n  directions = new google.maps.DirectionsService();\r\n  private readonly apiUrl = 'https://maps.googleapis.com/maps/api';\r\n\r\n  constructor(private client: Client, private overlay: OverlayService, private http: HttpClient) { }\r\n\r\n  getAddress(lat: number, lng: number): Observable<any> {\r\n    const url = `${this.apiUrl}/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('latlng', `${lat},${lng}`)\r\n      .set('key', environment.apiKey);\r\n  \r\n    return this.http.get(url, { params }).pipe(\r\n      map((response: any) => response),\r\n      catchError((error) => {\r\n        console.error('Error in reverse geocoding:', error);\r\n        this.overlay.showAlert('GeoError', error.message);\r\n        return of(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  // Convert the address to lat and lng\r\n  getLatLng(address: string): Observable<any> {\r\n    const url = `${this.apiUrl}/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('address', address)\r\n      .set('key', environment.apiKey);\r\n\r\n    return this.http.get(url, { params }).pipe(\r\n      map((response: any) => response),\r\n      catchError((error) => {\r\n        console.error('Error in geocoding:', error);\r\n        this.overlay.showAlert('GeoError', error.message);\r\n        return of(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  \r\n\r\n  // Get the distance between the origin and destination\r\n  async getDirections(from: string, to: string): Promise<any> {\r\n    try {\r\n      // You can implement the directions request here using google.maps.DirectionsService\r\n    } catch (e) {\r\n      this.overlay.showAlert('GeoError', e);\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  getDistanceMatrix(origin: any, destination: any): Observable<any> {\r\n    const distanceMatrixService = new google.maps.DistanceMatrixService();\r\n    \r\n    return new Observable(observer => {\r\n      distanceMatrixService.getDistanceMatrix({\r\n        origins: [new google.maps.LatLng(origin.lat, origin.lng)],\r\n        destinations: [new google.maps.LatLng(destination.lat, destination.lng)],\r\n        travelMode: google.maps.TravelMode.DRIVING,\r\n      }, (response, status) => {\r\n        if (status === 'OK') {\r\n          observer.next(response);\r\n        } else {\r\n          observer.error(status);\r\n        }\r\n        observer.complete();\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { GoogleMap, Marker } from '@capacitor/google-maps';\r\nimport { environment } from 'src/environments/environment';\r\nimport { GeocodeService } from './geocode.service';\r\nimport { OverlayService } from './overlay.service';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MapService {\r\n  private _map: GoogleMap | null = null;\r\n  \r\n  get newMap(): GoogleMap {\r\n    if (!this._map) {\r\n      throw new Error('Map not initialized');\r\n    }\r\n    return this._map;\r\n  }\r\n\r\n  set newMap(map: GoogleMap) {\r\n    this._map = map;\r\n  }\r\n\r\n  LatLng: { lat: any; lng: any; };\r\n  locationAddress: string = 'Loading..';\r\n  showResetLocationButton: boolean;\r\n  mapPinStage: any;\r\n  D_LatLng: { lat: any; lng: any; };\r\n  actualLocation: any;\r\n  exampleMapId: any;\r\n\r\n  constructor(private overlay: OverlayService, private geocode: GeocodeService, private http: HttpClient) {}\r\n\r\n  async createMap(ref: HTMLElement, coords: { coords: { latitude: number; longitude: number } }) {\r\n    try {\r\n      // Validate coords before using\r\n      const lat = coords?.coords?.latitude || 3.1390; // Default to Kuala Lumpur, Malaysia\r\n      const lng = coords?.coords?.longitude || 101.6869;\r\n      \r\n      // Destroy existing map if it exists\r\n      this._map = await GoogleMap.create({\r\n        id: 'my-cool-map',\r\n        element: ref,\r\n        apiKey: environment.apiKey,\r\n        config: {\r\n          center: {\r\n            lat: lat,\r\n            lng: lng\r\n          },\r\n          zoom: 15,\r\n          styles: [],\r\n          scaleControl: false,\r\n          streetViewControl: false,\r\n          rotateControl: false,\r\n          fullscreenControl: false,\r\n        },\r\n      });\r\n\r\n      this.LatLng = {\r\n        lat: lat,\r\n        lng: lng\r\n      };\r\n\r\n      await Promise.all([\r\n        this._map.enableTrafficLayer(true),\r\n        this._map.enableCurrentLocation(true),\r\n        this._map.setCamera({\r\n          animate: true,\r\n          animationDuration: 500,\r\n          zoom: 15,\r\n          coordinate: this.LatLng\r\n        })\r\n      ]);\r\n\r\n      const address = await this.getAddress(this.LatLng.lat, this.LatLng.lng);\r\n      this.processAddressResponse(address);\r\n\r\n    } catch (error) {\r\n      console.error('Error creating map:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async destroyMap() {\r\n    if (this._map) {\r\n      try {\r\n        await this._map.destroy();\r\n        this._map = null;\r\n      } catch (error) {\r\n        console.error('Error destroying map:', error);\r\n      }\r\n    }\r\n  }\r\n\r\n  private processAddressResponse(address: any) {\r\n    if (address?.results?.length > 0) {\r\n      this.actualLocation = address.results[0].formatted_address;\r\n      \r\n      if (address.results.length > 1) {\r\n        const components = address.results[1].address_components;\r\n        if (components?.length >= 2) {\r\n          this.locationAddress = `${components[0].long_name} ${components[1].long_name}`;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  calculateCenter(points) {\r\n    const latitudes = points.map(p => p.geoCode.latitude);\r\n    const longitudes = points.map(p => p.geoCode.longitude);\r\n  \r\n    const avgLat = latitudes.reduce((a, b) => a + b, 0) / latitudes.length;\r\n    const avgLng = longitudes.reduce((a, b) => a + b, 0) / longitudes.length;\r\n  \r\n    return { latitude: avgLat, longitude: avgLng };\r\n  }\r\n\r\n  async setCameraToLocation(coordinate: { lat: number; lng: number }, zoom: number, bearing: number) {\r\n    if (!this._map) {\r\n      console.error('Map not initialized');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await this._map.setCamera({\r\n        animate: true,\r\n        animationDuration: 500,\r\n        zoom,\r\n        coordinate,\r\n        bearing\r\n      });\r\n    } catch (error) {\r\n      console.error('Error setting camera:', error);\r\n    }\r\n  }\r\n  \r\n  // Add other necessary methods like getAddress here\r\n\r\n  \r\n  \r\n   getBoundsZoomLevel(bounds, mapDim) {\r\n    const WORLD_DIM = { height: 256, width: 256 };\r\n      const ZOOM_MAX = 21;\r\n\r\n      const latRad = lat => {\r\n        const sin = Math.sin((lat * Math.PI) / 180);\r\n        const radX2 = Math.log((1 + sin) / (1 - sin)) / 2;\r\n        return Math.max(Math.min(radX2, Math.PI), -Math.PI) / 2;\r\n      };\r\n\r\n      const zoom = (mapPx, worldPx, fraction) =>\r\n        Math.floor(Math.log(mapPx / worldPx / fraction) / Math.LN2);\r\n\r\n      const ne = bounds.getNorthEast();\r\n      const sw = bounds.getSouthWest();\r\n\r\n      const latFraction = (latRad(ne.lat()) - latRad(sw.lat())) / Math.PI;\r\n\r\n      const lngDiff = ne.lng() - sw.lng();\r\n      const lngFraction = (lngDiff < 0 ? lngDiff + 360 : lngDiff) / 360;\r\n\r\n      const latZoom = zoom(mapDim.height, WORLD_DIM.height, latFraction);\r\n      const lngZoom = zoom(mapDim.width, WORLD_DIM.width, lngFraction);\r\n\r\n      return Math.min(latZoom, lngZoom, ZOOM_MAX);\r\n  }\r\n  \r\n  calculateBearing(start, end) {\r\n    const startLat = start.lat * (Math.PI / 180);\r\n    const startLng = start.lng * (Math.PI / 180);\r\n    const endLat = end.lat * (Math.PI / 180);\r\n    const endLng = end.lng * (Math.PI / 180);\r\n  \r\n    const dLng = endLng - startLng;\r\n    const y = Math.sin(dLng) * Math.cos(endLat);\r\n    const x = Math.cos(startLat) * Math.sin(endLat) - Math.sin(startLat) * Math.cos(endLat) * Math.cos(dLng);\r\n    const bearing = Math.atan2(y, x) * (180 / Math.PI);\r\n  \r\n    return (bearing + 360) % 360;\r\n  }\r\n  async getDirections(from: string, to: string): Promise<any> {\r\n    try {\r\n      const url = `https://maps.googleapis.com/maps/api/directions/json?origin=${from}&destination=${to}&key=${environment.apiKey}`;\r\n      const response = await this.http.get(url).toPromise();\r\n      return response;\r\n    } catch (error) {\r\n      console.error('Error in getting directions:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n getAddress(lat: number, lng: number): Promise<any> {\r\n    const url = `https://maps.googleapis.com/maps/api/geocode/json`;\r\n    const params = new HttpParams()\r\n      .set('latlng', `${lat},${lng}`)\r\n      .set('key', environment.apiKey);\r\n\r\n    return this.http.get(url, { params }).toPromise();\r\n  }\r\n\r\n  // Add the addMarker method to the MapService class\r\n  async addMarker(lat: number, lng: number, title: string): Promise<Marker> {\r\n    try {\r\n      const marker: Marker = {\r\n        coordinate: { lat, lng },\r\n        title,\r\n      };\r\n      await this._map.addMarker(marker);\r\n      return marker;\r\n    } catch (error) {\r\n      console.error('Error adding marker:', error);\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","// src/app/services/network.service.ts\r\n\r\nimport { Injectable } from '@angular/core';\r\nimport { Network } from '@capacitor/network';\r\nimport { BehaviorSubject } from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NetworkService {\r\n  private networkStatus = new BehaviorSubject<boolean>(true);\r\n  networkStatus$ = this.networkStatus.asObservable();\r\n\r\n  constructor() {\r\n    this.initializeNetworkListener();\r\n  }\r\n\r\n  private initializeNetworkListener() {\r\n    Network.addListener('networkStatusChange', status => {\r\n      console.log('Network status changed', status);\r\n      this.networkStatus.next(status.connected);\r\n\r\n      if (status.connected) {\r\n        this.handleReconnect();\r\n      } else {\r\n        this.handleDisconnect();\r\n      }\r\n    });\r\n\r\n    this.checkInitialNetworkStatus();\r\n  }\r\n\r\n  private async checkInitialNetworkStatus() {\r\n    const status = await Network.getStatus();\r\n    this.networkStatus.next(status.connected);\r\n    if (!status.connected) {\r\n      this.handleDisconnect();\r\n    }\r\n  }\r\n\r\n  private handleDisconnect() {\r\n    console.log('Disconnected from network');\r\n    // Handle the UI or logic when the network is disconnected\r\n  }\r\n\r\n  private handleReconnect() {\r\n    console.log('Reconnected to network');\r\n    // Handle the UI or logic when the network is reconnected\r\n  }\r\n\r\n  isConnected(): boolean {\r\n    return this.networkStatus.value;\r\n  }\r\n}\r\n","import { registerPlugin } from '@capacitor/core';\nconst App = registerPlugin('App', {\n    web: () => import('./web').then(m => new m.AppWeb()),\n});\nexport * from './definitions';\nexport { App };\n","import { registerPlugin } from '@capacitor/core';\nconst Geolocation = registerPlugin('Geolocation', {\n    web: () => import('./web').then(m => new m.GeolocationWeb()),\n});\nexport * from './definitions';\nexport { Geolocation };\n","import { CapacitorGoogleMaps } from './implementation';\nexport class LatLngBounds {\n    constructor(bounds) {\n        this.southwest = bounds.southwest;\n        this.center = bounds.center;\n        this.northeast = bounds.northeast;\n    }\n    async contains(point) {\n        const result = await CapacitorGoogleMaps.mapBoundsContains({\n            bounds: this,\n            point,\n        });\n        return result['contains'];\n    }\n    async extend(point) {\n        const result = await CapacitorGoogleMaps.mapBoundsExtend({\n            bounds: this,\n            point,\n        });\n        this.southwest = result['bounds']['southwest'];\n        this.center = result['bounds']['center'];\n        this.northeast = result['bounds']['northeast'];\n        return this;\n    }\n}\nexport var MapType;\n(function (MapType) {\n    /**\n     * Basic map.\n     */\n    MapType[\"Normal\"] = \"Normal\";\n    /**\n     * Satellite imagery with roads and labels.\n     */\n    MapType[\"Hybrid\"] = \"Hybrid\";\n    /**\n     * Satellite imagery with no labels.\n     */\n    MapType[\"Satellite\"] = \"Satellite\";\n    /**\n     * Topographic data.\n     */\n    MapType[\"Terrain\"] = \"Terrain\";\n    /**\n     * No base map tiles.\n     */\n    MapType[\"None\"] = \"None\";\n})(MapType || (MapType = {}));\n","import { registerPlugin } from '@capacitor/core';\nconst CapacitorGoogleMaps = registerPlugin('CapacitorGoogleMaps', {\n    web: () => import('./web').then(m => new m.CapacitorGoogleMapsWeb()),\n});\nCapacitorGoogleMaps.addListener('isMapInFocus', data => {\n    var _a;\n    const x = data.x;\n    const y = data.y;\n    const elem = document.elementFromPoint(x, y);\n    const internalId = (_a = elem === null || elem === void 0 ? void 0 : elem.dataset) === null || _a === void 0 ? void 0 : _a.internalId;\n    const mapInFocus = internalId === data.mapId;\n    CapacitorGoogleMaps.dispatchMapEvent({ id: data.mapId, focus: mapInFocus });\n});\nexport { CapacitorGoogleMaps };\n","/* eslint-disable @typescript-eslint/no-namespace */\nimport { LatLngBounds, MapType, } from './definitions';\nimport { GoogleMap } from './map';\nexport { GoogleMap, LatLngBounds, MapType, };\n","import { Capacitor } from '@capacitor/core';\nimport { LatLngBounds, MapType } from './definitions';\nimport { CapacitorGoogleMaps } from './implementation';\nclass MapCustomElement extends HTMLElement {\n    constructor() {\n        super();\n    }\n    connectedCallback() {\n        this.innerHTML = '';\n        if (Capacitor.getPlatform() == 'ios') {\n            this.style.overflow = 'scroll';\n            this.style['-webkit-overflow-scrolling'] = 'touch';\n            const overflowDiv = document.createElement('div');\n            overflowDiv.style.height = '200%';\n            this.appendChild(overflowDiv);\n        }\n    }\n}\ncustomElements.define('capacitor-google-map', MapCustomElement);\nexport class GoogleMap {\n    constructor(id) {\n        this.element = null;\n        this.resizeObserver = null;\n        this.handleScrollEvent = () => this.updateMapBounds();\n        this.id = id;\n    }\n    /**\n     * Creates a new instance of a Google Map\n     * @param options\n     * @param callback\n     * @returns GoogleMap\n     */\n    static async create(options, callback) {\n        const newMap = new GoogleMap(options.id);\n        if (!options.element) {\n            throw new Error('container element is required');\n        }\n        if (options.config.androidLiteMode === undefined) {\n            options.config.androidLiteMode = false;\n        }\n        newMap.element = options.element;\n        newMap.element.dataset.internalId = options.id;\n        const elementBounds = await GoogleMap.getElementBounds(options.element);\n        options.config.width = elementBounds.width;\n        options.config.height = elementBounds.height;\n        options.config.x = elementBounds.x;\n        options.config.y = elementBounds.y;\n        options.config.devicePixelRatio = window.devicePixelRatio;\n        if (Capacitor.getPlatform() == 'android') {\n            newMap.initScrolling();\n        }\n        if (Capacitor.isNativePlatform()) {\n            options.element = {};\n            const getMapBounds = () => {\n                var _a, _b;\n                const mapRect = (_b = (_a = newMap.element) === null || _a === void 0 ? void 0 : _a.getBoundingClientRect()) !== null && _b !== void 0 ? _b : {};\n                return {\n                    x: mapRect.x,\n                    y: mapRect.y,\n                    width: mapRect.width,\n                    height: mapRect.height,\n                };\n            };\n            const onDisplay = () => {\n                CapacitorGoogleMaps.onDisplay({\n                    id: newMap.id,\n                    mapBounds: getMapBounds(),\n                });\n            };\n            const onResize = () => {\n                CapacitorGoogleMaps.onResize({\n                    id: newMap.id,\n                    mapBounds: getMapBounds(),\n                });\n            };\n            const ionicPage = newMap.element.closest('.ion-page');\n            if (Capacitor.getPlatform() === 'ios' && ionicPage) {\n                ionicPage.addEventListener('ionViewWillEnter', () => {\n                    setTimeout(() => {\n                        onDisplay();\n                    }, 100);\n                });\n                ionicPage.addEventListener('ionViewDidEnter', () => {\n                    setTimeout(() => {\n                        onDisplay();\n                    }, 100);\n                });\n            }\n            const lastState = {\n                width: elementBounds.width,\n                height: elementBounds.height,\n                isHidden: false,\n            };\n            newMap.resizeObserver = new ResizeObserver(() => {\n                if (newMap.element != null) {\n                    const mapRect = newMap.element.getBoundingClientRect();\n                    const isHidden = mapRect.width === 0 && mapRect.height === 0;\n                    if (!isHidden) {\n                        if (lastState.isHidden) {\n                            if (Capacitor.getPlatform() === 'ios' && !ionicPage) {\n                                onDisplay();\n                            }\n                        }\n                        else if (lastState.width !== mapRect.width ||\n                            lastState.height !== mapRect.height) {\n                            onResize();\n                        }\n                    }\n                    lastState.width = mapRect.width;\n                    lastState.height = mapRect.height;\n                    lastState.isHidden = isHidden;\n                }\n            });\n            newMap.resizeObserver.observe(newMap.element);\n        }\n        // small delay to allow for iOS WKWebView to setup corresponding element sub-scroll views ???\n        await new Promise((resolve, reject) => {\n            setTimeout(async () => {\n                try {\n                    await CapacitorGoogleMaps.create(options);\n                    resolve(undefined);\n                }\n                catch (err) {\n                    reject(err);\n                }\n            }, 200);\n        });\n        if (callback) {\n            const onMapReadyListener = await CapacitorGoogleMaps.addListener('onMapReady', (data) => {\n                if (data.mapId == newMap.id) {\n                    callback(data);\n                    onMapReadyListener.remove();\n                }\n            });\n        }\n        return newMap;\n    }\n    static async getElementBounds(element) {\n        return new Promise(resolve => {\n            let elementBounds = element.getBoundingClientRect();\n            if (elementBounds.width == 0) {\n                let retries = 0;\n                const boundsInterval = setInterval(function () {\n                    if (elementBounds.width == 0 && retries < 30) {\n                        elementBounds = element.getBoundingClientRect();\n                        retries++;\n                    }\n                    else {\n                        if (retries == 30) {\n                            console.warn('Map size could not be determined');\n                        }\n                        clearInterval(boundsInterval);\n                        resolve(elementBounds);\n                    }\n                }, 100);\n            }\n            else {\n                resolve(elementBounds);\n            }\n        });\n    }\n    /**\n     * Enable touch events on native map\n     *\n     * @returns void\n     */\n    async enableTouch() {\n        return CapacitorGoogleMaps.enableTouch({\n            id: this.id,\n        });\n    }\n    /**\n     * Disable touch events on native map\n     *\n     * @returns void\n     */\n    async disableTouch() {\n        return CapacitorGoogleMaps.disableTouch({\n            id: this.id,\n        });\n    }\n    /**\n     * Enable marker clustering\n     *\n     * @param minClusterSize - The minimum number of markers that can be clustered together.\n     * @defaultValue 4\n     *\n     * @returns void\n     */\n    async enableClustering(minClusterSize) {\n        return CapacitorGoogleMaps.enableClustering({\n            id: this.id,\n            minClusterSize,\n        });\n    }\n    /**\n     * Disable marker clustering\n     *\n     * @returns void\n     */\n    async disableClustering() {\n        return CapacitorGoogleMaps.disableClustering({\n            id: this.id,\n        });\n    }\n    /**\n     * Adds a marker to the map\n     *\n     * @param marker\n     * @returns created marker id\n     */\n    async addMarker(marker) {\n        const res = await CapacitorGoogleMaps.addMarker({\n            id: this.id,\n            marker,\n        });\n        return res.id;\n    }\n    /**\n     * Adds multiple markers to the map\n     *\n     * @param markers\n     * @returns array of created marker IDs\n     */\n    async addMarkers(markers) {\n        const res = await CapacitorGoogleMaps.addMarkers({\n            id: this.id,\n            markers,\n        });\n        return res.ids;\n    }\n    /**\n     * Remove marker from the map\n     *\n     * @param id id of the marker to remove from the map\n     * @returns\n     */\n    async removeMarker(id) {\n        return CapacitorGoogleMaps.removeMarker({\n            id: this.id,\n            markerId: id,\n        });\n    }\n    /**\n     * Remove markers from the map\n     *\n     * @param ids array of ids to remove from the map\n     * @returns\n     */\n    async removeMarkers(ids) {\n        return CapacitorGoogleMaps.removeMarkers({\n            id: this.id,\n            markerIds: ids,\n        });\n    }\n    async addPolygons(polygons) {\n        const res = await CapacitorGoogleMaps.addPolygons({\n            id: this.id,\n            polygons,\n        });\n        return res.ids;\n    }\n    async addPolylines(polylines) {\n        const res = await CapacitorGoogleMaps.addPolylines({\n            id: this.id,\n            polylines,\n        });\n        return res.ids;\n    }\n    async removePolygons(ids) {\n        return CapacitorGoogleMaps.removePolygons({\n            id: this.id,\n            polygonIds: ids,\n        });\n    }\n    async addCircles(circles) {\n        const res = await CapacitorGoogleMaps.addCircles({\n            id: this.id,\n            circles,\n        });\n        return res.ids;\n    }\n    async removeCircles(ids) {\n        return CapacitorGoogleMaps.removeCircles({\n            id: this.id,\n            circleIds: ids,\n        });\n    }\n    async removePolylines(ids) {\n        return CapacitorGoogleMaps.removePolylines({\n            id: this.id,\n            polylineIds: ids,\n        });\n    }\n    /**\n     * Destroy the current instance of the map\n     */\n    async destroy() {\n        var _a;\n        if (Capacitor.getPlatform() == 'android') {\n            this.disableScrolling();\n        }\n        if (Capacitor.isNativePlatform()) {\n            (_a = this.resizeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\n        }\n        this.removeAllMapListeners();\n        return CapacitorGoogleMaps.destroy({\n            id: this.id,\n        });\n    }\n    /**\n     * Update the map camera configuration\n     *\n     * @param config\n     * @returns\n     */\n    async setCamera(config) {\n        return CapacitorGoogleMaps.setCamera({\n            id: this.id,\n            config,\n        });\n    }\n    async getMapType() {\n        const { type } = await CapacitorGoogleMaps.getMapType({ id: this.id });\n        return MapType[type];\n    }\n    /**\n     * Sets the type of map tiles that should be displayed.\n     *\n     * @param mapType\n     * @returns\n     */\n    async setMapType(mapType) {\n        return CapacitorGoogleMaps.setMapType({\n            id: this.id,\n            mapType,\n        });\n    }\n    /**\n     * Sets whether indoor maps are shown, where available.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableIndoorMaps(enabled) {\n        return CapacitorGoogleMaps.enableIndoorMaps({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Controls whether the map is drawing traffic data, if available.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableTrafficLayer(enabled) {\n        return CapacitorGoogleMaps.enableTrafficLayer({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Show accessibility elements for overlay objects, such as Marker and Polyline.\n     *\n     * Only available on iOS.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableAccessibilityElements(enabled) {\n        return CapacitorGoogleMaps.enableAccessibilityElements({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Set whether the My Location dot and accuracy circle is enabled.\n     *\n     * @param enabled\n     * @returns\n     */\n    async enableCurrentLocation(enabled) {\n        return CapacitorGoogleMaps.enableCurrentLocation({\n            id: this.id,\n            enabled,\n        });\n    }\n    /**\n     * Set padding on the 'visible' region of the view.\n     *\n     * @param padding\n     * @returns\n     */\n    async setPadding(padding) {\n        return CapacitorGoogleMaps.setPadding({\n            id: this.id,\n            padding,\n        });\n    }\n    /**\n     * Get the map's current viewport latitude and longitude bounds.\n     *\n     * @returns {LatLngBounds}\n     */\n    async getMapBounds() {\n        return new LatLngBounds(await CapacitorGoogleMaps.getMapBounds({\n            id: this.id,\n        }));\n    }\n    async fitBounds(bounds, padding) {\n        return CapacitorGoogleMaps.fitBounds({\n            id: this.id,\n            bounds,\n            padding,\n        });\n    }\n    initScrolling() {\n        const ionContents = document.getElementsByTagName('ion-content');\n        // eslint-disable-next-line @typescript-eslint/prefer-for-of\n        for (let i = 0; i < ionContents.length; i++) {\n            ionContents[i].scrollEvents = true;\n        }\n        window.addEventListener('ionScroll', this.handleScrollEvent);\n        window.addEventListener('scroll', this.handleScrollEvent);\n        window.addEventListener('resize', this.handleScrollEvent);\n        if (screen.orientation) {\n            screen.orientation.addEventListener('change', () => {\n                setTimeout(this.updateMapBounds, 500);\n            });\n        }\n        else {\n            window.addEventListener('orientationchange', () => {\n                setTimeout(this.updateMapBounds, 500);\n            });\n        }\n    }\n    disableScrolling() {\n        window.removeEventListener('ionScroll', this.handleScrollEvent);\n        window.removeEventListener('scroll', this.handleScrollEvent);\n        window.removeEventListener('resize', this.handleScrollEvent);\n        if (screen.orientation) {\n            screen.orientation.removeEventListener('change', () => {\n                setTimeout(this.updateMapBounds, 1000);\n            });\n        }\n        else {\n            window.removeEventListener('orientationchange', () => {\n                setTimeout(this.updateMapBounds, 1000);\n            });\n        }\n    }\n    updateMapBounds() {\n        if (this.element) {\n            const mapRect = this.element.getBoundingClientRect();\n            CapacitorGoogleMaps.onScroll({\n                id: this.id,\n                mapBounds: {\n                    x: mapRect.x,\n                    y: mapRect.y,\n                    width: mapRect.width,\n                    height: mapRect.height,\n                },\n            });\n        }\n    }\n    /*\n    private findContainerElement(): HTMLElement | null {\n      if (!this.element) {\n        return null;\n      }\n  \n      let parentElement = this.element.parentElement;\n      while (parentElement !== null) {\n        if (window.getComputedStyle(parentElement).overflowY !== 'hidden') {\n          return parentElement;\n        }\n  \n        parentElement = parentElement.parentElement;\n      }\n  \n      return null;\n    }\n    */\n    /**\n     * Set the event listener on the map for 'onCameraIdle' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCameraIdleListener(callback) {\n        if (this.onCameraIdleListener) {\n            this.onCameraIdleListener.remove();\n        }\n        if (callback) {\n            this.onCameraIdleListener = await CapacitorGoogleMaps.addListener('onCameraIdle', this.generateCallback(callback));\n        }\n        else {\n            this.onCameraIdleListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onBoundsChanged' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnBoundsChangedListener(callback) {\n        if (this.onBoundsChangedListener) {\n            this.onBoundsChangedListener.remove();\n        }\n        if (callback) {\n            this.onBoundsChangedListener = await CapacitorGoogleMaps.addListener('onBoundsChanged', this.generateCallback(callback));\n        }\n        else {\n            this.onBoundsChangedListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onCameraMoveStarted' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCameraMoveStartedListener(callback) {\n        if (this.onCameraMoveStartedListener) {\n            this.onCameraMoveStartedListener.remove();\n        }\n        if (callback) {\n            this.onCameraMoveStartedListener = await CapacitorGoogleMaps.addListener('onCameraMoveStarted', this.generateCallback(callback));\n        }\n        else {\n            this.onCameraMoveStartedListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onClusterClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnClusterClickListener(callback) {\n        if (this.onClusterClickListener) {\n            this.onClusterClickListener.remove();\n        }\n        if (callback) {\n            this.onClusterClickListener = await CapacitorGoogleMaps.addListener('onClusterClick', this.generateCallback(callback));\n        }\n        else {\n            this.onClusterClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onClusterInfoWindowClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnClusterInfoWindowClickListener(callback) {\n        if (this.onClusterInfoWindowClickListener) {\n            this.onClusterInfoWindowClickListener.remove();\n        }\n        if (callback) {\n            this.onClusterInfoWindowClickListener =\n                await CapacitorGoogleMaps.addListener('onClusterInfoWindowClick', this.generateCallback(callback));\n        }\n        else {\n            this.onClusterInfoWindowClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onInfoWindowClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnInfoWindowClickListener(callback) {\n        if (this.onInfoWindowClickListener) {\n            this.onInfoWindowClickListener.remove();\n        }\n        if (callback) {\n            this.onInfoWindowClickListener = await CapacitorGoogleMaps.addListener('onInfoWindowClick', this.generateCallback(callback));\n        }\n        else {\n            this.onInfoWindowClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMapClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMapClickListener(callback) {\n        if (this.onMapClickListener) {\n            this.onMapClickListener.remove();\n        }\n        if (callback) {\n            this.onMapClickListener = await CapacitorGoogleMaps.addListener('onMapClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMapClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onPolygonClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnPolygonClickListener(callback) {\n        if (this.onPolygonClickListener) {\n            this.onPolygonClickListener.remove();\n        }\n        if (callback) {\n            this.onPolygonClickListener = await CapacitorGoogleMaps.addListener('onPolygonClick', this.generateCallback(callback));\n        }\n        else {\n            this.onPolygonClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onCircleClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnCircleClickListener(callback) {\n        if (this.onCircleClickListener)\n            [this.onCircleClickListener.remove()];\n        if (callback) {\n            this.onCircleClickListener = await CapacitorGoogleMaps.addListener('onCircleClick', this.generateCallback(callback));\n        }\n        else {\n            this.onCircleClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerClickListener(callback) {\n        if (this.onMarkerClickListener) {\n            this.onMarkerClickListener.remove();\n        }\n        if (callback) {\n            this.onMarkerClickListener = await CapacitorGoogleMaps.addListener('onMarkerClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onPolylineClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnPolylineClickListener(callback) {\n        if (this.onPolylineClickListener) {\n            this.onPolylineClickListener.remove();\n        }\n        if (callback) {\n            this.onPolylineClickListener = await CapacitorGoogleMaps.addListener('onPolylineClick', this.generateCallback(callback));\n        }\n        else {\n            this.onPolylineClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDragStart' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragStartListener(callback) {\n        if (this.onMarkerDragStartListener) {\n            this.onMarkerDragStartListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragStartListener = await CapacitorGoogleMaps.addListener('onMarkerDragStart', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragStartListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDrag' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragListener(callback) {\n        if (this.onMarkerDragListener) {\n            this.onMarkerDragListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragListener = await CapacitorGoogleMaps.addListener('onMarkerDrag', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMarkerDragEnd' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMarkerDragEndListener(callback) {\n        if (this.onMarkerDragEndListener) {\n            this.onMarkerDragEndListener.remove();\n        }\n        if (callback) {\n            this.onMarkerDragEndListener = await CapacitorGoogleMaps.addListener('onMarkerDragEnd', this.generateCallback(callback));\n        }\n        else {\n            this.onMarkerDragEndListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMyLocationButtonClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMyLocationButtonClickListener(callback) {\n        if (this.onMyLocationButtonClickListener) {\n            this.onMyLocationButtonClickListener.remove();\n        }\n        if (callback) {\n            this.onMyLocationButtonClickListener =\n                await CapacitorGoogleMaps.addListener('onMyLocationButtonClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMyLocationButtonClickListener = undefined;\n        }\n    }\n    /**\n     * Set the event listener on the map for 'onMyLocationClick' events.\n     *\n     * @param callback\n     * @returns\n     */\n    async setOnMyLocationClickListener(callback) {\n        if (this.onMyLocationClickListener) {\n            this.onMyLocationClickListener.remove();\n        }\n        if (callback) {\n            this.onMyLocationClickListener = await CapacitorGoogleMaps.addListener('onMyLocationClick', this.generateCallback(callback));\n        }\n        else {\n            this.onMyLocationClickListener = undefined;\n        }\n    }\n    /**\n     * Remove all event listeners on the map.\n     *\n     * @param callback\n     * @returns\n     */\n    async removeAllMapListeners() {\n        if (this.onBoundsChangedListener) {\n            this.onBoundsChangedListener.remove();\n            this.onBoundsChangedListener = undefined;\n        }\n        if (this.onCameraIdleListener) {\n            this.onCameraIdleListener.remove();\n            this.onCameraIdleListener = undefined;\n        }\n        if (this.onCameraMoveStartedListener) {\n            this.onCameraMoveStartedListener.remove();\n            this.onCameraMoveStartedListener = undefined;\n        }\n        if (this.onClusterClickListener) {\n            this.onClusterClickListener.remove();\n            this.onClusterClickListener = undefined;\n        }\n        if (this.onClusterInfoWindowClickListener) {\n            this.onClusterInfoWindowClickListener.remove();\n            this.onClusterInfoWindowClickListener = undefined;\n        }\n        if (this.onInfoWindowClickListener) {\n            this.onInfoWindowClickListener.remove();\n            this.onInfoWindowClickListener = undefined;\n        }\n        if (this.onMapClickListener) {\n            this.onMapClickListener.remove();\n            this.onMapClickListener = undefined;\n        }\n        if (this.onPolylineClickListener) {\n            this.onPolylineClickListener.remove();\n            this.onPolylineClickListener = undefined;\n        }\n        if (this.onMarkerClickListener) {\n            this.onMarkerClickListener.remove();\n            this.onMarkerClickListener = undefined;\n        }\n        if (this.onPolygonClickListener) {\n            this.onPolygonClickListener.remove();\n            this.onPolygonClickListener = undefined;\n        }\n        if (this.onCircleClickListener) {\n            this.onCircleClickListener.remove();\n            this.onCircleClickListener = undefined;\n        }\n        if (this.onMarkerDragStartListener) {\n            this.onMarkerDragStartListener.remove();\n            this.onMarkerDragStartListener = undefined;\n        }\n        if (this.onMarkerDragListener) {\n            this.onMarkerDragListener.remove();\n            this.onMarkerDragListener = undefined;\n        }\n        if (this.onMarkerDragEndListener) {\n            this.onMarkerDragEndListener.remove();\n            this.onMarkerDragEndListener = undefined;\n        }\n        if (this.onMyLocationButtonClickListener) {\n            this.onMyLocationButtonClickListener.remove();\n            this.onMyLocationButtonClickListener = undefined;\n        }\n        if (this.onMyLocationClickListener) {\n            this.onMyLocationClickListener.remove();\n            this.onMyLocationClickListener = undefined;\n        }\n    }\n    generateCallback(callback) {\n        const mapId = this.id;\n        return (data) => {\n            if (data.mapId == mapId) {\n                callback(data);\n            }\n        };\n    }\n}\n","import { Observable } from '../Observable';\nimport { async } from '../scheduler/async';\nimport { isNumeric } from '../util/isNumeric';\nexport function interval(period = 0, scheduler = async) {\n    if (!isNumeric(period) || period < 0) {\n        period = 0;\n    }\n    if (!scheduler || typeof scheduler.schedule !== 'function') {\n        scheduler = async;\n    }\n    return new Observable(subscriber => {\n        subscriber.add(scheduler.schedule(dispatch, period, { subscriber, counter: 0, period }));\n        return subscriber;\n    });\n}\nfunction dispatch(state) {\n    const { subscriber, counter, period } = state;\n    subscriber.next(counter);\n    this.schedule({ subscriber, counter: counter + 1, period }, period);\n}\n"],"names":["ElementRef","NgZone","Geolocation","AutocompleteComponent","Observable","interval","BehaviorSubject","Subscription","updateDoc","getDoc","collection","onSnapshot","doc","Firestore","query","where","EnrouteChatComponent","Network","App","AddCardComponent","switchMap","Preferences","onAuthStateChanged","TripSummaryComponent","i0","HomePage","constructor","auth","authService","router","networkService","map","nav","platform","firestore","database","ngZone","geocode","overlay","modalCtrl","alert","payME","toastController","actionSheetController","BOOKING","CONFIRM","TRACKING","SEARCHING","DRIVING","NO_DRIVER","MAP_PIN","NO_DRIVERS","initializeApp","ngOnDestroy","unsubscribe","window","removeEventListener","setMapHeight","bind","clearSubscriptions","clearPrevMarkers","clearAllPolylines","ngAfterViewInit","hasPermission","checkAndRequestLocationPermissions","initializeProfile","initializeNetworkMonitoring","fetchSavedPaymentMethods","EnterBookingStage","initializeGeolocation","initializeMap","initializeRideStateListener","e","console","error","hideLoader","showAlert","user","Promise","resolve","Error","profile","getUserProfile","log","userId","uid","email","createdAt","Date","toISOString","createUserProfile","ensureProfileInitialized","lastHandledState","requestsQuery","snapshot","empty","setStage","STAGES","activeRides","docs","currentRide","rideData","data","requestID","id","price","status","isAppInitialization","Loc_lat","Loc_lng","LatLng","lat","lng","Des_lat","Des_lng","D_LatLng","locationAddress","Rider_Location","destinationAddress","Rider_Destination","handlePendingState","handleRideConfirmation","handleRideStart","handleRideCancellation","code","handleRemovedRide","clearRideData","driverInfo","rideHasStarted","is","permissionStatus","checkPermissions","location","create","header","message","buttons","text","handler","newStatus","requestPermissions","showLocationRequiredAlert","backdropDismiss","present","role","onDidDismiss","navigator","permissions","name","then","result","state","showWebLocationPrompt","geolocation","getCurrentPosition","savedPaymentMethods","getSavedPaymentMethods","length","selectedCard","cash","cardId","chooseCard","event","detail","value","processPayment","amount","showLoader","paymentResult","processPaymentWithCardId","toPromise","errorMessage","showPaymentErrorModal","modal","component","onWillDismiss","newCardId","setMapContainerHeight","extraPadding","mapRef","topBar","bottomBar","topHeight","nativeElement","offsetHeight","bottomHeight","availableHeight","innerHeight","style","height","top","position","zIndex","left","right","setMapHeightCreateAndAddMarkers","setMapHeightHandleDrivertoRider","setMapHeightHandleDrivertoDestination","ResetMapHeight","getStatus","isConnected","connected","networkStatus$","next","addListener","subscribe","navigate","ready","coordinates","timeout","reject","coords","latitude","longitude","accuracy","altitude","altitudeAccuracy","heading","speed","timestamp","updateLocation","startPollingPosition","startPermissionPolling","permissionCheckInterval","setInterval","clearInterval","lastLatLng","lastAddress","pollingInterval","newLatLng","hasSignificantLocationChange","address","getAddress","results","components","address_components","long_name","actualLocation","formatted_address","stopPolling","center","radiusInM","fetchAndDisplayDrivers","err","oldLatLng","minDistance","R","1","Math","PI","2","","","a","sin","cos","c","atan2","sqrt","distance","stopPollingPosition","warn","now","createMap","mapy","initializeDatabaseSubscriptions","getKnownPlaces","d","places","slice","initializeBackButtonCustomHandler","backButton","subscribeWithPriority","canGoBack","confirm","exitApp","history","back","setupMapListeners","newMap","setOnCameraIdleListener","g","run","showResetLocationButton","mapPinStage","addressResponse","processAddressResponse","logout","drivers","checkDriversWithin","handleDrivers","drivers_Requested","current_Request_Number","UpdateCarMarker","NoDrivers","closeDrivers","forEach","driver","duration","onlineState","push","updateDriverInfo","min","cleanupListeners","Object","values","activeListeners","carname","Driver_car","driverImage","Driver_imgUrl","driver_duration_apart","ceil","driver_ID","Driver_id","driver_number_of_seats","seats","DriverLatLng","Driver_lat","Driver_lng","StartRide","isLoadingDriver","all","enableTouch","BookRide","clearMarkers","marker1","removeMarker","marker2","toString","_carmarkers","marker","hasValidDriver","showNoDriversAlert","userDocRef","docSnapshot","exists","handleNoAvailableDriver","requestRideWithDriverDetails","requestDetails","latLng","dLatLng","driverId","RequestRideWithRiderDetails","currentDriver","rideRequestDocRef","unsub","handleRideUpdates","routeUpdateSubscription","numCalls","countDown","animatedMarker","handleRideStop","ReturnHome","locationPromise","getDriverLocation","timeoutPromise","_","setTimeout","race","clearPolyline","newPoly","setCamera","animate","animationDuration","zoom","coordinate","handleDriverToRider","EnterSearchingStage","startCountdown","presentCancelRideActionSheet","actionSheet","cancelRide","reason","rideRef","cancellationReason","canceledBy","toast","stopCountdown","ClearRide","driverDetails","driverDoc","addEventListener","mapError","driverLocationFetched","driverLocation","locationError","driver_lat","driver_lng","EnterDrivingToDestinationStage","canCheck","handleRiderToDestination","visualError","isRideStopProcessed","attempt","docData","tripId","driverName","Driver_name","driverCar","driverPlate","Driver_plate","pickup","destination","rating","Driver_rating","completed","completedAt","remove","key","RIDE_STATE_KEY","componentProps","clearRideState","driver_marker","rider_marker","destinationMarker","routePolyline","routePath","bookingStage","confirmStage","trackingStage","searchingStage","noDriverStage","drivingToDestinationStage","enableCurrentLocation","docOrData","docId","requestId","EnterTrackingStage","saveRideStateToStorage","rideState","stage","getCurrentStage","set","JSON","stringify","catch","EnterChat","options","swipeToClose","initialTime","countdownActive","timeRemaining","updateCountdown","UpdateCountDown","handleCountdownEnd","requestNextDriver","goBackToAutoComplete","ResetState","showAutocompleteModal","markers","clearPromises","filter","undefined","clearMarker","removePolylines","actualDestination","pinOnMap","EnterMapPinStage","mapPinDrag","home","searching","AddKnownPlace","full","whole","getLatLng","description","geometry","getDistanceAndDirections","RequestRide","dat","place","EnterNoDriverStage","EnterConfirmStage","origin1","google","maps","origin2","request","origin","travelMode","TravelMode","directions","route","response","direction","routes","legs","bounds","getPriceEstimate","createAndAddMarkers","getDistanceAndDirectionsDriver","D_duration","resetLocation","addressComponents","elements","LatLngBounds","driverMap","Map","element","updatedMarkers","get","latlng","extend","existingMarkerIndex","findIndex","mapDim","width","offsetWidth","minZoom","maxZoom","zoomLevel","getBoundsZoomLevel","max","getCenter","fitBounds","GoHome","GotoSupport","navigateForward","CancelRide","riderCleared","currentUser","riderDocRef","currentRequestId","bearing","CallDriver","driverLatLng","riderLatLng","markerSize","iconAnchor","x","y","driverMarker","addMarker","iconUrl","title","iconSize","riderMarker","photoURL","updateRoute","path","overview_path","locs","geoCode","calculateCenter","adjustedZoomLevel","setCameraToLocation","calculateBearing","addPolyline","animateMarker","routeUpdate$","UPDATE_INTERVAL","pipe","polylineId","destinationLatLng","iconOrigin","loc","des","polylineColor","polylines","strokeColor","strokeWeight","geodesic","addedPolylines","addPolylines","Array","isArray","disableTouch","lastMarker","i","ShowDriverInfoPop","ngOnInit","navigation","getCurrentNavigation","extras","mapLoadedSubscription","mapLoadedSubject","loaded","processBookAgainData","addLocationMarker","geocodeService","geocodeAddress","addDestinationMarker","drawRoute","calculatePrice","toastCtrl","color","selectors","viewQuery","ctx","environment","of","HttpParams","catchError","GeocodeService","client","http","DistanceMatrixService","DirectionsService","url","apiUrl","params","apiKey","getDirections","from","to","getDistanceMatrix","distanceMatrixService","observer","origins","destinations","complete","factory","providedIn","GoogleMap","MapService","_map","ref","config","styles","scaleControl","streetViewControl","rotateControl","fullscreenControl","enableTrafficLayer","destroyMap","destroy","points","latitudes","p","longitudes","avgLat","reduce","b","avgLng","WORLD_DIM","ZOOM_MAX","latRad","radX2","mapPx","worldPx","fraction","floor","LN2","ne","getNorthEast","sw","getSouthWest","latFraction","lngDiff","lngFraction","latZoom","lngZoom","start","end","startLat","startLng","endLat","endLng","dLng","NetworkService","networkStatus","asObservable","initializeNetworkListener","handleReconnect","handleDisconnect","checkInitialNetworkStatus","registerPlugin","web","m","AppWeb","GeolocationWeb","CapacitorGoogleMaps","southwest","northeast","contains","point","mapBoundsContains","mapBoundsExtend","MapType","CapacitorGoogleMapsWeb","_a","elem","document","elementFromPoint","internalId","dataset","mapInFocus","mapId","dispatchMapEvent","focus","Capacitor","MapCustomElement","HTMLElement","connectedCallback","innerHTML","getPlatform","overflow","overflowDiv","createElement","appendChild","customElements","define","resizeObserver","handleScrollEvent","updateMapBounds","callback","androidLiteMode","elementBounds","getElementBounds","devicePixelRatio","initScrolling","isNativePlatform","getMapBounds","_b","mapRect","getBoundingClientRect","onDisplay","mapBounds","onResize","ionicPage","closest","lastState","isHidden","ResizeObserver","observe","onMapReadyListener","retries","boundsInterval","enableClustering","minClusterSize","disableClustering","res","addMarkers","ids","markerId","removeMarkers","markerIds","addPolygons","polygons","removePolygons","polygonIds","addCircles","circles","removeCircles","circleIds","polylineIds","disableScrolling","disconnect","removeAllMapListeners","getMapType","type","setMapType","mapType","enableIndoorMaps","enabled","enableAccessibilityElements","setPadding","padding","ionContents","getElementsByTagName","scrollEvents","screen","orientation","onScroll","onCameraIdleListener","generateCallback","setOnBoundsChangedListener","onBoundsChangedListener","setOnCameraMoveStartedListener","onCameraMoveStartedListener","setOnClusterClickListener","onClusterClickListener","setOnClusterInfoWindowClickListener","onClusterInfoWindowClickListener","setOnInfoWindowClickListener","onInfoWindowClickListener","setOnMapClickListener","onMapClickListener","setOnPolygonClickListener","onPolygonClickListener","setOnCircleClickListener","onCircleClickListener","setOnMarkerClickListener","onMarkerClickListener","setOnPolylineClickListener","onPolylineClickListener","setOnMarkerDragStartListener","onMarkerDragStartListener","setOnMarkerDragListener","onMarkerDragListener","setOnMarkerDragEndListener","onMarkerDragEndListener","setOnMyLocationButtonClickListener","onMyLocationButtonClickListener","setOnMyLocationClickListener","onMyLocationClickListener","async","isNumeric","period","scheduler","schedule","subscriber","add","dispatch","counter"],"sourceRoot":"webpack:///","x_google_ignoreList":[7,8,9,10,11,12,13]}